var zs=Object.defineProperty,Ks=Object.defineProperties;var Gs=Object.getOwnPropertyDescriptors;var $n=Object.getOwnPropertySymbols,qs=Object.getPrototypeOf,Ys=Object.prototype.hasOwnProperty,Xs=Object.prototype.propertyIsEnumerable,Zs=Reflect.get;var bt=Math.pow,Dn=(M,ee,G)=>ee in M?zs(M,ee,{enumerable:!0,configurable:!0,writable:!0,value:G}):M[ee]=G,Y=(M,ee)=>{for(var G in ee||(ee={}))Ys.call(ee,G)&&Dn(M,G,ee[G]);if($n)for(var G of $n(ee))Xs.call(ee,G)&&Dn(M,G,ee[G]);return M},$e=(M,ee)=>Ks(M,Gs(ee));var X=(M,ee,G)=>Dn(M,typeof ee!="symbol"?ee+"":ee,G);var st=(M,ee,G)=>Zs(qs(M),G,ee);var pe=(M,ee,G)=>new Promise((A,i)=>{var D=C=>{try{v(G.next(C))}catch(l){i(l)}},f=C=>{try{v(G.throw(C))}catch(l){i(l)}},v=C=>C.done?A(C.value):Promise.resolve(C.value).then(D,f);v((G=G.apply(M,ee)).next())});(self.webpackChunkiobroker_admin_component_backitup=self.webpackChunkiobroker_admin_component_backitup||[]).push([["vendors-node_modules_iobroker_json-config_build_index_js"],{708:(M,ee,G)=>{"use strict";G.r(ee),G.d(ee,{ConfigGeneric:()=>d,ConfigPanel:()=>Lt,JsonConfig:()=>js,JsonConfigComponent:()=>jt});var A=G(8437),i=G.n(A),D=G(5589),f=G.n(D),v=G(1778),C=G.n(v),l=G(7085),u=G(1839),c=G(5636);const S="material",P=["Su","Mo","Tu","We","Th","Fr","Sa"],H=["Jan","Feb","Mar","Apr","Mai","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Q={0:"0x00 - good",1:"0x01 - general problem",2:"0x02 - no connection problem",16:"0x10 - substitute value from controller",32:"0x20 - substitute initial value",64:"0x40 - substitute value from device or instance",128:"0x80 - substitute value from sensor",17:"0x11 - general problem by instance",65:"0x41 - general problem by device",129:"0x81 - general problem by sensor",18:"0x12 - instance not connected",66:"0x42 - device not connected",130:"0x82 - sensor not connected",68:"0x44 - device reports error",132:"0x84 - sensor reports error"},R={JVBERi0:"pdf",R0lGODdh:"gif",R0lGODlh:"gif",iVBORw0KGgo:"png","/9j/":"jpg",PHN2Zw:"svg",Qk1:"bmp",AAABAA:"ico"},Te=class Te{static CapitalWords(s){return(s||"").split(/[\s_]/).filter(e=>e).map(e=>e?e[0].toUpperCase()+e.substring(1).toLowerCase():"").join(" ")}static formatSeconds(s){const e=Math.floor(s/86400);s%=3600*24;let t=Math.floor(s/3600);t<10&&(t=`0${t}`),s%=3600;let n=Math.floor(s/60);n<10&&(n=`0${n}`),s%=60,s=Math.floor(s),s<10&&(s=`0${s}`);let r="";return e&&(r+=`${e} ${c.I18n.t("ra_daysShortText")} `),r+=`${t}:${n}:${s}`,r}static getObjectName(s,e,t,n,r){const o=s[e];let a;const h=r?"desc":"name";if(typeof t=="string"&&!n&&(n={language:t},t=null),n=n||{},n.language||(n.language=s["system.config"]&&s["system.config"].common&&s["system.config"].common.language||window.sysLang||"en"),t&&t.name)a=t.name,typeof a=="object"&&(a=a[n.language]||a.en);else if(o&&o.common&&o.common[h])a=o.common[h],h!=="desc"&&!a&&o.common.desc&&(a=o.common.desc),typeof a=="object"&&(a=a[n.language]||a.en||a.de||a.ru||""),a=(a||"").toString().replace(/[_.]/g," "),a===a.toUpperCase()&&(a=a[0]+a.substring(1).toLowerCase());else{const I=e.lastIndexOf(".");a=e.substring(I+1).replace(/[_.]/g," "),a=Te.CapitalWords(a)}return a.trim()}static getObjectNameFromObj(s,e,t,n,r){const o=s;let a=s&&s._id||"";const h=n?"desc":"name";return typeof e=="string"&&!t&&(t={language:e},e=null),t=t||{},e&&e.name?(a=e.name,typeof a=="object"&&(a=a[t.language]||a.en)):o&&o.common&&o.common[h]&&(a=o.common[h],h!=="desc"&&!a&&o.common.desc&&(a=o.common.desc),typeof a=="object"&&(a=a[t.language]||a.en),a=(a||"").toString().replace(/[_.]/g," "),a===a.toUpperCase()&&(a=a[0]+a.substring(1).toLowerCase())),r?a:a.trim()}static getSettingsOrder(s,e,t){s&&Object.prototype.hasOwnProperty.call(s,"common")&&(s=s.common);let n;if(s&&s.custom){n=(s.custom||{})[S];const r=t.user||"admin";if(n&&n[r]){if(e){if(n[r].subOrder&&n[r].subOrder[e])return JSON.parse(JSON.stringify(n[r].subOrder[e]))}else if(n[r].order)return JSON.parse(JSON.stringify(n[r].order))}}return null}static getSettingsCustomURLs(s,e,t){s&&Object.prototype.hasOwnProperty.call(s,"common")&&(s=s.common);let n;if(s&&s.custom){n=(s.custom||{})[S];const r=t.user||"admin";if(n&&n[r]){if(e){if(n[r].subURLs&&n[r].subURLs[e])return JSON.parse(JSON.stringify(n[r].subURLs[e]))}else if(n[r].URLs)return JSON.parse(JSON.stringify(n[r].URLs))}}return null}static reorder(s,e,t){const n=Array.from(s),[r]=n.splice(e,1);return n.splice(t,0,r),n}static getSettings(s,e,t){let n;const r=s&&s._id||e&&e.id;if(s&&Object.prototype.hasOwnProperty.call(s,"common")&&(s=s.common),s!=null&&s.custom?(n=s.custom,n=n[S]&&n[S][e.user||"admin"]?JSON.parse(JSON.stringify(n[S][e.user||"admin"])):{enabled:!0}):n={enabled:t===void 0?!0:t,useCustom:!1},Object.prototype.hasOwnProperty.call(n,"enabled")||(n.enabled=t===void 0?!0:t),e&&(!n.name&&e.name&&(n.name=e.name),!n.icon&&e.icon&&(n.icon=e.icon),!n.color&&e.color&&(n.color=e.color)),s&&(!n.color&&s.color&&(n.color=s.color),!n.icon&&s.icon&&(n.icon=s.icon),!n.name&&s.name&&(n.name=s.name)),typeof n.name=="object"&&(n.name=n.name[e.language]||n.name.en,n.name=(n.name||"").toString().replace(/_/g," "),n.name===n.name.toUpperCase()&&(n.name=n.name[0]+n.name.substring(1).toLowerCase())),!n.name&&r){const o=r.lastIndexOf(".");n.name=r.substring(o+1).replace(/[_.]/g," "),n.name=(n.name||"").toString().replace(/_/g," "),n.name=Te.CapitalWords(n.name)}return n}static setSettings(s,e,t){if(s){s.common=s.common||{},s.common.custom=s.common.custom||{},s.common.custom[S]=s.common.custom[S]||{},s.common.custom[S][t.user||"admin"]=e;const n=s.common.custom[S][t.user||"admin"];return n.useCommon&&(n.color!==void 0&&(s.common.color=n.color,delete n.color),n.icon!==void 0&&(s.common.icon=n.icon,delete n.icon),n.name!==void 0&&(typeof s.common.name!="object"&&(s.common.name={}),s.common.name[t.language]=n.name,delete n.name)),!0}return!1}static getIcon(s,e){return s&&s.icon?s.icon.length<=2?i().createElement("span",{style:e||{}},s.icon):s.icon.startsWith("data:image")?i().createElement("img",{alt:s.name,src:s.icon,style:e||{}}):i().createElement("img",{alt:s.name,src:(s.prefix||"")+s.icon,style:e||{}}):null}static getObjectIcon(s,e){if(typeof s=="object"&&(e=s,s=e._id),e&&e.common&&e.common.icon){let t=e.common.icon;if(typeof t=="string"&&t.length<=2||t.startsWith("data:image"))return t;const n=s.split(".");return n[0]==="system"?t=`adapter/${n[2]}${t.startsWith("/")?"":"/"}${t}`:t=`adapter/${n[0]}${t.startsWith("/")?"":"/"}${t}`,window.location.pathname.match(/adapter\/[^/]+\/[^/]+\.html/)?t=`../../${t}`:window.location.pathname.match(/material\/[.\d]+/)?t=`../../${t}`:window.location.pathname.match(/material\//)&&(t=`../${t}`),t}return null}static splitCamelCase(s){return Te.CapitalWords(s)}static isUseBright(s,e){if(s==null||s==="")return e===void 0?!0:e;s=s.toString(),s.startsWith("#")&&(s=s.slice(1));let t,n,r;const o=s.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i);if(o&&o.length===4)t=parseInt(o[1],10),n=parseInt(o[2],10),r=parseInt(o[3],10);else{if(s.length===3&&(s=s[0]+s[0]+s[1]+s[1]+s[2]+s[2]),s.length===8)s=s.substring(0,6);else if(s.length!==6)return!1;t=parseInt(s.slice(0,2),16),n=parseInt(s.slice(2,4),16),r=parseInt(s.slice(4,6),16)}return t*.299+n*.587+r*.114<=186}static getTimeString(s){if(s=parseFloat(s),Number.isNaN(s))return"--:--";const e=Math.floor(s/3600);let t=Math.floor(s%3600/60),n=s%60;return e?(t<10&&(t=`0${t}`),n<10&&(n=`0${n}`),`${e}:${t}:${n}`):(n<10&&(n=`0${n}`),`${t}:${n}`)}static getWindDirection(s){return s>=0&&s<11.25?"N":s>=11.25&&s<33.75?"NNE":s>=33.75&&s<56.25?"NE":s>=56.25&&s<78.75?"ENE":s>=78.75&&s<101.25?"E":s>=101.25&&s<123.75?"ESE":s>=123.75&&s<146.25?"SE":s>=146.25&&s<168.75?"SSE":s>=168.75&&s<191.25?"S":s>=191.25&&s<213.75?"SSW":s>=213.75&&s<236.25?"SW":s>=236.25&&s<258.75?"WSW":s>=258.75&&s<281.25?"W":s>=281.25&&s<303.75?"WNW":s>=303.75&&s<326.25?"NW":s>=326.25&&s<348.75?"NNW":"N"}static padding(s){return typeof s=="string"?s.length<2?`0${s}`:s:s<10?`0${s}`:s}static setDataFormat(s){s&&(Te.dateFormat=s.toUpperCase().split(/[.-/]/),Te.dateFormat.splice(Te.dateFormat.indexOf("YYYY"),1))}static date2string(s){if(typeof s=="string"){if(s=s.trim(),!s)return"";if(s.match(/^[\w\s]+$/))return s;const t=s.match(/(\d{1,4})[-./](\d{1,2})[-./](\d{1,4})/);if(t){const n=[parseInt(t[1],10),parseInt(t[2],10),parseInt(t[3],10)],r=n.find(a=>a>31);n.splice(n.indexOf(r),1);const o=n.find(a=>a>12);o?(n.splice(n.indexOf(o),1),s=new Date(r,n[0]-1,o)):Te.dateFormat[0][0]==="M"&&Te.dateFormat[1][0]==="D"?(s=new Date(r,n[0]-1,n[1]),Math.abs(s.getTime-Date.now())>36e5*24*10&&(s=new Date(r,n[1]-1,n[0]))):Te.dateFormat[0][0]==="D"&&Te.dateFormat[1][0]==="M"?(s=new Date(r,n[1]-1,n[0]),Math.abs(s.getTime-Date.now())>36e5*24*10&&(s=new Date(r,n[0]-1,n[1]))):s=new Date(s)}else s=new Date(s)}else s=new Date(s);let e=c.I18n.t(`ra_dow_${P[s.getDay()]}`).replace("ra_dow_","");return e+=`. ${s.getDate()} ${c.I18n.t(`ra_month_${H[s.getMonth()]}`).replace("ra_month_","")}`,e}static renderTextWithA(s){let e=s.match(/<a [^<]+<\/a>|<br\/?>|<b>[^<]+<\/b>|<i>[^<]+<\/i>/);if(e){const t=[];let n=1;do{const r=s.substring(0,e.index);if(s=s.substring(e.index+e[0].length),r&&t.push(i().createElement("span",{key:`a${n++}`},r)),e[0].startsWith("<b>"))t.push(i().createElement("b",{key:`a${n++}`},e[0].substring(3,e[0].length-4)));else if(e[0].startsWith("<i>"))t.push(i().createElement("i",{key:`a${n++}`},e[0].substring(3,e[0].length-4)));else if(e[0].startsWith("<br"))t.push(i().createElement("br",{key:`a${n++}`}));else{const o=e[0].match(/href="([^"]+)"/)||e[0].match(/href='([^']+)'/),a=e[0].match(/target="([^"]+)"/)||e[0].match(/target='([^']+)'/),h=e[0].match(/rel="([^"]+)"/)||e[0].match(/rel='([^']+)'/),I=e[0].match(/>([^<]*)</);t.push(i().createElement("a",{key:`a${n++}`,href:o?o[1]:"",target:a?a[1]:"_blank",rel:h?h[1]:"",style:{color:"inherit"}},I?I[1]:""))}e=s&&s.match(/<a [^<]+<\/a>|<br\/?>|<b>[^<]+<\/b>|<i>[^<]+<\/i>/),!e&&s&&t.push(i().createElement("span",{key:`a${n++}`},s))}while(e);return t}return s}static getSmartName(s,e,t,n){var r,o;return e?n?s[e]&&((o=s[e].common)!=null&&o.custom)&&s[e].common.custom[t]&&s[e].common.custom[t].smartName||null:s[e].common.smartName:n?s&&!s.common?s.smartName:(r=s==null?void 0:s.common)!=null&&r.custom&&s.common.custom[t]?s.common.custom[t].smartName:void 0:!s.common||s&&!s.common?s.smartName:s.common.smartName}static getSmartNameFromObj(s,e,t){var n;return t?s&&!s.common?s.smartName:(n=s==null?void 0:s.common)!=null&&n.custom&&s.common.custom[e]?s.common.custom[e].smartName:void 0:!s.common||s&&!s.common?s.smartName:s.common.smartName}static enableSmartName(s,e,t){t?(s.common.custom=s.common.custom||{},s.common.custom[e]=s.common.custom[e]||{},s.common.custom[e].smartName={}):s.common.smartName={}}static removeSmartName(s,e,t){t?s.common&&s.common.custom&&s.common.custom[e]&&(s.common.custom[e]=null):s.common.smartName=null}static updateSmartName(s,e,t,n,r,o){const a=c.I18n.getLanguage();if(typeof s.common.smartName=="string"){const h=s.common.smartName;s.common.smartName={},s.common.smartName[a]=h}if(s.native&&s.native.byON){delete s.native.byON;let h=s.common.smartName;(!h||typeof h!="object")&&(h={en:h},h[a]=h.en),s.common.smartName=h}if(n!==void 0&&(o?(s.common.custom=s.common.custom||{},s.common.custom[r]=s.common.custom[r]||{},s.common.custom[r].smartName=s.common.custom[r].smartName||{},n?s.common.custom[r].smartName.smartType=n:delete s.common.custom[r].smartName.smartType):(s.common.smartName=s.common.smartName||{},n?s.common.smartName.smartType=n:delete s.common.smartName.smartType)),t!==void 0&&(o?(s.common.custom=s.common.custom||{},s.common.custom[r]=s.common.custom[r]||{},s.common.custom[r].smartName=s.common.custom[r].smartName||{},s.common.custom[r].smartName.byON=t):(s.common.smartName=s.common.smartName||{},s.common.smartName.byON=t)),e!==void 0){let h;if(o?(s.common.custom=s.common.custom||{},s.common.custom[r]=s.common.custom[r]||{},s.common.custom[r].smartName=s.common.custom[r].smartName||{},h=s.common.custom[r].smartName):(s.common.smartName=s.common.smartName||{},h=s.common.smartName),h[a]=e,h&&(!h[a]||h[a]===s.common.name&&(!s.common.role||s.common.role.includes("button")))){delete h[a];let I=!0;for(const O in h)if(Object.prototype.hasOwnProperty.call(h,O)){I=!1;break}I&&(o?s.common.custom[r].smartName.byON===void 0?delete s.common.custom[r]:(delete s.common.custom[r].en,delete s.common.custom[r].de,delete s.common.custom[r].ru,delete s.common.custom[r].nl,delete s.common.custom[r].pl,delete s.common.custom[r].it,delete s.common.custom[r].fr,delete s.common.custom[r].pt,delete s.common.custom[r].es,delete s.common.custom[r].uk,delete s.common.custom[r]["zh-cn"]):s.common.smartName.byON!==void 0?(delete s.common.smartName.en,delete s.common.smartName.de,delete s.common.smartName.ru,delete s.common.smartName.nl,delete s.common.smartName.pl,delete s.common.smartName.it,delete s.common.smartName.fr,delete s.common.smartName.pt,delete s.common.smartName.es,delete s.common.smartName.uk,delete s.common.smartName["zh-cn"]):s.common.smartName=null)}}}static disableSmartName(s,e,t){t?(s.common.custom=s.common.custom||{},s.common.custom[e]=s.common.custom[e]||{},s.common.custom[e].smartName=!1):s.common.smartName=!1}static copyToClipboard(s,e){return e&&(e.stopPropagation(),e.preventDefault()),c.Utils.copyToClipboard(s)}static getFileExtension(s){const e=(s||"").lastIndexOf(".");return e!==-1?s.substring(e+1).toLowerCase():null}static formatBytes(s){if(Math.abs(s)<1024)return`${s} B`;const e=["KB","MB","GB"];let t=-1;do s/=1024,++t;while(Math.abs(s)>=1024&&t<e.length-1);return`${s.toFixed(1)} ${e[t]}`}static getInvertedColor(s,e,t){if(!s)return;const n=Te.invertColor(s,!0);if(n==="#FFFFFF"&&(e==="dark"||t&&e==="light"))return"#DDD";if(n==="#000000"&&(e==="light"||t&&e==="dark"))return"#222"}static invertColor(s,e){if(s==null||s===""||typeof s!="string")return"";if(s.startsWith("rgba")){const a=s.match(/rgba?\((\d+),\s*(\d+),\s*(\d+),\s*([.\d]+)\)/);a&&(s=parseInt(a[1],10).toString(16).padStart(2,"0")+parseInt(a[2],10).toString(16).padStart(2,"0")+parseInt(a[2],10).toString(16).padStart(2,"0"))}else if(s.startsWith("rgb")){const a=s.match(/rgb?\((\d+),\s*(\d+),\s*(\d+)\)/);a&&(s=parseInt(a[1],10).toString(16).padStart(2,"0")+parseInt(a[2],10).toString(16).padStart(2,"0")+parseInt(a[2],10).toString(16).padStart(2,"0"))}else s.startsWith("#")&&(s=s.slice(1));s.length===3&&(s=s[0]+s[0]+s[1]+s[1]+s[2]+s[2]);let t=null;if(s.length===8)t=s.substring(6,8),s=s.substring(0,6);else if(s.length!==6)return console.warn(`Cannot invert color: ${s}`),s;let n=parseInt(s.slice(0,2),16),r=parseInt(s.slice(2,4),16),o=parseInt(s.slice(4,6),16);return e?n*.299+r*.587+o*.114>186?`#000000${t||""}`:`#FFFFFF${t||""}`:(n=(255-n).toString(16),r=(255-r).toString(16),o=(255-o).toString(16),`#${n.padStart(2,"0")}${r.padStart(2,"0")}${o.padStart(2,"0")}${t||""}`)}static color2rgb(s){if(s==null||s===""||typeof s!="string")return"";if(s.startsWith("rgba")){const e=s.match(/rgba?\((\d+),\s*(\d+),\s*(\d+),\s*([.\d]+)\)/);e&&(s=parseInt(e[1],10).toString(16).padStart(2,"0")+parseInt(e[2],10).toString(16).padStart(2,"0")+parseInt(e[2],10).toString(16).padStart(2,"0"))}else if(s.startsWith("rgb")){const e=s.match(/rgb?\((\d+),\s*(\d+),\s*(\d+)\)/);e&&(s=parseInt(e[1],10).toString(16).padStart(2,"0")+parseInt(e[2],10).toString(16).padStart(2,"0")+parseInt(e[2],10).toString(16).padStart(2,"0"))}else s.startsWith("#")&&(s=s.slice(1));return s.length===3&&(s=s[0]+s[0]+s[1]+s[1]+s[2]+s[2]),s.length!==6&&s.length!==8?(console.warn(`Cannot invert color: ${s}`),!1):[parseInt(s.slice(0,2),16),parseInt(s.slice(2,4),16),parseInt(s.slice(4,6),16)]}static rgb2lab(s){let e=s[0]/255,t=s[1]/255,n=s[2]/255;e=e>.04045?bt((e+.055)/1.055,2.4):e/12.92,t=t>.04045?bt((t+.055)/1.055,2.4):t/12.92,n=n>.04045?bt((n+.055)/1.055,2.4):n/12.92;let r=(e*.4124+t*.3576+n*.1805)/.95047,o=e*.2126+t*.7152+n*.0722,a=(e*.0193+t*.1192+n*.9505)/1.08883;return r=r>.008856?bt(r,.33333333):7.787*r+.137931,o=o>.008856?bt(o,.33333333):7.787*o+.137931,a=a>.008856?bt(a,.33333333):7.787*a+.137931,[116*o-16,500*(r-o),200*(o-a)]}static colorDistance(s,e){const t=Te.rgb2lab(Te.color2rgb(s)),n=Te.rgb2lab(Te.color2rgb(e)),r=t[0]-n[0],o=t[1]-n[1],a=t[2]-n[2],h=Math.sqrt(t[1]*t[1]+t[2]*t[2]),I=Math.sqrt(n[1]*n[1]+n[2]*n[2]),O=h-I;let L=o*o+a*a-O*O;L=L<0?0:Math.sqrt(L);const q=1+.045*h,he=1+.015*h,Ee=r,se=O/q,ye=L/he,fe=Ee*Ee+se*se+ye*ye;return fe<0?0:fe}static _toVal(s){let e,t="";if(typeof s=="string"||typeof s=="number")t+=s;else if(typeof s=="object")if(Array.isArray(s))for(let n=0;n<s.length;n++)s[n]&&(e=Te._toVal(s[n]),e&&(t+=(t?" ":"")+e));else for(const n in s)s[n]&&(t+=(t?" ":"")+n);return t}static clsx(){let s=0,e,t,n="";for(;s<arguments.length;)e=arguments[s++],e&&(t=Te._toVal(e),t&&(n+=(n?" ":"")+t));return n}static getThemeName(s=""){return window.vendorPrefix&&window.vendorPrefix!=="@@vendorPrefix@@"?window.vendorPrefix:s||((window._localStorage||window.localStorage).getItem("App.themeName")?(window._localStorage||window.localStorage).getItem("App.themeName"):window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"colored")}static getThemeType(s=""){return window.vendorPrefix&&window.vendorPrefix!=="@@vendorPrefix@@"?"light":(s=s||(window._localStorage||window.localStorage).getItem("App.themeName"),s==="dark"||s==="blue"?"dark":"light")}static setThemeName(s){window.vendorPrefix&&window.vendorPrefix!=="@@vendorPrefix@@"||((window._localStorage||window.localStorage).setItem("App.themeName",s),(window._localStorage||window.localStorage).setItem("App.theme",s==="dark"||s==="blue"?"dark":"light"))}static toggleTheme(s){if(window.vendorPrefix&&window.vendorPrefix!=="@@vendorPrefix@@")return window.vendorPrefix;s=s||(window._localStorage||window.localStorage).getItem("App.themeName");const e=Te.getThemeNames(),t=e.indexOf(s);let n;return t!==-1?n=e[(t+1)%e.length]:n=e[0],Te.setThemeName(n),n}static getThemeNames(){return window.vendorPrefix&&window.vendorPrefix!=="@@vendorPrefix@@"?[window.vendorPrefix]:["light","dark","blue","colored"]}static parseQuery(s){s=(s||"").toString().replace(/^\?/,"");const e={};return s.split("&").forEach(t=>{if(t=t.trim(),t){const n=t.split("="),r=decodeURIComponent(n[0]).trim();if(n.length>1)if(e[r]=decodeURIComponent(n[1]),e[r]==="true")e[r]=!0;else if(e[r]==="false")e[r]=!1;else{const o=parseFloat(e[r]);o.toString()===e[r]&&(e[r]=o)}else e[r]=!0}}),e}static getParentId(s){const e=(s||"").toString().split(".");return e.length>1?(e.pop(),e.join(".")):null}static formatDate(s,e){if(!s)return"";let t,n=s.getMonth()+1;n<10&&(n=`0${n}`);let r=s.getDate();r<10&&(r=`0${r}`),e==="MM/DD/YYYY"?t=`${n}/${r}/${s.getFullYear()}`:t=`${s.getFullYear()}-${n}-${r}`;let o=s.getHours();return o<10?t+=` 0${o}`:t+=` ${o}`,o=s.getMinutes(),o<10?t+=`:0${o}`:t+=`:${o}`,o=s.getSeconds(),o<10?t+=`:0${o}`:t+=`:${o}`,o=s.getMilliseconds(),o<10?t+=`.00${o}`:o<100?t+=`.0${o}`:t+=`.${o}`,t}static formatTime(s){if(s){s=Math.round(s);const e=Math.floor(s/(3600*24)),t=Math.floor(s%(3600*24)/3600),n=Math.floor(s%3600/60),r=s%60;return e?`${e}.${t.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`:t?`${t}:${n.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`:`0:${n.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`}return"0:00:00"}static MDtext2link(s){const e=s.match(/\d+\.\)\s/);return e&&(s=s.replace(e[0],e[0].replace(/\s/,"&nbsp;"))),s.replace(/[^a-zA-Zа-яА-Я0-9]/g,"").trim().replace(/\s/g,"").toLowerCase()}static openLink(s,e){s=s.replace(/\/\/([0-9a-f]*:[0-9a-f]*:[0-9a-f]*:[0-9a-f]*:[0-9a-f]*:[0-9a-f]*)(:\d+)?\//i,"//[$1]$2/"),e==="this"?window.location=s:window.open(s,e||"_blank")}static MDgetTitle(s){const e=Te.extractHeader(s),t=e.header;let n=e.body;if(!t.title){n=n.replace(/{[^}]*}/g,""),n=n.trim();const r=n.replace(/\r/g,"").split(`
`);for(let o=0;o<r.length;o++)if(r[o].startsWith("# "))return r[o].substring(2).trim();return""}return t.title}static MDextractHeader(s){const e={};if(s.substring(0,3)==="---"){const t=s.substring(3).indexOf(`
---`);t!==-1&&(s.substring(3,t+3).replace(/\r/g,"").split(`
`).forEach(o=>{if(!o.trim())return;const a=o.indexOf(":");if(a!==-1){const h=o.substring(0,a).trim();e[h]=o.substring(a+1).trim(),e[h]=e[h].replace(/^['"]|['"]$/g,""),e[h]==="true"?e[h]=!0:e[h]==="false"?e[h]=!1:parseFloat(e[h]).toString()===e[h]&&(e[h]=parseFloat(e[h]))}else e[o.trim()]=!0}),s=s.substring(t+7))}return{header:e,body:s}}static MDremoveDocsify(s){const e=s.match(/{docsify-[^}]*}/g);return e&&e.forEach(t=>s=s.replace(t,"")),s}static generateFile(s,e){const t=document.createElement("a");t.setAttribute("href",`data:application/json;charset=utf-8,${encodeURIComponent(JSON.stringify(e,null,2))}`),t.setAttribute("download",s),t.style.display="none",document.body.appendChild(t),t.click(),document.body.removeChild(t)}static quality2text(s){const e=s&4294901760,t=Q[s];let n;return t?n=[t]:s&1?n=[Q[1],`0x${(s&65534).toString(16)}`]:s&2?n=[Q[2],`0x${(s&65533).toString(16)}`]:n=[`0x${s.toString(16)}`],e&&n.push(`0x${(e>>16).toString(16).toUpperCase()}`),n}static clone(s){return JSON.parse(JSON.stringify(s))}static getStates(s){var t;let e=(t=s==null?void 0:s.common)==null?void 0:t.states;if(e){if(typeof e=="string"&&e[0]==="{")try{e=JSON.parse(e)}catch(n){console.error(`Cannot parse states: ${e}`),e=null}else if(typeof e=="string"){const n=e.split(";");e={};for(let r=0;r<n.length;r++){const o=n[r].split(":");e[o[0]]=o[1]}}else if(Array.isArray(e)){const n={};return s.common.type==="number"?e.forEach((r,o)=>n[o]=r):s.common.type==="string"?e.forEach(r=>n[r]=r):s.common.type==="boolean"&&(n.false=e[0],n.true=e[1]),n}}return e}static getSvg(s){return fetch(s).then(e=>e.blob()).then(e=>new Promise(t=>{const n=new FileReader;n.onload=function(){t(this.result)},n.readAsDataURL(e)}))}static detectMimeType(s){const e=Object.keys(R).find(t=>s.startsWith(t));return e?R[e]:null}static isStableRepository(s){return!!(typeof s=="string"&&s.toLowerCase().startsWith("stable")||s&&typeof s!="string"&&s.find(e=>e.toLowerCase().startsWith("stable")))}static isStringInteger(s){return parseInt(s).toString()===s}static isValidDate(s){return s instanceof Date&&!isNaN(s)}static getStyle(s,...e){const t={};for(let n=0;n<e.length;n++)typeof e[n]=="function"?Object.assign(t,e[n](s)):e[n]&&typeof e[n]=="object"&&Object.keys(e[n]).forEach(r=>{if(typeof e[n][r]=="function")t[r]=e[n][r](s);else if(typeof e[n][r]=="object"){const o=e[n][r];t[r]=t[r]||{},Object.keys(o).forEach(a=>{typeof o[a]=="function"?t[r][a]=o(s):(o[a]||o[a]===0)&&(t[r][a]=o[a])})}else(e[n][r]||e[n][r]===0)&&(t[r]=e[n][r])});return t}};X(Te,"namespace",S),X(Te,"INSTANCES","instances"),X(Te,"dateFormat",["DD","MM"]),X(Te,"FORBIDDEN_CHARS",/[^._\-/ :!#$%&()+=@^{}|~\p{Ll}\p{Lu}\p{Nd}]+/gu);let J=Te;const te=J,oe=window.innerWidth<=600?12:void 0;function N(x){return Object.prototype.toString.call(x)==="[object Object]"}const Ae=class Ae extends A.Component{constructor(e){super(e);X(this,"defaultValue");X(this,"isError");X(this,"lang");X(this,"defaultSendToDone");X(this,"sendToTimeout");X(this,"noPlaceRequired");X(this,"onUpdate",e=>{const t=Ae.getValue(e||this.props.data,this.props.attr)||"";this.state.value!==t?this.setState({value:t}):this.forceUpdate()});this.state={confirmDialog:!1,confirmNewValue:null,confirmAttr:null,confirmData:null,confirmCallback:null},this.isError={},e.schema&&(e.custom?this.defaultValue=e.schema.defaultFunc?this.executeCustom(e.schema.defaultFunc,e.data,e.customObj,e.instanceObj,e.arrayIndex,e.globalData):e.schema.default:e.schema.type!=="state"&&(this.defaultValue=e.schema.defaultFunc?this.execute(e.schema.defaultFunc,e.schema.default,e.data,e.arrayIndex,e.globalData):e.schema.default)),this.lang=c.I18n.getLanguage()}componentDidMount(){this.props.registerOnForceUpdate&&this.props.registerOnForceUpdate(this.props.attr,this.onUpdate);const e=["select","autocomplete","autocompleteSendTo"];if(this.defaultValue!==void 0){const t=Ae.getValue(this.props.data,this.props.attr);(t===void 0||e.includes(this.props.schema.type)&&(t===""||t===null))&&setTimeout(()=>{this.props.custom?this.props.onChange(this.props.attr,this.defaultValue,()=>setTimeout(()=>this.props.forceUpdate([this.props.attr],this.props.data),100)):(Ae.setValue(this.props.data,this.props.attr,this.defaultValue),this.props.onChange(this.props.data,void 0,()=>this.props.forceUpdate([this.props.attr],this.props.data)))},100)}else this.props.schema.defaultSendTo&&this.sendTo()}sendTo(){if(this.props.alive){this.defaultSendToDone=!0;let e=this.props.schema.data;if(e===void 0&&this.props.schema.jsonData){const t=this.getPattern(this.props.schema.jsonData);try{e=JSON.parse(t)}catch(n){console.error(`Cannot parse json data: ${t}`)}}else e={attr:this.props.attr,value:Ae.getValue(this.props.data,this.props.attr)};e===void 0&&(e=null),this.props.socket.sendTo(`${this.props.adapterName}.${this.props.instance}`,this.props.schema.defaultSendTo,e).then(t=>{t!=null&&(this.props.custom?this.props.onChange(this.props.attr,t,()=>this.props.forceUpdate([this.props.attr],this.props.data)):(Ae.setValue(this.props.data,this.props.attr,t),this.props.onChange(this.props.data,void 0,()=>this.props.forceUpdate([this.props.attr],this.props.data))))})}else this.defaultSendToDone=!1,this.props.schema.allowSaveWithError||this.onError(this.props.attr,c.I18n.t("ra_Instance %s is not alive",this.props.instance.toString()))}componentWillUnmount(){this.props.registerOnForceUpdate&&this.props.registerOnForceUpdate(this.props.attr),this.sendToTimeout&&(clearTimeout(this.sendToTimeout),this.sendToTimeout=null)}static getValue(e,t){if(typeof t=="string")return Ae.getValue(e,t.split("."));if(t.length===1)return e[t[0]];const n=t.shift();return typeof n=="string"&&typeof e[n]=="object"?Ae.getValue(e[n],t):null}static setValue(e,t,n){if(typeof t=="string"){Ae.setValue(e,t.split("."),n);return}if(t.length===1)n===null?delete e[t[0]]:e[t[0]]=n;else{const r=t.shift();if(typeof r!="string")return;(!e[r]||typeof e[r]=="object")&&(e[r]=e[r]||{}),Ae.setValue(e[r],t,n)}}getText(e,t){if(!e)return"";if(typeof e=="string"){const n=t?e:c.I18n.t(e);return n.includes("${")?this.getPattern(n):n}return N(e)?e.func?typeof e.func=="object"?this.getPattern(e.func[this.lang]||e.func.en||""):this.getPattern(e.func):e[this.lang]||e.en||"":e.toString()}renderDialogConfirm(){if(!this.state.confirmDialog)return null;const e=this.state.confirmData||this.props.schema.confirm;let t=null;return e.type==="warning"?t=i().createElement(u.Warning,null):e.type==="error"?t=i().createElement(u.Error,null):e.type==="info"&&(t=i().createElement(u.Info,null)),i().createElement(c.DialogConfirm,{title:this.getText(e.title)||c.I18n.t("ra_Please confirm"),text:this.getText(e.text),ok:this.getText(e.ok)||c.I18n.t("ra_Ok"),cancel:this.getText(e.cancel)||c.I18n.t("ra_Cancel"),icon:t||void 0,onClose:n=>this.setState({confirmDialog:!1},()=>{if(n){if(this.state.confirmCallback){const o=this.state.confirmCallback;this.setState({confirmCallback:null},()=>o(!0));return}const r=JSON.parse(JSON.stringify(this.props.data));this.state.confirmDepAttr&&Ae.setValue(r,this.state.confirmDepAttr,this.state.confirmDepNewValue),Ae.setValue(r,this.state.confirmAttr,this.state.confirmNewValue),this.setState({confirmDialog:!1,confirmDepAttr:null,confirmDepNewValue:null,confirmNewValue:null,confirmAttr:null,confirmData:null},()=>this.props.onChange(r))}else{const r=this.state.confirmCallback;this.setState({confirmDialog:!1,confirmDepAttr:null,confirmDepNewValue:null,confirmNewValue:null,confirmAttr:null,confirmData:null,confirmCallback:null},()=>{r&&r(!1)})}})})}getIcon(e){e=e||this.props.schema.icon;let t=null;return e==="auth"?t=i().createElement(u.Key,null):e==="send"?t=i().createElement(u.Send,null):e==="web"?t=i().createElement(u.Public,null):e==="warning"?t=i().createElement(u.Warning,null):e==="error"?t=i().createElement(u.Error,null):e==="info"?t=i().createElement(u.Info,null):e==="search"?t=i().createElement(u.Search,null):e==="book"?t=i().createElement(u.MenuBook,null):e==="help"?t=i().createElement(u.Help,null):e==="upload"?t=i().createElement(u.UploadFile,null):e==="edit"?t=i().createElement(u.Edit,null):e==="user"?t=i().createElement(u.Person,null):e==="group"?t=i().createElement(u.Group,null):e==="delete"?t=i().createElement(u.Delete,null):e==="refresh"?t=i().createElement(u.Refresh,null):e==="add"?t=i().createElement(u.Add,null):e==="unpair"?t=i().createElement(u.LinkOff,null):e==="pair"?t=i().createElement(u.Link,null):e==="save"?t=i().createElement(u.Save,null):e==="open"?t=i().createElement(u.OpenInNew,null):e&&((e.endsWith(".png")||e.endsWith(".svg")||e.endsWith(".jpg"))&&!e.startsWith("http://")&&!e.startsWith("https://")&&(e=`./adapter/${this.props.adapterName}/${e}`),t=i().createElement(c.Icon,{src:e,style:{width:22,height:22}})),t}onChangeAsync(e,t){return new Promise(n=>{const r=this.onChange(e,t,n);r instanceof Promise&&r.catch(o=>console.error(`Cannot set value: ${o}`))})}onChange(e,t,n){const r=JSON.parse(JSON.stringify(this.props.data));if(Ae.setValue(r,e,t),this.props.schema.confirm&&this.execute(this.props.schema.confirm.condition,!1,r,this.props.arrayIndex,this.props.globalData))return new Promise(a=>{this.setState({confirmDialog:!0,confirmNewValue:t,confirmAttr:e,confirmData:null},()=>{typeof n=="function"?n():a()})});if(this.props.schema.confirmDependsOn)for(let a=0;a<this.props.schema.confirmDependsOn.length;a++){const h=this.props.schema.confirmDependsOn[a];if(h.confirm){const I=Ae.getValue(r,h.attr);if(this.execute(h.confirm.condition,!1,r,this.props.arrayIndex,this.props.globalData))return new Promise(O=>{this.setState({confirmDialog:!0,confirmNewValue:t,confirmAttr:e,confirmDepNewValue:I,confirmDepAttr:h.attr,confirmData:h.confirm},()=>{typeof n=="function"?n():O()})})}}const o=[];if(this.props.schema.onChangeDependsOn)for(let a=0;a<this.props.schema.onChangeDependsOn.length;a++){const h=this.props.schema.onChangeDependsOn[a];if(h.onChange){const I=Ae.getValue(r,h.attr);let O;this.props.custom?O=this.executeCustom(h.onChange.calculateFunc,r,this.props.customObj,this.props.instanceObj,this.props.arrayIndex,this.props.globalData):O=this.execute(h.onChange.calculateFunc,I,r,this.props.arrayIndex,this.props.globalData),O!==I&&(Ae.setValue(r,h.attr,O),o.push(h.attr))}}if(this.props.schema.hiddenDependsOn)for(let a=0;a<this.props.schema.hiddenDependsOn.length;a++){const h=this.props.schema.hiddenDependsOn[a];h.hidden&&o.push(h.attr)}if(this.props.schema.labelDependsOn)for(let a=0;a<this.props.schema.labelDependsOn.length;a++){const h=this.props.schema.labelDependsOn[a];h.hidden&&o.push(h.attr)}if(this.props.schema.helpDependsOn)for(let a=0;a<this.props.schema.helpDependsOn.length;a++){const h=this.props.schema.helpDependsOn[a];h.hidden&&o.push(h.attr)}if(this.props.schema.onChange&&!this.props.schema.onChange.ignoreOwnChanges){const a=Ae.getValue(r,this.props.attr),h=this.props.custom?this.executeCustom(this.props.schema.onChange.calculateFunc,r,this.props.customObj,this.props.instanceObj,this.props.arrayIndex,this.props.globalData):this.execute(this.props.schema.onChange.calculateFunc,a,r,this.props.arrayIndex,this.props.globalData);h!==a&&Ae.setValue(r,this.props.attr,h)}return this.props.custom?(this.props.onChange(e,t,()=>n&&n()),o!=null&&o.length&&o.forEach((a,h)=>setTimeout(()=>this.props.onChange(a,Ae.getValue(r,a)),h*50))):this.props.onChange(r,void 0,()=>{o.length&&this.props.forceUpdate(o,r),n&&n()}),Promise.resolve()}execute(e,t,n,r,o){let a;if(N(e))a=e.func;else if(typeof e=="string")a=e;else return e;if(!a)return t;try{return new Function("data","originalData","_system","_alive","_common","_socket","_instance","arrayIndex","globalData","_changed",a.includes("return")?a:`return ${a}`)(n||this.props.data,this.props.originalData,this.props.systemConfig,this.props.alive,this.props.common,this.props.socket,this.props.instance,r,o,this.props.changed)}catch(h){return console.error(`Cannot execute ${JSON.stringify(e)}: ${h}`),t}}executeCustom(e,t,n,r,o,a){let h;if(N(e))h=e.func;else if(typeof e=="string")h=e;else return e;if(!h)return null;try{return new Function("data","originalData","_system","instanceObj","customObj","_socket","arrayIndex","globalData","_changed",h.includes("return")?h:`return ${h}`)(t||this.props.data,this.props.originalData,this.props.systemConfig,r,n,this.props.socket,o,a,this.props.changed)}catch(I){return console.error(`Cannot execute ${h}: ${I}`),null}}calculate(e){let t,n,r,o;return this.props.custom?(t=e.validator?!this.executeCustom(e.validator,this.props.data,this.props.customObj,this.props.instanceObj,this.props.arrayIndex,this.props.globalData):!1,e.disabled===!0?n=!0:n=e.disabled?this.executeCustom(e.disabled,this.props.data,this.props.customObj,this.props.instanceObj,this.props.arrayIndex,this.props.globalData):!1,e.hidden===!0?r=!0:r=e.hidden?this.executeCustom(e.hidden,this.props.data,this.props.customObj,this.props.instanceObj,this.props.arrayIndex,this.props.globalData):!1,o=e.defaultFunc?this.executeCustom(e.defaultFunc,this.props.data,this.props.customObj,this.props.instanceObj,this.props.arrayIndex,this.props.globalData):e.default):(t=e.validator?!this.execute(e.validator,!1,this.props.data,this.props.arrayIndex,this.props.globalData):!1,e.disabled===!0?n=!0:n=e.disabled?this.execute(e.disabled,!1,this.props.data,this.props.arrayIndex,this.props.globalData):!1,e.hidden===!0?r=!0:r=e.hidden?this.execute(e.hidden,!1,this.props.data,this.props.arrayIndex,this.props.globalData):!1,o=e.defaultFunc?this.execute(e.defaultFunc,e.default,this.props.data,this.props.arrayIndex,this.props.globalData):e.default),{error:t,disabled:n,hidden:r,defaultValue:o}}onError(e,t){t?this.isError[e]=t:delete this.isError[e],this.props.onError&&this.props.onError(e,t)}renderItem(e,t,n){return this.getText(this.props.schema.label)||this.getText(this.props.schema.text)}renderHelp(e,t,n){return t?i().createElement("a",{href:t,target:"_blank",rel:"noreferrer",style:{color:this.props.themeType==="dark"?"#a147ff":"#5b238f",textDecoration:"underline"}},this.getText(e,n)):(e=this.getText(e,n)||"",e&&(e.includes("<a ")||e.includes("<br")||e.includes("<b>")||e.includes("<i>"))?c.Utils.renderTextWithA(e):e)}static escapeString(e,t){return typeof e!="string"?"":(e=e.replace(/`/g,"\\`"),e=e.replace(/\${([^}]+)}/g,(n,r)=>{if(r&&typeof r=="string"&&r.startsWith("data.")){const o=Ae.getValue(t,r.replace(/^data\./,""));if(typeof o=="string"&&o.includes('"'))return`\${${r}.replace(/"/g, '\\\\"')}`}return n}),e)}getPattern(e,t){if(t=t||this.props.data,!e)return"";let n;typeof e=="object"?e.func?n=e.func:(console.log(`Object must be stringified: ${JSON.stringify(e)}`),n=JSON.stringify(e)):n=e;try{return this.props.custom?new Function("data","originalData","arrayIndex","globalData","_system","instanceObj","customObj","_socket","_changed",`return \`${Ae.escapeString(n,t)}\``)(t,this.props.originalData,this.props.arrayIndex,this.props.globalData,this.props.systemConfig,this.props.instanceObj,this.props.customObj,this.props.socket,this.props.changed):new Function("data","originalData","arrayIndex","globalData","_system","_alive","_common","_socket","_changed",`return \`${Ae.escapeString(n,t)}\``)(t,this.props.originalData,this.props.arrayIndex,this.props.globalData,this.props.systemConfig,this.props.alive,this.props.common,this.props.socket,this.props.changed)}catch(r){return console.error(`Cannot execute ${n}: ${r}`),n}}render(){const e=this.props.schema;if(!e)return null;this.props.alive&&this.defaultSendToDone===!1&&(this.sendToTimeout=setTimeout(()=>{this.sendToTimeout=null,this.sendTo()},200));const{error:t,disabled:n,hidden:r,defaultValue:o}=this.calculate(e);if(r){if(Object.keys(this.isError).length&&(setTimeout(I=>Object.keys(I).forEach(O=>this.props.onError(O)),100,JSON.parse(JSON.stringify(this.isError))),this.isError={}),e.hideOnlyControl){const I=i().createElement(l.Grid2,{size:{xs:e.xs||oe,sm:e.sm||void 0,md:e.md||void 0,lg:e.lg||void 0,xl:e.xl||void 0},style:Y(Y({marginBottom:0,textAlign:"left"},e.style),this.props.themeType==="dark"?e.darkStyle:{})});return e.newLine?i().createElement(i().Fragment,null,i().createElement("div",{style:{flexBasis:"100%",height:0}}),I):I}return null}e.validatorNoSaveOnError&&(t&&!Object.keys(this.isError).length?(this.isError={[this.props.attr]:e.validatorErrorText?c.I18n.t(e.validatorErrorText):!0},setTimeout(I=>Object.keys(I).forEach(O=>this.props.onError(O,I[O])),100,JSON.parse(JSON.stringify(this.isError)))):!t&&Object.keys(this.isError).length&&(setTimeout(I=>Object.keys(I).forEach(O=>this.props.onError(O)),100,JSON.parse(JSON.stringify(this.isError))),this.isError={}));const a=this.renderItem(t,n||this.props.commandRunning||this.props.disabled,o);if(this.noPlaceRequired)return a;const h=i().createElement(l.Grid2,{title:this.getText(e.tooltip),size:{xs:e.xs||12,sm:e.sm||void 0,md:e.md||void 0,lg:e.lg||void 0,xl:e.xl||void 0},style:Y(Y({marginBottom:0,textAlign:"left",width:e.type==="divider"||e.type==="header"?e.width||"100%":void 0},e.style),this.props.themeType==="dark"?e.darkStyle:{})},this.props.schema.defaultSendTo&&this.props.schema.button?i().createElement(l.Grid2,{container:!0,style:{width:"100%"}},i().createElement(l.Grid2,{flex:1},a),i().createElement(l.Grid2,null,i().createElement(l.Button,{variant:"outlined",onClick:()=>this.sendTo(),title:this.props.schema.buttonTooltip?this.getText(this.props.schema.buttonTooltip,this.props.schema.buttonTooltipNoTranslation):c.I18n.t("ra_Request data by instance")},this.getText(this.props.schema.button)))):a);return e.newLine?i().createElement(i().Fragment,null,i().createElement("div",{style:{flexBasis:"100%",height:0}}),this.renderDialogConfirm(),h):this.state.confirmDialog?i().createElement(i().Fragment,null,this.renderDialogConfirm(),h):h}};X(Ae,"DIFFERENT_VALUE","__different__"),X(Ae,"DIFFERENT_LABEL","ra___different__"),X(Ae,"NONE_VALUE",""),X(Ae,"NONE_LABEL","ra_none");let d=Ae;const y={fullWidth:{width:"100%"},accordionSummary:x=>({backgroundColor:x.palette.mode==="dark"?"rgba(255, 255, 255, 0.08)":"rgba(0, 0, 0, 0.08)"}),accordionTitle:{},toolbar:x=>({backgroundColor:x.palette.mode==="dark"?"rgba(255, 255, 255, 0.08)":"rgba(0, 0, 0, 0.08)",borderRadius:"3px"}),tooltip:{pointerEvents:"none"}};class p extends d{constructor(e){super(e);X(this,"typingTimer",null);X(this,"onDelete",e=>()=>{const t=JSON.parse(JSON.stringify(this.state.value));t.splice(e,1),this.setState({value:t,iteration:this.state.iteration+1e4},()=>this.onChangeWrapper(t))});X(this,"onClone",e=>()=>{const t=JSON.parse(JSON.stringify(this.state.value)),n=JSON.parse(JSON.stringify(t[e]));if(typeof this.props.schema.clone=="string"&&typeof n[this.props.schema.clone]=="string"){let r=1,o=n[this.props.schema.clone];const a=o.match(/(\d+)$/);for(a?(o=o.replace(a[0],""),r=parseInt(a[0],10)+1):o+="_";t.find(h=>h[this.props.schema.clone]===o+r.toString());)r++;n[this.props.schema.clone]=`${n[this.props.schema.clone]}_${r}`}t.splice(e,0,n),this.setState({value:t,activeIndex:-1,iteration:this.state.iteration+1e4},()=>this.onChangeWrapper(t))});X(this,"onChangeWrapper",e=>{this.typingTimer&&clearTimeout(this.typingTimer),this.typingTimer=setTimeout(t=>{this.typingTimer=null;const n=this.onChange(this.props.attr,t);n instanceof Promise&&n.catch(r=>this.onError(r))},300,e)});X(this,"onAdd",()=>{const{schema:e}=this.props,t=JSON.parse(JSON.stringify(this.state.value)),n=e.items&&e.items.reduce((r,o)=>{let a;return o.defaultFunc?this.props.custom?a=o.defaultFunc?this.executeCustom(o.defaultFunc,this.props.data,this.props.customObj,this.props.instanceObj,t.length,this.props.data):this.props.schema.default:a=o.defaultFunc?this.execute(o.defaultFunc,this.props.schema.default,this.props.data,t.length,this.props.data):this.props.schema.default:a=o.default===void 0?null:o.default,r[o.attr]=a,r},{});t.push(n),this.setState({value:t,activeIndex:t.length-1},()=>this.onChangeWrapper(t))});this.props.schema.items=this.props.schema.items||[]}componentDidMount(){super.componentDidMount();let e=d.getValue(this.props.data,this.props.attr)||[];Array.isArray(e)||(e=[]),this.setState({value:e,activeIndex:-1,iteration:0})}componentWillUnmount(){this.typingTimer&&(clearTimeout(this.typingTimer),this.typingTimer=null),super.componentWillUnmount()}itemAccordion(e,t){const{value:n}=this.state,{schema:r}=this.props,o={type:"panel",items:r.items.reduce((a,h)=>(a[h.attr]=h,a),{}),style:{marginLeft:"-8px",marginTop:"10px",marginBottom:"10px"}};return i().createElement(Lt,{index:t+this.state.iteration,arrayIndex:t,changed:this.props.changed,globalData:this.props.data,socket:this.props.socket,adapterName:this.props.adapterName,instance:this.props.instance,common:this.props.common,alive:this.props.alive,themeType:this.props.themeType,themeName:this.props.themeName,data:e,custom:!0,schema:o,systemConfig:this.props.systemConfig,originalData:this.props.originalData,customs:this.props.customs,dateFormat:this.props.dateFormat,isFloatComma:this.props.isFloatComma,forceUpdate:this.props.forceUpdate,imagePrefix:this.props.imagePrefix,onCommandRunning:this.props.onCommandRunning,onChange:(a,h)=>{const I=JSON.parse(JSON.stringify(n));I[t][a]=h,this.setState({value:I},()=>this.onChangeWrapper(I))},onError:(a,h)=>this.onError(a,h),onBackEndCommand:this.props.onBackEndCommand,table:this.props.table,DeviceManager:this.props.DeviceManager,theme:this.props.theme})}onMoveUp(e){const t=JSON.parse(JSON.stringify(this.state.value)),n=t[e];t.splice(e,1),t.splice(e-1,0,n);const r=this.state.activeIndex-1;this.setState({value:t,activeIndex:r,iteration:this.state.iteration+1e4},()=>this.onChangeWrapper(t))}onMoveDown(e){const t=JSON.parse(JSON.stringify(this.state.value)),n=t[e];t.splice(e,1),t.splice(e+1,0,n);const r=this.state.activeIndex+1;this.setState({value:t,activeIndex:r,iteration:this.state.iteration+1e4},()=>this.onChangeWrapper(t))}renderItem(){const{schema:e}=this.props,{value:t}=this.state;return t?i().createElement(l.Paper,null,e.label||!e.noDelete?i().createElement(l.Toolbar,{variant:"dense"},e.label?i().createElement(l.Typography,{variant:"h6",id:"tableTitle",component:"div"},this.getText(e.label)):null,e.noDelete?null:i().createElement(l.IconButton,{size:"small",color:"primary",onClick:this.onAdd},i().createElement(u.Add,null))):null,t.map((n,r)=>i().createElement(l.Accordion,{key:`${n}_${r}`,expanded:this.state.activeIndex===r,onChange:(o,a)=>this.setState({activeIndex:a?r:-1})},i().createElement(l.AccordionSummary,{expandIcon:i().createElement(u.ExpandMore,null),sx:te.getStyle(this.props.theme,y.fullWidth,y.accordionSummary)},i().createElement(l.Typography,{style:y.accordionTitle},n[e.titleAttr])),i().createElement(l.AccordionDetails,{style:Y(Y({},e.style),this.props.themeType?e.darkStyle:void 0)},this.itemAccordion(t[r],r),i().createElement(l.Toolbar,{sx:y.toolbar},r?i().createElement(l.Tooltip,{title:c.I18n.t("ra_Move up"),slotProps:{popper:{sx:y.tooltip}}},i().createElement(l.IconButton,{size:"small",onClick:()=>this.onMoveUp(r)},i().createElement(u.ArrowUpward,null))):i().createElement("div",{style:y.buttonEmpty}),r<t.length-1?i().createElement(l.Tooltip,{title:c.I18n.t("ra_Move down"),slotProps:{popper:{sx:y.tooltip}}},i().createElement(l.IconButton,{size:"small",onClick:()=>this.onMoveDown(r)},i().createElement(u.ArrowDownward,null))):i().createElement("div",{style:y.buttonEmpty}),e.noDelete?null:i().createElement(l.Tooltip,{title:c.I18n.t("ra_Delete current row"),slotProps:{popper:{sx:y.tooltip}}},i().createElement(l.IconButton,{size:"small",onClick:this.onDelete(r)},i().createElement(u.Delete,null))),e.clone?i().createElement(l.Tooltip,{title:c.I18n.t("ra_Clone current row"),slotProps:{popper:{sx:y.tooltip}}},i().createElement(l.IconButton,{size:"small",onClick:this.onClone(r)},i().createElement(u.ContentCopy,null))):null)))),!e.noDelete&&t.length>0?i().createElement(l.Toolbar,{variant:"dense",sx:y.rootTool},i().createElement(l.IconButton,{size:"small",color:"primary",onClick:this.onAdd},i().createElement(u.Add,null))):null,e.help?i().createElement(l.FormHelperText,null,this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)):null):null}}const g=p,m={root:{width:"100%"},notAlive:{color:"#a30000"}};class b extends d{componentDidMount(){super.componentDidMount();const s=this.getInstance();this.props.socket.getState(`${s}.alive`).then(e=>this.setState({alive:!!(e&&e.val),instance:s}))}getInstance(){let s=this.props.schema.instance||`${this.props.adapterName}.${this.props.instance}`;return s.includes("${")&&(s=this.getPattern(s)),s&&!s.startsWith("system.adapter.")&&(s=`system.adapter.${s}`),s}renderItem(){if(this.getInstance()!==this.state.instance&&setTimeout(()=>{const e=this.getInstance();e?this.props.socket.getState(`${e}.alive`).then(t=>this.setState({alive:!!(t&&t.val),instance:e})):this.setState({alive:null,instance:e})},200),this.state.alive!==!1&&this.state.alive!==!0)return null;const s=this.state.instance.replace(/^system.adapter./,"");return i().createElement("div",{style:Y(Y({},m.root),this.state.alive?void 0:m.notAlive)},this.state.alive?this.props.schema.textAlive!==void 0?this.props.schema.textAlive?c.I18n.t(this.props.schema.textAlive,s):"":c.I18n.t("ra_Instance %s is alive",s):this.props.schema.textNotAlive!==void 0?this.props.schema.textNotAlive?c.I18n.t(this.props.schema.textNotAlive,s):"":c.I18n.t("ra_Instance %s is not alive",s))}}const E=b;class k extends d{componentDidMount(){super.componentDidMount();const s=d.getValue(this.props.data,this.props.attr),e=this.props.schema.options.map(t=>typeof t=="string"?{label:t,value:t}:JSON.parse(JSON.stringify(t)));Array.isArray(s)?(e.unshift({label:c.I18n.t(d.DIFFERENT_LABEL),value:d.DIFFERENT_VALUE}),this.setState({value:d.DIFFERENT_VALUE,selectOptions:e})):this.setState({value:s,selectOptions:e})}renderItem(s,e){if(!this.state.selectOptions)return null;let t;const n=JSON.parse(JSON.stringify(this.state.selectOptions));return Array.isArray(this.state.value)||this.state.value===d.DIFFERENT_VALUE?([...this.state.value].filter(o=>!n.find(a=>typeof a=="object"?a.value===o:a===o)).forEach(o=>n.push({label:o.toString(),value:o})),t={label:c.I18n.t(d.DIFFERENT_LABEL),value:d.DIFFERENT_VALUE},n.unshift(t)):(t=this.state.value!==null&&this.state.value!==void 0&&n.find(o=>typeof o=="object"?o.value==this.state.value:o==this.state.value),this.state.value!==null&&this.state.value!==void 0&&!t&&this.props.schema.freeSolo&&(t={value:this.state.value,label:this.state.value},n.push(t))),i().createElement(l.Autocomplete,{fullWidth:!0,freeSolo:!!this.props.schema.freeSolo,value:t,options:n,onInputChange:o=>{if(!o||!this.props.schema.freeSolo)return;const a=o.target.value;a!==this.state.value&&this.setState({value:a},()=>this.onChange(this.props.attr,a))},onChange:(o,a)=>{const h=typeof a=="object"?a?a.value:"":a;h!==this.state.value&&this.setState({value:h},()=>this.onChange(this.props.attr,h))},getOptionLabel:o=>{var a;return typeof o=="object"&&(a=o==null?void 0:o.label)!=null?a:""},renderInput:o=>i().createElement(l.TextField,$e(Y({variant:"standard"},o),{error:!!s,placeholder:this.getText(this.props.schema.placeholder),label:this.getText(this.props.schema.label),helperText:this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation),disabled:e}))})}}const B=k;class _ extends d{constructor(){super(...arguments);X(this,"initialized",!1);X(this,"_context")}askInstance(){const e=d.getValue(this.props.data,this.props.attr),t=this.props.schema.options?this.props.schema.options.map(n=>typeof n=="string"?{label:n,value:n}:JSON.parse(JSON.stringify(n))):[];if(this.props.alive){let n=this.props.schema.data;if(n===void 0&&this.props.schema.jsonData){const r=this.getPattern(this.props.schema.jsonData);try{typeof r=="string"&&(n=JSON.parse(r))}catch(o){console.error(`Cannot parse json data: ${JSON.stringify(n)}`)}}n===void 0&&(n=null),this.props.socket.sendTo(`${this.props.adapterName}.${this.props.instance}`,this.props.schema.command||"send",n).then(r=>{r&&Array.isArray(r)&&r.forEach(o=>t.push(typeof o=="string"?{label:o,value:o}:JSON.parse(JSON.stringify(o)))),Array.isArray(e)?(t.unshift({label:c.I18n.t(d.DIFFERENT_LABEL),value:d.DIFFERENT_VALUE}),this.setState({value:d.DIFFERENT_VALUE,selectOptions:t})):this.setState({value:e,selectOptions:t})})}else Array.isArray(e)?(t.unshift({label:c.I18n.t(d.DIFFERENT_LABEL),value:d.DIFFERENT_VALUE}),this.setState({value:d.DIFFERENT_VALUE,selectOptions:t})):this.setState({value:e,selectOptions:t})}getContext(){const e={};return Array.isArray(this.props.schema.alsoDependsOn)&&this.props.schema.alsoDependsOn.forEach(t=>e[t]=d.getValue(this.props.data,t)),JSON.stringify(e)}renderItem(e,t){if(this.props.alive){const a=this.getContext();(a!==this._context||!this.initialized)&&(this._context=a,setTimeout(()=>this.askInstance(),this.initialized?300:50),this.initialized=!0)}let n;const r=this.state.selectOptions?JSON.parse(JSON.stringify(this.state.selectOptions)):[];return Array.isArray(this.state.value)||this.state.value===d.DIFFERENT_LABEL?([...this.state.value].filter(a=>!r.find(h=>h.value===a)).forEach(a=>r.push({label:a.toString(),value:a})),n={label:c.I18n.t(d.DIFFERENT_LABEL),value:d.DIFFERENT_VALUE},r.unshift(n)):(n=this.state.value!==null&&this.state.value!==void 0&&r.find(a=>a.value==this.state.value),this.state.value!==null&&this.state.value!==void 0&&!n&&this.props.schema.freeSolo&&(n={value:this.state.value,label:this.state.value},r.push(n)),n=n||null),r.length?i().createElement(l.Autocomplete,{value:n,fullWidth:!0,freeSolo:!!this.props.schema.freeSolo,options:r,getOptionLabel:a=>{var h;return(h=a==null?void 0:a.label)!=null?h:""},onInputChange:a=>{if(!a||!this.props.schema.freeSolo)return;const h=a.target.value;h!==this.state.value&&this.setState({value:h},()=>this.onChange(this.props.attr,h))},onChange:(a,h)=>{const I=typeof h=="object"?h?h.value:"":h;I!==this.state.value&&this.setState({value:I},()=>this.onChange(this.props.attr,I))},renderInput:a=>i().createElement(l.TextField,$e(Y({variant:"standard"},a),{error:!!e,placeholder:this.getText(this.props.schema.placeholder),label:this.getText(this.props.schema.label),helperText:this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation),disabled:t}))}):i().createElement(l.TextField,{variant:"standard",fullWidth:!0,value:this.state.value===null||this.state.value===void 0?"":this.state.value,error:!!e,disabled:t,slotProps:{htmlInput:{maxLength:this.props.schema.maxLength||this.props.schema.max||void 0}},onChange:a=>{const h=a.target.value;this.setState({value:h},()=>this.onChange(this.props.attr,(h||"").trim()))},placeholder:this.getText(this.props.schema.placeholder),label:this.getText(this.props.schema.label),helperText:this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)})}}const F=_,T={fullWidth:{width:"100%"},flex:{display:"flex"},button:{height:48,marginLeft:4,minWidth:48}};class W extends d{componentDidMount(){super.componentDidMount();const{data:s,attr:e}=this.props,t=d.getValue(s,e)||"";this.setState({value:t,showDialog:!1})}renderItem(s,e){const{schema:t,attr:n}=this.props,{value:r,showDialog:o}=this.state;return i().createElement(l.FormControl,{style:T.fullWidth,variant:"standard"},t.label?i().createElement(l.InputLabel,{shrink:!0},this.getText(t.label)):null,i().createElement("div",{style:T.flex},i().createElement(l.TextField,{variant:"standard",fullWidth:!0,value:r!=null?r:"",error:!!s,disabled:e,placeholder:this.getText(t.placeholder),label:this.getText(t.label),helperText:this.renderHelp(t.help,t.helpLink,t.noTranslation),onChange:a=>{const h=a.target.value;this.setState({value:h},()=>this.onChange(n,h))}}),i().createElement(l.Button,{color:"grey",style:T.button,size:"small",variant:"outlined",onClick:()=>this.setState({showDialog:!0})},"...")),o?i().createElement(c.DialogCron,{title:c.I18n.t("ra_Define schedule"),simple:t.simple,complex:t.complex,cron:r,onClose:()=>this.setState({showDialog:!1}),cancel:c.I18n.t("ra_Cancel"),ok:c.I18n.t("ra_Ok"),theme:this.props.theme,onOk:a=>this.setState({showDialog:!1,value:a},()=>this.onChange(n,a))}):null)}}const re=W;class Z extends d{componentDidMount(){return pe(this,null,function*(){st(Z.prototype,this,"componentDidMount").call(this);const s=d.getValue(this.props.data,this.props.attr),t=(yield this.props.socket.getCertificates()).filter(n=>{const r=this.props.attr.toLowerCase();return r.includes(n.type)||n.type==="public"&&r.includes("cert")||n.type==="private"&&(r.includes("priv")||r.includes("key"))?!0:!!(n.type==="chained"&&(r.includes("chain")||r.includes("ca")))}).map(n=>({label:n.name,value:n.name}));t.unshift({label:c.I18n.t(d.NONE_LABEL),value:d.NONE_VALUE}),this.setState({value:s,selectOptions:t})})}renderItem(s,e){var n,r;if(!this.state.selectOptions)return null;const t=(n=this.state.selectOptions)==null?void 0:n.find(o=>o.value===this.state.value);return i().createElement(l.FormControl,{style:{width:"100%"},variant:"standard"},this.props.schema.label?i().createElement(l.InputLabel,{shrink:!0},this.getText(this.props.schema.label)):null,i().createElement(l.Select,{variant:"standard",error:!!s,displayEmpty:!0,disabled:!!e,value:this.state.value,renderValue:()=>this.getText(t==null?void 0:t.label,this.props.schema.noTranslation!==!1),onChange:o=>this.setState({value:o.target.value},()=>this.onChange(this.props.attr,this.state.value))},(r=this.state.selectOptions)==null?void 0:r.map(o=>i().createElement(l.MenuItem,{key:o.value,value:o.value,style:o.value===d.NONE_VALUE?{opacity:.5}:{}},this.getText(o.label,this.props.schema.noTranslation!==!1)))),this.props.schema.help?i().createElement(l.FormHelperText,null,this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)):null)}}const ce=Z,le={fullWidth:{width:"100%"},leWidth:{width:620,marginBottom:10},certWidth:{width:200,marginRight:10}};class V extends d{componentDidMount(){return pe(this,null,function*(){var a;st(V.prototype,this,"componentDidMount").call(this);const s=yield this.props.socket.getCertificates(),e=[],t=[],n=[];let r=[];const o=yield this.props.socket.getObject("system.certificates");(a=o==null?void 0:o.native)!=null&&a.collections?r=Object.keys(o.native.collections):r=null,s.forEach(h=>{h.type==="public"?e.push({label:h.name,value:h.name}):h.type==="private"?t.push({label:h.name,value:h.name}):h.type==="chained"?n.push({label:h.name,value:h.name}):(e.push({label:h.name,value:h.name}),t.push({label:h.name,value:h.name}),n.push({label:h.name,value:h.name}))}),e.unshift({label:c.I18n.t(d.NONE_LABEL),value:d.NONE_VALUE}),t.unshift({label:c.I18n.t(d.NONE_LABEL),value:d.NONE_VALUE}),n.unshift({label:c.I18n.t(d.NONE_LABEL),value:d.NONE_VALUE}),this.setState({certsPublicOptions:e,certsChainOptions:n,certsPrivateOptions:t,collectionsOptions:r})})}renderItem(s,e){var O,L,q,he,Ee,se,ye;if(!this.state.certsPublicOptions||!this.state.certsPrivateOptions||!this.state.certsChainOptions)return null;const t=(d.getValue(this.props.data,this.props.schema.leCollectionName||"leCollection")||"false").toString(),n=d.getValue(this.props.data,this.props.schema.certPublicName||"certPublic"),r=d.getValue(this.props.data,this.props.schema.certPrivateName||"certPrivate"),o=d.getValue(this.props.data,this.props.schema.certChainedName||"certChained"),a=(O=this.state.certsPublicOptions)==null?void 0:O.find(fe=>fe.value===n),h=(L=this.state.certsPrivateOptions)==null?void 0:L.find(fe=>fe.value===r),I=(q=this.state.certsChainOptions)==null?void 0:q.find(fe=>fe.value===o);return i().createElement("div",{style:le.fullWidth},this.state.collectionsOptions?i().createElement(l.FormControl,{style:le.leWidth,variant:"standard"},i().createElement(l.InputLabel,{shrink:!0},"Let's encrypt"),i().createElement(l.Select,{variant:"standard",error:!!s,displayEmpty:!0,disabled:!!e,value:t,onChange:fe=>this.onChange(this.props.schema.leCollectionName||"leCollection",fe.target.value==="false"?!1:fe.target.value==="true"?!0:fe.target.value)},i().createElement(l.MenuItem,{key:"_false",value:"false",style:{fontWeight:"bold"}},c.I18n.t("ra_Do not use let's encrypt")),i().createElement(l.MenuItem,{key:"_true",value:"true",style:{fontWeight:"bold"}},c.I18n.t("ra_Use all available let's encrypt certificates")),(he=this.state.collectionsOptions)==null?void 0:he.map(fe=>i().createElement(l.MenuItem,{key:fe,value:fe},fe)))):null,this.state.collectionsOptions?i().createElement("br",null):null,this.state.collectionsOptions&&t!=="false"?i().createElement("div",null,c.I18n.t("ra_Fallback custom certificates")):null,i().createElement(l.FormControl,{style:le.certWidth,variant:"standard"},i().createElement(l.InputLabel,{shrink:!0},c.I18n.t("ra_Public certificate")),i().createElement(l.Select,{variant:"standard",error:!!s,displayEmpty:!0,disabled:!!e,value:n||"",renderValue:()=>this.getText(a==null?void 0:a.label),onChange:fe=>this.onChange(this.props.schema.certPublicName||"certPublic",fe.target.value)},(Ee=this.state.certsPublicOptions)==null?void 0:Ee.map((fe,Xe)=>i().createElement(l.MenuItem,{key:`${fe.value}_${Xe}`,value:fe.value,style:fe.value===d.NONE_VALUE?{opacity:.5}:{}},this.getText(fe.label))))),i().createElement(l.FormControl,{style:le.certWidth,variant:"standard"},i().createElement(l.InputLabel,{shrink:!0},c.I18n.t("ra_Private certificate")),i().createElement(l.Select,{variant:"standard",error:!!s,displayEmpty:!0,disabled:!!e,value:r||"",renderValue:()=>this.getText(h==null?void 0:h.label),onChange:fe=>this.onChange(this.props.schema.certPrivateName||"certPrivate",fe.target.value)},(se=this.state.certsPrivateOptions)==null?void 0:se.map((fe,Xe)=>i().createElement(l.MenuItem,{key:`${fe.value}_${Xe}`,value:fe.value,style:fe.value===d.NONE_VALUE?{opacity:.5}:{}},this.getText(fe.label))))),i().createElement(l.FormControl,{style:le.certWidth,variant:"standard"},i().createElement(l.InputLabel,{shrink:!0},c.I18n.t("ra_Chained certificate")),i().createElement(l.Select,{variant:"standard",error:!!s,displayEmpty:!0,disabled:!!e,value:o||"",renderValue:()=>this.getText(I==null?void 0:I.label),onChange:fe=>this.onChange(this.props.schema.certChainedName||"certChained",fe.target.value)},(ye=this.state.certsChainOptions)==null?void 0:ye.map((fe,Xe)=>i().createElement(l.MenuItem,{key:`${fe.value}_${Xe}`,value:fe.value,style:fe.value===d.NONE_VALUE?{opacity:.5}:{}},this.getText(fe.label))))))}}const z=V;class j extends d{componentDidMount(){return pe(this,null,function*(){var t;st(j.prototype,this,"componentDidMount").call(this);let s;const e=yield this.props.socket.getObject("system.certificates");(t=e==null?void 0:e.native)!=null&&t.collections?s=Object.keys(e.native.collections):s=[],this.setState({collectionsOptions:s})})}renderItem(s,e){var n;if(!this.state.collectionsOptions)return null;const t=(d.getValue(this.props.data,this.props.schema.leCollectionName||"leCollection")||"false").toString();return i().createElement(l.FormControl,{style:{width:"100%"},variant:"standard"},this.props.schema.label?i().createElement(l.InputLabel,{shrink:!0},this.getText(this.props.schema.label)):null,i().createElement(l.Select,{variant:"standard",error:!!s,displayEmpty:!0,disabled:!!e,value:t,onChange:r=>this.onChange(this.props.schema.leCollectionName||"leCollection",r.target.value==="false"?!1:r.target.value==="true"?!0:r.target.value)},i().createElement(l.MenuItem,{key:"_false",value:"false",style:{fontWeight:"bold"}},c.I18n.t("ra_Do not use let's encrypt")),i().createElement(l.MenuItem,{key:"_true",value:"true",style:{fontWeight:"bold"}},c.I18n.t("ra_Use all available let's encrypt certificates")),(n=this.state.collectionsOptions)==null?void 0:n.map(r=>i().createElement(l.MenuItem,{key:r,value:r},r))),this.props.schema.help?i().createElement(l.FormHelperText,null,this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)):null)}}const K=j,Se={fullWidth:{width:"100%"},icon:{width:24,height:24,marginRight:4},licLabel:{fontWeight:"bold",minWidth:100,marginRight:10,textTransform:"capitalize",display:"inline-block"},licValue:{fontWeight:"normal"},errorTitle:x=>({color:x.palette.mode==="dark"?"#e39191":"#b62020"}),okTitle:x=>({color:x.palette.mode==="dark"?"#6fd56f":"#007c00"}),errorText:x=>({color:x.palette.mode==="dark"?"#e39191":"#b62020",mb:"30px"})};class ue extends d{componentDidMount(){super.componentDidMount(),this.setState({_error:"",running:!1,showLicenseData:null,foundSuitableLicense:!1,licenseOfflineCheck:!1,result:null,allLicenses:null,askForUpdate:!1,showLinkToProfile:!1})}renderErrorDialog(){if(this.state._error&&!this.state.showLicenseData){let s=this.state._error;return this.state.allLicenses&&(s=[i().createElement("div",{key:"error"},s)],s.push(i().createElement(l.Button,{key:"button",variant:"contained",onClick:()=>window.open("https://iobroker.net/www/account/licenses","_blank")},c.I18n.t("iobroker.net"))),this.state.allLicenses.length?s.push(i().createElement(l.TableContainer,{key:"table"},i().createElement(l.Table,{size:"small"},i().createElement(l.TableHead,null,i().createElement(l.TableRow,null,i().createElement(l.TableCell,null,c.I18n.t("ra_Product")),i().createElement(l.TableCell,null,c.I18n.t("ra_Version")),i().createElement(l.TableCell,null,"UUID"),i().createElement(l.TableCell,null,c.I18n.t("ra_ValidTill")),i().createElement(l.TableCell,null,c.I18n.t("ra_Commercial")),i().createElement(l.TableCell,null,"ID"))),i().createElement(l.TableBody,null,this.state.allLicenses.map(e=>i().createElement(l.TableRow,{key:e.id},i().createElement(l.TableCell,{sx:e.validName?null:Se.errorText},e.license.product),i().createElement(l.TableCell,{sx:e.validVersion?null:Se.errorText},e.license.version),i().createElement(l.TableCell,{sx:e.validUuid?null:Se.errorText},e.license.uuid||"--"),i().createElement(l.TableCell,{sx:e.validTill?null:Se.errorText},e.license.validTill&&e.license.validTill!=="0000-00-00 00:00:00"?new Date(e.license.validTill).toLocaleDateString():"--"),i().createElement(l.TableCell,null,e.license.invoice!=="free"?e.license.invoice==="MANUALLY_CREATED"?"\u2713":e.license.invoice:"-"),i().createElement(l.TableCell,null,e.id))))))):(s.push(i().createElement("div",{key:"text1"},c.I18n.t("ra_No one license found in license manager"))),s.push(i().createElement("div",{key:"text2"},c.I18n.t("ra_Please create license"))))),i().createElement(l.Dialog,{open:!0,maxWidth:"xl",fullWidth:this.props.fullWidth!==void 0?this.props.fullWidth:!0,onClick:()=>this.setState({_error:"",allLicenses:null})},i().createElement(l.DialogTitle,null,c.I18n.t("ra_Error")),i().createElement(l.DialogContent,null,i().createElement(l.DialogContentText,null,s)),i().createElement(l.DialogActions,null,i().createElement(l.Button,{variant:"contained",onClick:()=>this.setState({_error:"",allLicenses:null}),color:"primary",autoFocus:!0,startIcon:i().createElement(u.Check,null)},c.I18n.t("ra_Ok"))))}return null}renderMessageDialog(){if(this.state.showLicenseData){const s=[],e=this.state.showLicenseData;return Object.keys(e).forEach(t=>{if(!(e[t]===null||e[t]===void 0))if(typeof e[t]=="object"){const n=e[t];Object.keys(n).forEach(r=>{n[r]!==null&&n[r]!==void 0&&(typeof n[r]=="object"?s.push(i().createElement("div",{key:r},i().createElement("div",{style:Se.licLabel},r,":"),JSON.stringify(n[r],null,2))):s.push(i().createElement("div",{key:r},i().createElement("div",{style:Se.licLabel},t," -",r,":"),n[r].toString())))})}else s.push(i().createElement("div",{key:t},i().createElement("div",{style:Se.licLabel},t.replace(/_/g," "),":"),e[t].toString()))}),s.push(i().createElement("div",{key:"checked"},i().createElement("div",{style:Se.licLabel},c.I18n.t("ra_Checked"),":"),this.state.licenseOfflineCheck?c.I18n.t("ra_locally"):c.I18n.t("ra_via internet"))),i().createElement(l.Dialog,{open:!0,onClose:()=>this.setState({showLicenseData:null})},i().createElement(l.DialogTitle,null,i().createElement(l.Box,{component:"span",sx:this.state.result?Se.okTitle:Se.errorTitle},c.I18n.t("ra_License %s",this.state.result?"OK":"INVALID"))),i().createElement(l.DialogContent,null,this.state.showLinkToProfile?i().createElement(l.Button,{variant:"contained",onClick:()=>window.open("https://iobroker.net/www/account/licenses","_blank")},"https://iobroker.net"):null,this.state._error?i().createElement(l.Box,{component:"div",sx:Se.errorText},this.state._error):null,s),i().createElement(l.DialogActions,null,i().createElement(l.Button,{onClick:()=>this.setState({showLicenseData:null,_error:""}),color:"primary",variant:"contained"},c.I18n.t("ra_Close"))))}return null}static parseJwt(s){const t=s.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),n=decodeURIComponent(atob(t).split("").map(r=>`%${`00${r.charCodeAt(0).toString(16)}`.slice(-2)}`).join(""));try{return JSON.parse(n)}catch(r){return null}}static isVersionValid(s,e,t,n){if(!e||!s)return!0;let r=!0;const[o]=s.split(".");return e.startsWith(">=")?r=parseInt(o,10)>=parseInt(e.substring(2,10)):e.startsWith("<=")?r=parseInt(o,10)<=parseInt(e.substring(2,10)):e.startsWith(">")?r=parseInt(o,10)>parseInt(e.substring(1,10)):e.startsWith("<")?r=parseInt(o,10)<parseInt(e.substring(1,10)):e.startsWith("=")?r=parseInt(o,10)===parseInt(e.substring(1,10)):e.startsWith("==")?r=parseInt(o,10)===parseInt(e.substring(2,10)):e.startsWith("===")&&(r=parseInt(o,10)===parseInt(e.substring(3,10))),!0}findInLicenseManager(s){return pe(this,null,function*(){var n,r,o,a;const e=yield this.props.socket.getObject("system.licenses"),t=[];if((r=(n=e==null?void 0:e.native)==null?void 0:n.licenses)!=null&&r.length){let h=null;const I=Date.now();let O;if(this.props.schema.uuid){const q=yield this.props.socket.getObject("system.meta.uuid");O=(o=q==null?void 0:q.native)==null?void 0:o.uuid}let L;if(this.props.schema.version){const q=yield this.props.socket.getObject(`system.adapter.${s}`);L=(a=q==null?void 0:q.common)==null?void 0:a.version}e.native.licenses.forEach(q=>{const he=!q.validTill||q.validTill==="0000-00-00 00:00:00"||new Date(q.validTill).getTime()>I,Ee=(q.product||"").split("."),se=Ee[1]===s||s==="vis-2"&&Ee[1]==="vis",ye=!O||!q.uuid||q.uuid===O,fe=ue.isVersionValid(L,q.version,q.invoice,s);(!h||q.invoice!=="free")&&he&&se&&ye&&fe&&(h=q),t.push({id:q.id,validName:se,validUuid:ye,validVersion:fe,validTill:he,license:q})}),h&&(t.find(q=>q.id===h.id).used=!0)}return t})}checkLicense(s,e){return pe(this,null,function*(){var a,h,I;let t;if(this.props.schema.uuid){const O=yield this.props.socket.getObject("system.meta.uuid");t=(a=O==null?void 0:O.native)==null?void 0:a.uuid}let n;if(this.props.schema.version){const O=yield this.props.socket.getObject(`system.adapter.${e}`);n=(h=O==null?void 0:O.common)==null?void 0:h.version}const r=new AbortController;let o=setTimeout(()=>{o=null,r.abort()},5e3);try{const O=yield window.fetch("https://iobroker.net/api/v1/public/cert/",{method:"POST",body:JSON.stringify({json:s,uuid:t}),headers:{"Content-Type":"text/plain"},signal:r.signal});o&&clearTimeout(o);const L=yield O.text();let q;try{q=JSON.parse(L)}catch(he){}if(q!=null&&q.error)try{const he=ue.parseJwt(s),Ee=c.I18n.t(`ra_${he.error||q.error||"Unknown error"}`).replace(/^ra_/,"");return this.setState({_error:Ee,licenseOfflineCheck:!1,showLicenseData:he,result:!1,running:!1})}catch(he){return console.log("Cannot parse license"),this.setState({_error:q.error,result:!1,running:!1})}else{let he=null;try{he=ue.parseJwt(s)}catch(Ee){}if(q){const Ee=q.validTill||q.valid_till;if(Ee&&Ee!=="0000-00-00 00:00:00"&&new Date(Ee).getTime()<Date.now())return this.setState({_error:c.I18n.t("ra_License expired on %s",new Date(Ee).toLocaleString()),licenseOfflineCheck:!1,showLicenseData:he,result:!1,running:!1});const se=(q.name||"").split(".");return se[1]===e||se[1]==="vis"&&e==="vis-2"?t&&!q.uuid&&e==="vis-2"?this.setState({_error:c.I18n.t("ra_License must be converted",q.uuid),showLinkToProfile:!0,licenseOfflineCheck:!1,showLicenseData:he,result:!1,running:!1}):t&&q.uuid&&q.uuid!==t?this.setState({_error:c.I18n.t('ra_Serial number (UUID) "%s" in license is for other device.',q.uuid),licenseOfflineCheck:!1,showLicenseData:he,result:!1,running:!1}):ue.isVersionValid(n,q.version,q.invoice,e)?this.setState({licenseOfflineCheck:!1,showLicenseData:he,result:!0,running:!1}):this.setState({_error:c.I18n.t("ra_License is for version %s, but required version is %s",q.version,this.props.schema.version),licenseOfflineCheck:!1,showLicenseData:he,result:!1,running:!1}):this.setState({_error:c.I18n.t('ra_License for other product "%s"',q.name),licenseOfflineCheck:!1,showLicenseData:he,result:!1,running:!1})}throw new Error("ra_Invalid answer from server")}}catch(O){if(((I=O==null?void 0:O.response)==null?void 0:I.status)===404)return this.setState({_error:c.I18n.t("ra_License does not exist"),result:!1,running:!1});try{const L=ue.parseJwt(s),q=(L.name||"").split(".");return L.valid_till&&L.valid_till!=="0000-00-00 00:00:00"&&new Date(L.valid_till).getTime()<Date.now()?this.setState({_error:c.I18n.t("ra_License expired on %s",new Date(L.valid_till).toLocaleString()),showLicenseData:L,licenseOfflineCheck:!0,running:!1,result:!1}):q[1]===e?t&&L.uuid&&L.uuid!==t?this.setState({_error:c.I18n.t('ra_Serial number (UUID) "%s" in license is for other device.',L.uuid),showLicenseData:L,licenseOfflineCheck:!0,result:!1,running:!1}):ue.isVersionValid(n,L.version,L.invoice,e)?this.setState({running:!1,result:!0,licenseOfflineCheck:!0,showLicenseData:L}):this.setState({_error:c.I18n.t("ra_License is for version %s, but required version is %s",L.version,this.props.schema.version),licenseOfflineCheck:!0,showLicenseData:L,result:!1,running:!1}):this.setState({_error:c.I18n.t('ra_License for other product "%s"',L.name),licenseOfflineCheck:!0,showLicenseData:L,result:!1,running:!1})}catch(L){return this.setState({_error:c.I18n.t("ra_Cannot decode license"),result:!1,licenseOfflineCheck:!0,running:!1})}}})}renderAskForUpdate(){return this.state.askForUpdate?i().createElement(c.DialogConfirm,{text:c.I18n.t("ra_License not found in license manager. Do you want to read licenses from iobroker.net?"),ok:c.I18n.t("ra_Yes"),onClose:s=>pe(this,null,function*(){if(s){this.setState({askForUpdate:!1});try{yield this.props.socket.updateLicenses(null,null)}catch(e){window.alert(c.I18n.t("ra_Cannot read licenses: %s",e));return}yield this._onClick(!0)}else this.setState({askForUpdate:!1,running:!1})})}):null}_onClick(s){return pe(this,null,function*(){const e=this.props.adapterName==="vis-2"?"vis":this.props.adapterName;this.setState({running:!0});let t,n;if(this.props.data.useLicenseManager){if(n=yield this.findInLicenseManager(e),t=n.find(r=>r.used),t&&(t=t.license.json),!t&&!s){this.setState({askForUpdate:!0});return}}else t=this.props.data.license;t?yield this.checkLicense(t,e):this.props.data.useLicenseManager?this.setState({_error:c.I18n.t("ra_Suitable license not found in license manager"),result:!1,running:!1,allLicenses:n}):this.setState({_error:c.I18n.t("ra_Please enter the license"),result:!1,running:!1})})}renderItem(){return i().createElement("div",{style:Se.fullWidth},i().createElement(l.Button,{variant:this.props.schema.variant||"outlined",color:this.props.schema.color||"primary",style:Se.fullWidth,disabled:!this.props.data.license&&!this.props.data.useLicenseManager||this.state.running,startIcon:i().createElement(u.Send,null),onClick:()=>this._onClick()},this.state.running?i().createElement(l.CircularProgress,{size:20,style:{marginRight:8}}):null,this.getText(this.props.schema.label||"ra_Check license",this.props.schema.noTranslation)),this.renderMessageDialog(),this.renderErrorDialog(),this.renderAskForUpdate())}}const ke=ue;class ze extends d{renderItem(s,e){const t=d.getValue(this.props.data,this.props.attr),n=Array.isArray(t);return i().createElement(l.FormControl,{style:{width:"100%"},variant:"standard"},i().createElement(l.FormControlLabel,{onClick:r=>{if(r.preventDefault(),r.stopPropagation(),!e){const o=this.onChange(this.props.attr,!t);o instanceof Promise&&o.catch(a=>console.error(`Cannot set value: ${a}`))}},control:i().createElement(l.Checkbox,{indeterminate:n,checked:!!t,onChange:r=>{let o;n?o=this.onChange(this.props.attr,!0):o=this.onChange(this.props.attr,r.target.checked),o instanceof Promise&&o.catch(a=>console.error(`Cannot set value: ${a}`))},disabled:e||this.props.schema.readOnly}),label:this.getText(this.props.schema.label)}),i().createElement(l.FormHelperText,{style:{color:"red"}},s?this.props.schema.validatorErrorText?c.I18n.t(this.props.schema.validatorErrorText):c.I18n.t("ra_Error"):null),this.props.schema.help?i().createElement(l.FormHelperText,null,this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)):null)}}const Ie=ze;var ut=G(3479),ct=G.n(ut),Dt=G(8625),_e=G(4603);const Bt={standard:l.Input,filled:Dt.A,outlined:l.OutlinedInput},Re=x=>{const s=x.palette.mode==="light",e=s?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return{root:{},inputRoot:{display:"inline-flex",flexWrap:"wrap",flex:1,marginTop:0,minWidth:70,"&.mui-variant-outlined,&.mui-variant-filled":{boxSizing:"border-box"},"&.mui-variant-outlined":{paddingTop:"14px"},"&.mui-variant-filled":{paddingTop:"28px"}},input:{display:"inline-block",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",appearance:"none",WebkitTapHighlightColor:"rgba(0,0,0,0)",float:"left",flex:1},chipContainer:{display:"flex",flexFlow:"row wrap",alignItems:"center",cursor:"text",marginBottom:"-2px",minHeight:40},outlined:{"& input":{height:16,paddingTop:"4px",paddingBottom:"12px",marginTop:"4px",marginBottom:"4px"}},standard:{marginTop:"18px"},filled:{"& input":{height:22,marginBottom:"4px",marginTop:"4px",paddingTop:0},"$marginDense & input":{height:26}},labeled:{},label:{top:4,"&$outlined&:not($labelShrink)":{top:2,"$marginDense &":{top:5}},"&$filled&:not($labelShrink)":{top:15,"$marginDense &":{top:20}}},labelShrink:{top:0},helperText:{marginBottom:-20},focused:{},disabled:{},underline:{"&:after":{borderBottom:`2px solid ${x.palette.primary[s?"dark":"light"]}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:x.transitions.create("transform",{duration:x.transitions.duration.shorter,easing:x.transitions.easing.easeOut}),pointerEvents:"none"},"&$focused:after":{transform:"scaleX(1)"},"&$error:after":{borderBottomColor:x.palette.error.main,transform:"scaleX(1)"},"&:before":{borderBottom:`1px solid ${e}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:x.transitions.create("border-bottom-color",{duration:x.transitions.duration.shorter}),pointerEvents:"none"},"&:hover:not($disabled):not($focused):not($error):before":{borderBottom:`2px solid ${x.palette.text.primary}`,"@media (hover: none)":{borderBottom:`1px solid ${e}`}},"&$disabled:before":{borderBottomStyle:"dotted"}},error:{"&:after":{backgroundColor:x.palette.error.main,transform:"scaleX(1)"}},chip:{margin:"0 8px 8px 0",float:"left"},marginDense:{}}},Ue={BACKSPACE:8,DELETE:46,LEFT_ARROW:37,RIGHT_ARROW:39},xt=({value:x,isFocused:s,isDisabled:e,isReadOnly:t,handleClick:n,handleDelete:r,style:o},a)=>i().createElement(l.Chip,{key:a,style:$e(Y({},o),{pointerEvents:e||t?"none":void 0,backgroundColor:s?_e.A[300]:void 0}),onClick:n,onDelete:r,label:x});class Qe extends i().Component{constructor(e){super(e);X(this,"labelRef");X(this,"labelNode",null);X(this,"input");X(this,"newChipKeyCodes");X(this,"newChipKeys");X(this,"actualInput",null);X(this,"inputBlurTimeout",null);X(this,"_keyPressed");X(this,"_preventChipCreation");X(this,"styles",{});X(this,"styleTheme",null);X(this,"focus",()=>{var e;(e=this.actualInput)==null||e.focus(),this.state.focusedChip&&this.setState({focusedChip:null})});X(this,"handleInputBlur",e=>{this.props.onBlur&&this.props.onBlur(e),this.setState({isFocused:!1}),this.state.focusedChip&&this.setState({focusedChip:null});const t=e.target.value;let n;switch(this.props.blurBehavior||"clear"){case"add-or-clear":n={clearInputOnFail:!0};case"add":if(this.props.delayBeforeAdd){const r=(this.props.value||this.state.chips).length;this.inputBlurTimeout=setTimeout(()=>{const o=(this.props.value||this.state.chips).length;r===o?this.handleAddChip(t,n):this.clearInput()},150)}else this.handleAddChip(t,n);break;case"clear":this.clearInput();break;default:break}});X(this,"handleInputFocus",e=>{this.setState({isFocused:!0}),this.props.onFocus&&this.props.onFocus(e)});X(this,"handleKeyDown",e=>{const{focusedChip:t}=this.state;if(this._keyPressed=!1,this._preventChipCreation=!1,this.props.onKeyDown&&(this.props.onKeyDown(e),e.isDefaultPrevented()))return;const n=this.props.value||this.state.chips;if(this.newChipKeyCodes.includes(e.keyCode)||this.newChipKeys.includes(e.key)){this.handleAddChip(e.target.value)!==!1&&e.preventDefault();return}switch(e.keyCode){case Ue.BACKSPACE:e.target.value===""&&(t?(this.handleDeleteChip(n[t],t),t&&this.setState({focusedChip:t-1})):this.setState({focusedChip:n.length-1}));break;case Ue.DELETE:e.target.value===""&&t&&(this.handleDeleteChip(n[t],t),t<=n.length-1&&this.setState({focusedChip:t}));break;case Ue.LEFT_ARROW:t===null&&e.target.value===""&&n.length?this.setState({focusedChip:n.length-1}):t!==null&&t>0&&this.setState({focusedChip:t-1});break;case Ue.RIGHT_ARROW:t!==null&&t<n.length-1?this.setState({focusedChip:t+1}):this.setState({focusedChip:null});break;default:this.setState({focusedChip:null});break}});X(this,"handleKeyUp",e=>{!this._preventChipCreation&&(this.newChipKeyCodes.includes(e.keyCode)||this.newChipKeys.includes(e.key))&&this._keyPressed?this.clearInput():this.updateInput(e.target.value),this.props.onKeyUp&&this.props.onKeyUp(e)});X(this,"handleUpdateInput",e=>{(this.props.inputValue===null||this.props.inputValue===void 0)&&this.updateInput(e.target.value),this.props.onUpdateInput&&this.props.onUpdateInput(e)});X(this,"setActualInputRef",e=>{this.actualInput=e,this.props.inputRef&&this.props.inputRef(e)});this.state={chips:e.defaultValue||[],focusedChip:null,inputValue:"",isFocused:!1,chipsUpdated:!1,prevPropsValue:[],variant:this.props.variant||"standard"},this.newChipKeyCodes=e.newChipKeyCodes||[13],this.newChipKeys=e.newChipKeys||["Enter"],this.labelRef=i().createRef(),this.input=i().createRef()}componentDidMount(){this.state.variant==="outlined"&&(this.labelNode=ct().findDOMNode(this.labelRef.current),this.forceUpdate())}componentWillUnmount(){this.inputBlurTimeout&&clearTimeout(this.inputBlurTimeout)}static getDerivedStateFromProps(e,t){let n=null;return e.value&&e.value.length!==t.prevPropsValue.length&&(n={prevPropsValue:e.value},e.clearInputValueOnChange&&(n.inputValue="")),e.clearInputValueOnChange&&e.value&&e.value.length!==t.prevPropsValue.length&&(n={prevPropsValue:e.value,inputValue:""}),e.disabled&&(n=$e(Y({},n),{focusedChip:null})),!t.chipsUpdated&&e.defaultValue&&(n=$e(Y({},n),{chips:e.defaultValue})),n}handleAddChip(e,t){if(this.props.onBeforeAdd&&!this.props.onBeforeAdd(e))return this._preventChipCreation=!0,t&&t.clearInputOnFail&&this.clearInput(),!1;this.clearInput();const n=this.props.value||this.state.chips;return e.trim().length?((this.props.allowDuplicates||!n.includes(e))&&(this.props.value&&this.props.onAdd?this.props.onAdd(e):this.updateChips([...this.state.chips,e])),!0):!1}handleDeleteChip(e,t){if(this.props.value)this.props.onDelete&&this.props.onDelete(e,t);else{const n=this.state.chips.slice();if(n.splice(t,1)){let o=this.state.focusedChip;this.state.focusedChip===t?o=null:this.state.focusedChip>t&&(o=this.state.focusedChip-1),this.updateChips(n,{focusedChip:o})}}}updateChips(e,t={}){this.setState(Y({chips:e,chipsUpdated:!0},t)),this.props.onChange&&this.props.onChange(e)}clearInput(){this.updateInput("")}updateInput(e){this.setState({inputValue:e})}render(){const{alwaysShowPlaceholder:e,chipRenderer:t=xt,className:n,disabled:r,disableUnderline:o,error:a,FormHelperTextProps:h,fullWidth:I,fullWidthInput:O,helperText:L,id:q,InputProps:he={},InputLabelProps:Ee={},inputValue:se,label:ye,placeholder:fe,readOnly:Xe,required:Rt,rootRef:Ht,value:fn,margin:kn}=this.props,nt=this.state.variant;this.styleTheme!==this.props.theme.palette.mode&&(this.styleTheme=this.props.theme.palette.mode,this.styles=te.getStyle(this.props.theme,Re));let kt=fn||this.state.chips||[];Array.isArray(kt)||(kt=(kt||"").toString().split(/[,\s]+/).map(Gt=>Gt.trim()));const gn=se!=null?se:this.state.inputValue,Bn=(this.props.value||gn).length||gn.length,zt=typeof Ee.shrink=="boolean"?Ee.shrink:ye!==null&&(Bn||this.state.isFocused||kt.length),On=kt.map((Gt,qt)=>t({value:Gt,isDisabled:!!r,isReadOnly:Xe,isFocused:this.state.focusedChip===qt,handleClick:()=>this.setState({focusedChip:qt}),handleDelete:()=>this.handleDeleteChip(Gt,qt),style:this.styles.chip},qt.toString())),Kt={};nt==="outlined"&&(Kt.notched=!!zt,Kt.labelWidth=zt&&this.labelNode&&this.labelNode.offsetWidth||0),nt!=="standard"?Kt.startAdornment=On:he.disableUnderline=!0;const Hs=Bt[nt];return i().createElement(l.FormControl,{ref:Ht,fullWidth:I,className:n,sx:Y(Y({},this.styles.root),kn==="dense"?this.styles.marginDense:{}),error:a,required:kt.length>0?void 0:Rt,onClick:this.focus,disabled:r,variant:nt,component:"div",margin:kn},ye&&i().createElement(l.InputLabel,Y({htmlFor:q,sx:{"&.MuiInputLabel-root":this.styles.label,"&.MuiInputLabel-shrink":this.styles.labelShrink},shrink:!!zt,focused:this.state.isFocused,variant:nt,ref:this.labelRef,required:Rt,component:"label"},Ee),ye),i().createElement(l.Box,{component:"div",id:"input-chip-container",sx:Y(Y(Y(Y(Y(Y(Y({},this.styles[nt]),this.styles.chipContainer),this.state.isFocused?this.styles.focused:void 0),!o&&nt==="standard"?this.styles.underline:void 0),r?this.styles.disabled:void 0),ye?this.styles.labeled:void 0),a?this.styles.error:void 0)},nt==="standard"&&On,i().createElement(Hs,Y(Y({ref:this.input,className:`mui-variant-${this.styles[nt]} ${ye?"mui-chip-with-label":"mui-chip-no-label"}`,sx:{"&.MuiInputBase-input":Y(Y({},this.styles.input),this.styles[nt]),"&.MuiInputBase-root":Y({},this.styles.inputRoot)},id:q,value:gn,onChange:this.handleUpdateInput,onKeyDown:this.handleKeyDown,onKeyUp:this.handleKeyUp,onFocus:this.handleInputFocus,onBlur:this.handleInputBlur,inputRef:this.setActualInputRef,disabled:r,fullWidth:O,placeholder:!Bn&&(zt||ye===null||ye===void 0)||e?fe:null,readOnly:Xe},he),Kt))),L&&i().createElement(l.FormHelperText,$e(Y({},h),{className:h==null?void 0:h.className,style:this.styles.helperText}),L))}}const Je=Qe;class Oe extends d{componentDidMount(){super.componentDidMount();const{data:s,attr:e}=this.props,t=d.getValue(s,e);if(this.props.schema.delimiter&&typeof t=="string"){const n=t.split(this.props.schema.delimiter).map(r=>r.trim()).filter(r=>r);this.setState({value:n})}else this.setState({value:t||[]})}renderItem(s,e){const{attr:t,schema:n}=this.props,{value:r}=this.state;return i().createElement(l.FormControl,{fullWidth:!0,variant:"standard"},i().createElement(Je,{value:r,disabled:!!e,label:this.getText(n.label),error:!!s,onAdd:o=>{const a=JSON.parse(JSON.stringify(r));a.push(o),this.setState({value:a},()=>{let h;this.props.schema.delimiter?h=this.onChange(t,a.join(`${this.props.schema.delimiter} `)):h=this.onChange(t,a),h instanceof Promise&&h.catch(I=>console.error(I))})},theme:this.props.theme,onDelete:(o,a)=>{const h=JSON.parse(JSON.stringify(r));h.splice(a,1),this.setState({value:h},()=>{let I;this.props.schema.delimiter?I=this.onChange(t,h.join(`${this.props.schema.delimiter} `)):I=this.onChange(t,h),I instanceof Promise&&I.catch(O=>console.error(O))})}}),this.props.schema.help?i().createElement(l.FormHelperText,null,this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)):null)}}const wt=Oe;var vt=G(5385);class Yt extends d{renderColorDialog(){return!!this.state.showColorDialog&&i().createElement(l.Dialog,{onClose:()=>this.setState({showColorDialog:!1}),open:this.state.showColorDialog},i().createElement(vt.xk,{color:this.state.colorDialogValue,onChange:s=>this.setState({colorDialogValue:s.hex},()=>this.onChange(this.props.attr,this.state.colorDialogValue))}))}renderItem(s,e){const t=d.getValue(this.props.data,this.props.attr);let n=c.Utils.isUseBright(t,null);return n===null&&(n=void 0),i().createElement(i().Fragment,null,this.renderColorDialog(),i().createElement(l.TextField,{variant:"standard",disabled:!!e,style:{minWidth:100,width:"calc(100% - 8px)"},label:this.getText(this.props.schema.label),value:t||"",onClick:()=>!this.props.schema.readOnly&&this.setState({showColorDialog:!0,colorDialogValue:t||""}),onChange:r=>{const o=r.target.value,a=this.onChange(this.props.attr,o);a instanceof Promise&&a.catch(h=>console.error(`Cannot set value: ${h}`))},slotProps:{htmlInput:{style:{backgroundColor:t,color:n?"#FFF":"#000"},readOnly:this.props.schema.readOnly||!1},input:{endAdornment:!this.props.schema.readOnly&&t&&!this.props.schema.noClearButton?i().createElement(l.IconButton,{size:"small",onClick:r=>{r.stopPropagation();const o=this.onChange(this.props.attr,"");o instanceof Promise&&o.catch(a=>console.error(`Cannot set value: ${a}`))}},i().createElement(u.Close,null)):void 0},inputLabel:{shrink:!0}}}))}}const Ot=Yt,me={width:{width:"calc(100% - 85px)"},width50:{width:120,marginRight:5}};class de extends d{componentDidMount(){super.componentDidMount();const s=d.getValue(this.props.data,this.props.attr);this.setState({value:s});const e={};this.props.schema.useSystemName&&(e.useSystem=!!d.getValue(this.props.data,this.props.schema.useSystemName)),this.props.schema.longitudeName&&this.props.schema.latitudeName?(e.longitude=d.getValue(this.props.data,this.props.schema.longitudeName),e.latitude=d.getValue(this.props.data,this.props.schema.latitudeName),!e.longitude&&!e.latitude&&this.props.schema.autoInit&&setTimeout(()=>this.getCoordinates(),300)):!d.getValue(this.props.data,this.props.attr)&&this.props.schema.autoInit&&setTimeout(()=>this.getCoordinates(),300),Object.keys(e).length&&setTimeout(()=>this.setState(e),50)}getSystemCoordinates(){return pe(this,null,function*(){const s=yield this.props.socket.getCompactSystemConfig();if(s!=null&&s.common&&(s.common.longitude||s.common.latitude))if(window.alert(c.I18n.t("ra_Used system settings")),this.props.schema.longitudeName&&this.props.schema.latitudeName)this.setState({longitude:s.common.longitude,latitude:s.common.latitude},()=>pe(this,null,function*(){yield this.onChange(this.props.schema.longitudeName,s.common.longitude),yield this.onChange(this.props.schema.latitudeName,s.common.latitude)}));else{const e=s.common.latitude+(this.props.schema.divider||",")+s.common.longitude;this.setState({value:e},()=>{const t=this.onChange(this.props.attr,e);t instanceof Promise&&t.catch(n=>console.error(`Cannot set value: ${n}`))})}else window.alert(c.I18n.t("ra_Cannot determine position: System settings are empty and GPS detection is disabled in browser"))})}getCoordinates(){navigator.geolocation?navigator.geolocation.getCurrentPosition(s=>pe(this,null,function*(){if(s!=null&&s.coords)if(this.props.schema.longitudeName&&this.props.schema.latitudeName)this.setState({longitude:s.coords.longitude,latitude:s.coords.latitude},()=>pe(this,null,function*(){yield this.onChange(this.props.schema.longitudeName,s.coords.longitude||""),yield this.onChange(this.props.schema.latitudeName,s.coords.latitude||"")}));else{const e=s.coords.latitude+(this.props.schema.divider||",")+s.coords.longitude;this.setState({value:e},()=>{const t=this.onChange(this.props.attr,e);t instanceof Promise&&t.catch(n=>console.error(`Cannot set value: ${n}`))})}else yield this.getSystemCoordinates()}),s=>pe(this,null,function*(){console.error(`Cannot determine coordinates from browser: ${s.message}`),yield this.getSystemCoordinates()})):this.getSystemCoordinates().catch(s=>{console.error(`Cannot determine coordinates: ${s}`)})}renderItem(s,e){var t,n;return i().createElement(i().Fragment,null,this.props.schema.useSystemName?i().createElement(l.FormControlLabel,{control:i().createElement(l.Checkbox,{checked:!!this.state.useSystem,onChange:r=>{const o=r.target.checked;o&&this.getSystemCoordinates().catch(a=>console.error(`Cannot determine coordinates: ${a}`)),this.setState({useSystem:o},()=>this.onChange(this.props.schema.useSystemName,o))}}),label:c.I18n.t("ra_Use system settings for position")}):null,this.props.schema.longitudeName&&this.props.schema.latitudeName?i().createElement(l.TextField,{variant:"standard",style:me.width50,value:(t=this.state.longitude)!=null?t:"",error:!!s,disabled:this.state.useSystem||!!e,onChange:r=>{const o=r.target.value;this.setState({longitude:o},()=>{const a=this.onChange(this.props.schema.longitudeName,(o||"").trim());a instanceof Promise&&a.catch(h=>console.error(`Cannot set value: ${h}`))})},label:c.I18n.t("ra_Longitude")}):null,this.props.schema.longitudeName&&this.props.schema.latitudeName?i().createElement(l.TextField,{variant:"standard",style:me.width50,value:(n=this.state.latitude)!=null?n:"",error:!!s,disabled:this.state.useSystem||!!e,onChange:r=>{const o=r.target.value;this.setState({latitude:o},()=>this.onChange(this.props.schema.latitudeName,(o||"").trim()))},label:c.I18n.t("ra_Latitude")}):null,!this.props.schema.longitudeName||!this.props.schema.latitudeName?i().createElement(l.TextField,{variant:"standard",style:me.width,value:this.state.value===null||this.state.value===void 0?"":this.state.value,error:!!s,disabled:!!e,slotProps:{htmlInput:{maxLength:this.props.schema.maxLength||this.props.schema.max||void 0,readOnly:this.state.useSystem}},onChange:r=>{const o=r.target.value;this.setState({value:o},()=>this.onChange(this.props.attr,(o||"").trim()))},placeholder:this.getText(this.props.schema.placeholder),label:this.getText(this.props.schema.label),helperText:this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)}):null,this.state.useSystem?null:i().createElement(l.Fab,{size:"small",onClick:()=>this.getCoordinates(),title:c.I18n.t("ra_Take browser position"),style:{marginRight:4}},i().createElement(u.LocationOn,null)),this.state.useSystem?null:i().createElement(l.Fab,{size:"small",onClick:()=>this.getSystemCoordinates(),title:c.I18n.t("ra_Take position from system settings")},i().createElement(u.GpsFixed,null)))}}const Ct=de,Ze=(x,s,e)=>new Promise((t,n)=>{if(window[x])t(window[x]);else{const r=document.querySelector(`script[data-webpack="${x}"]`),o=()=>pe(this,null,function*(){if(window[x])window[x].__initialized||(yield window[x].init(G.S[s]),window[x].__initialized=!0);else{console.error(`Cannot load ${x}`),n(new Error(`Cannot load ${x}`));return}t(window[x])});if(r)r.onload=o,r.onerror=n;else if(e){const a=document,h=a.createElement("script");h.type="text/javascript",h.setAttribute("data-webpack",`${x}`),h.async=!0,h.onerror=n,h.onload=o,h.src=e,a.getElementsByTagName("head")[0].appendChild(h)}else n(new Error(`Cannot Find Remote ${x} to inject`))}});function ve(x,s,e,t){return()=>pe(this,null,function*(){return(yield(yield Ze(x,s,t)).get(e))()})}const Pt=class Pt extends d{constructor(s){super(s),Object.assign(this.state,{Component:null,error:""})}componentDidMount(){return pe(this,null,function*(){if(!this.props.schema.url){console.error("URL is empty. Cannot load custom component!"),this.setState({error:"URL is empty. Cannot load custom component!"});return}let s;this.props.schema.url.startsWith("./")?s=`${window.location.protocol}//${window.location.host}${this.props.schema.url.replace(/^\./,"")}`:s=`${window.location.protocol}//${window.location.host}/adapter/${this.props.adapterName}/${this.props.schema.url}`;const[e,t,...n]=this.props.schema.name.split("/"),r=n.join("/");if(!s){console.error('Cannot find URL for custom component! Please define "url" as "custom/customComponents.js" in the schema');return}if(!e||!t||!r){console.error('Invalid format of "name"! Please define "name" as "ConfigCustomBackItUpSet/Components/AdapterExist" in the schema');return}let o=Pt.runningLoads[`${s}!${t}`];if(!(o instanceof Promise)){let a;if(this.props.schema.i18n===!0){const h=s.lastIndexOf("/");let I;h!==-1?I=s.substring(0,h):I=s;const O=c.I18n.getLanguage(),L=`${I}/i18n/${O}.json`;a=fetch(L).then(q=>q.json()).then(q=>c.I18n.extendTranslations(q,O)).catch(q=>{if(O!=="en"){fetch(`${I}/i18n/en.json`).then(he=>he.json()).then(he=>c.I18n.extendTranslations(he,O)).catch(he=>console.log(`Cannot load i18n "${L}": ${he}`));return}console.log(`Cannot load i18n "${L}": ${q}`)})}else if(this.props.schema.i18n&&typeof this.props.schema.i18n=="object")try{c.I18n.extendTranslations(this.props.schema.i18n)}catch(h){console.error(`Cannot import i18n: ${h}`)}try{console.log(e,t,r),o=ve(e,"default",`./${t}`,s)(),a instanceof Promise&&(o=Promise.all([o,a]).then(h=>h[0])),Pt.runningLoads[`${s}!${t}`]=o}catch(h){this.setState({error:`Cannot import from ${this.props.schema.url}: ${h}`})}}try{const a=(yield o).default;if(a!=null&&a[r])this.setState({Component:a[r]});else{const h=Object.keys(a||{});console.error("URL is empty. Cannot load custom component!"),this.setState({error:`Component ${this.props.schema.name} not found in ${this.props.schema.url}. Found: ${h.join(", ")}`})}}catch(a){this.setState({error:`Cannot import from ${this.props.schema.url}: ${a}`})}})}render(){const s=this.state.Component;if(!s){const e=this.props.schema||{},t=i().createElement(l.Grid2,{size:{xs:e.xs||void 0,sm:e.sm||void 0,md:e.md||void 0,lg:e.lg||void 0,xl:e.xl||void 0},style:Y(Y({marginBottom:0,textAlign:"left"},e.style),this.props.themeType==="dark"?e.darkStyle:{})},this.state.error?i().createElement("div",null,this.state.error):i().createElement(l.LinearProgress,null));return e.newLine?i().createElement(i().Fragment,null,i().createElement("div",{style:{flexBasis:"100%",height:0}}),t):t}return i().createElement(s,Y({},this.props))}};X(Pt,"runningLoads",{});let Ft=Pt;var Ke=G(8497);class U extends d{componentDidMount(){super.componentDidMount();const s=d.getValue(this.props.data,this.props.attr);this.setState({value:s})}renderItem(s,e){return i().createElement(Ke.DatePicker,{sx:t=>({width:"100%",borderBottom:`1px solid ${t.palette.text.primary}`,"& fieldset":{display:"none"},"& input":{padding:`${t.spacing(1.5)} 0 4px 0`},"& .MuiInputAdornment-root":{marginLeft:0,marginTop:1},"& label":{transform:"translate(0px, -9px) scale(0.75)"}}),format:this.props.systemConfig.dateFormat.toLowerCase().replace("mm","MM"),disabled:!!e,value:this.state.value,onChange:t=>{this.setState({value:t},()=>this.onChange(this.props.attr,this.state.value))},label:this.getText(this.props.schema.label)})}}class Mt extends d{renderItem(){if(!this.props.schema)return null;if(this.props.DeviceManager){const e=this.props.DeviceManager;return i().createElement(e,{uploadImagesToInstance:`${this.props.adapterName}.${this.props.instance}`,title:this.getText(this.props.schema.label),socket:this.props.socket,selectedInstance:`${this.props.adapterName}.${this.props.instance}`,themeName:this.props.themeName,themeType:this.props.themeType,isFloatComma:this.props.isFloatComma,dateFormat:this.props.dateFormat})}return i().createElement("div",null,"DeviceManager not found")}}const xe=Mt;var it=G(3683),Vt=G.n(it),Xt=G(6215);const We={fullWidth:{width:"100%"},fullWidthOneButton:{width:"calc(100% - 42px)"},fullWidthTwoButtons:{width:"calc(100% - 84px)"},fullWidthThreeButtons:{width:"calc(100% - 126x)"},dropZone:{width:"100%",height:"100%",position:"absolute"},dropZoneEmpty:{},image:{objectFit:"contain",margin:"auto",display:"flex",width:"100%",height:"100%"},uploadDiv:{position:"relative",width:"100%"},uploadDivDragging:{opacity:1,background:"rgba(128,255,128,0.1)"},uploadCenterDiv:{margin:5,border:"3px dashed grey",borderRadius:5,width:"100%",height:"100%",position:"absolute",display:"flex"},uploadCenterIcon:{paddingTop:10,width:48,height:48},uploadCenterText:{fontSize:16},uploadCenterTextAndIcon:{textAlign:"center",position:"absolute",top:0,bottom:0,left:0,right:0,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},disabledOpacity:{opacity:.3,cursor:"default"},error:{border:"2px solid red"},deleteButton:{},selectedImage:{height:40,width:40,display:"inline-block",marginRight:8}},Zt=["jpg","jpeg","svg","png","webp","gif","apng","avif","webp"],$t=["mp3","ogg","wav","aac"],At=["avi","mp4","mov"],we=["txt","log","html","htm"],rt=["json","js","ts"];class St extends d{constructor(e){super(e);X(this,"dropzoneRef");X(this,"imagePrefix");X(this,"objectID");X(this,"path");this.dropzoneRef=i().createRef(),this.imagePrefix=this.props.imagePrefix===void 0?"./files":this.props.imagePrefix}componentDidMount(){super.componentDidMount(),this.objectID=(this.props.schema.objectID||"0_userdata.0").replace("%INSTANCE%",(this.props.instance||0).toString()),this.path=this.props.schema.upload,this.path&&(this.path==="/"?this.path="":this.path.endsWith("/")||(this.path=`${this.path}/`)),this.updateFiles().then(()=>{const e=d.getValue(this.props.data,this.props.attr);this.setState({value:e})})}updateFiles(){return this.readFiles(this.props.schema.pattern).then(e=>this.setState({files:e}))}readFolder(e,t,n){return pe(this,null,function*(){try{const r=yield this.props.socket.readDir(this.objectID,e.replace(/^\//,"")||null);for(let o=0;o<r.length;o++){const a=r[o];if(a.isDir)yield this.readFolder(`${e+a.file}/`,t,n);else{let h=!1;n==="*.*"&&a.file.includes(".")||!n||n==="*"||n===".*"&&a.file.startsWith(".")?h=!0:h=new RegExp(`^${n.replace(/\./g,"\\.").replace(/\*/g,".*")}$`).test(a.file),h&&t.push({name:e+a.file,size:a.stats?c.Utils.formatBytes(a.stats.size):"--"})}}}catch(r){console.error(`Cannot read "${e}": ${r}`)}return t})}readFiles(e){return pe(this,null,function*(){const t=[];e=e||this.props.schema.pattern,e||(e="**/*.*");let n;const r=e.lastIndexOf("/");if(r===-1?n=e:n=e.substring(r+1),e.startsWith("**"))yield this.readFolder("/",t,n);else{const o=e.lastIndexOf("/");if(o===-1)yield this.readFolder("/",t,n);else{const a=e.substring(0,o+1);yield this.readFolder(a,t,n)}}return t})}onDrop(e){const t=e[0],n=new FileReader,r=this.props.schema.maxSize||2*1024*1024;n.onabort=()=>console.log("file reading was aborted"),n.onerror=()=>console.log("file reading has failed"),n.onload=()=>{let o=`image/${t.name.split(".").pop().toLowerCase()}`;if(o==="image/jpg"?o="image/jpeg":o.includes("svg")&&(o="image/svg+xml"),t.size>r){window.alert(c.I18n.t("File is too big. Max %sk allowed. Try use SVG.",Math.round(r/1024)));return}const a=`data:${o};base64,${btoa(new Uint8Array(n.result).reduce((h,I)=>h+String.fromCharCode(I),""))}`;this.props.socket.writeFile64(this.objectID,this.path+t.name,a).then(()=>this.updateFiles()).catch(h=>window.alert(`Cannot upload file: ${h}`))},n.readAsArrayBuffer(t)}renderDeleteDialog(){return this.state.deleteFile?i().createElement(c.DialogConfirm,{title:c.I18n.t("ra_Are you sure?"),text:c.I18n.t("ra_File will be deleted"),ok:c.I18n.t("ra_Delete"),cancel:c.I18n.t("ra_Cancel"),onClose:e=>{const t=this.state.deleteFile;this.setState({deleteFile:""},()=>{e&&this.props.socket.deleteFile(this.objectID,t).then(()=>this.updateFiles()).catch(n=>window.alert(`Cannot delete file: ${n}`))})}}):null}static base64ToArrayBuffer(e){const t=window.atob(e),n=t.length,r=new Uint8Array(n);for(let o=0;o<n;o++)r[o]=t.charCodeAt(o);return r.buffer}loadFile(){return this.props.socket.readFile(this.objectID,this.state.value,!0)}play(){this.loadFile().then(e=>{if(typeof AudioContext!="undefined"){const t=new AudioContext,n=St.base64ToArrayBuffer(e.file);t.decodeAudioData(n,r=>{const o=t.createBufferSource();o.buffer=r,o.connect(t.destination),o.start(0)},r=>window.alert(`Cannot play: ${r.message}`))}})}getFileIcon(e){return e!=null&&e.extension?Zt.includes(e.extension)?i().createElement("div",{style:$e(Y({},We.selectedImage),{backgroundImage:`url(${this.imagePrefix}/${this.objectID}/${e.value})`,backgroundSize:"contain",backgroundRepeat:"no-repeat"})}):$t.includes(e.extension)?i().createElement(u.MusicNote,null):we.includes(e.extension)?i().createElement(u.Article,null):At.includes(e.extension)?i().createElement(u.Videocam,null):rt.includes(e.extension)?i().createElement(u.Code,null):null:null}renderItem(e,t){if(!this.state.files)return null;const n=[];this.props.schema.withFolder||this.state.files.forEach(L=>{const q=L.name.lastIndexOf("/");if(q===-1)n.includes("/")||n.push("/");else{const he=L.name.substring(0,q+1);n.includes(he)||n.push(he)}});const r=this.state.files.map(L=>({value:L.name,label:!this.props.schema.withFolder&&n.length===1?`${L.name.substring(n[0].length)}`:`${L.name}${this.props.schema.noSize?"":`(${L.size})`}`,extension:L.name.toLowerCase().split(".").pop()}));this.props.schema.noNone||r.unshift({label:c.I18n.t("ra_none"),value:""});const o=r.find(L=>L.value===this.state.value);let a=0;this.props.schema.upload&&a++,this.props.schema.refresh&&a++;const h=this.state.value&&(this.state.value.endsWith(".mp3")||this.state.value.endsWith(".ogg")||this.state.value.endsWith(".wav"));h&&a++;const I=i().createElement("div",{style:We.fullWidth},i().createElement(l.FormControl,{variant:"standard",style:{width:`calc(100% - ${a*42}px)`}},this.props.schema.label?i().createElement(l.InputLabel,null,this.getText(this.props.schema.label)):null,i().createElement(l.Select,{variant:"standard",error:!!e,disabled:!!t,value:this.state.value||"_",renderValue:()=>i().createElement(i().Fragment,null,this.getFileIcon(o),i().createElement("span",null,(o==null?void 0:o.label)||"")),onChange:L=>{this.setState({value:L.target.value==="_"?"":L.target.value},()=>this.onChange(this.props.attr,this.state.value))}},r.map(L=>i().createElement(l.MenuItem,{key:L.value,value:L.value},i().createElement(l.ListItemIcon,null,this.getFileIcon(L)),i().createElement(l.ListItemText,null,L.label),this.props.schema.delete&&o.value?i().createElement(l.IconButton,{style:We.deleteButton,size:"small",onClick:()=>this.setState({deleteFile:o.value})},i().createElement(u.Delete,null)):null))),this.props.schema.help?i().createElement(l.FormHelperText,null,this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)):null),this.props.schema.refresh&&i().createElement(l.IconButton,{onClick:()=>this.updateFiles()},i().createElement(u.Refresh,null)),this.props.schema.upload&&i().createElement(l.IconButton,{onClick:()=>{var L;return(L=this.dropzoneRef.current)==null?void 0:L.open()}},i().createElement(u.UploadFile,null)),h&&i().createElement(l.IconButton,{style:{color:"#00FF00"},onClick:()=>this.play()},i().createElement(u.PlayArrow,null)));if(!this.props.schema.upload)return i().createElement(i().Fragment,null,I,this.renderDeleteDialog());let O={"*/*":[]};if(this.props.schema.fileTypes==="image"?O={"image/*":[".png",".jpg",".svg",".gif",".apng",".avif",".webp"]}:this.props.schema.fileTypes==="audio"?O={"audio/*":[".mp3",".ogg",".wav",".mp4"]}:this.props.schema.fileTypes==="text"&&(O={"text/plain":[".txt"]}),this.props.schema.pattern){const L=this.props.schema.pattern.split("/").pop().toLowerCase().replace(/.*\./,"");L==="png"||L==="jpg"||L==="svg"||L==="gif"||L==="apng"||L==="avif"||L==="webp"?O={"image/*":[".png",".jpg",".svg",".gif",".apng",".avif",".webp"]}:L==="mp3"||L==="ogg"||L==="wav"?O={"audio/*":[".mp3",".ogg",".wav",".mp4"]}:L==="ics"?O={"text/calendar":[".ics"]}:L==="txt"?O={"text/plain":[".txt"]}:L==="pem"?O={"text/plain":[".pem"]}:O={"*/*":[`.${L}`]}}return i().createElement(Vt(),{ref:this.dropzoneRef,multiple:!1,accept:O,noKeyboard:!0,noClick:!0,maxSize:this.props.schema.maxSize||2*1024*1024,onDragEnter:()=>{this.setState({uploadFile:"dragging"})},onDragLeave:()=>this.setState({uploadFile:!0}),onDrop:(L,q)=>{this.setState({uploadFile:!1}),L.length?this.onDrop(L):window.alert(q&&q[0]&&q[0].errors&&q[0].errors[0]&&q[0].errors[0].message||c.I18n.t("Cannot upload"))}},({getRootProps:L,getInputProps:q})=>i().createElement("div",Y({style:Y(Y(Y({},We.uploadDiv),this.state.uploadFile==="dragging"?We.uploadDivDragging:void 0),t?We.disabledOpacity:void 0)},L()),i().createElement("input",Y({},q())),this.state.uploadFile==="dragging"?i().createElement("div",{style:Y(Y({},We.uploadCenterDiv),this.state.uploadError?We.error:void 0)},i().createElement("div",{style:We.uploadCenterTextAndIcon},i().createElement(Xt.l1U,{style:We.uploadCenterIcon}),i().createElement("div",{style:We.uploadCenterText},this.state.uploadFile==="dragging"?c.I18n.t("ra_Drop file here"):c.I18n.t("ra_Place your files here or click here to open the browse dialog")))):null,I,this.renderDeleteDialog()))}}const Wt=St,yt={fullWidth:{width:"100%"},fullWidthOneButton:{width:"calc(100% - 69px)",marginRight:4},fullWidthIcon:{width:"calc(100% - 119px)",marginRight:4},selectedImage:{height:40,width:40,display:"inline-block",marginRight:8}},Tt=["jpg","jpeg","svg","png","webp","gif","apng","avif","webp"],Qt=["mp3","ogg","wav","aac"],en=["avi","mp4","mov"],tn=["txt","log","html","htm"],nn=["json","js","ts"];class w extends d{constructor(){super(...arguments);X(this,"imagePrefix","../..")}componentDidMount(){super.componentDidMount();const e=d.getValue(this.props.data,this.props.attr);this.imagePrefix=this.props.imagePrefix===void 0?"./files":this.props.imagePrefix,this.setState({value:e!=null?e:""})}static getDerivedStateFromProps(e,t){const n=d.getValue(e.data,e.attr);return n==null||n.toString().trim()!==(t.value||"").toString().trim()?{value:n!=null?n:""}:null}loadFile(){const e=this.state.value.indexOf("/");if(e!==-1){const t=this.state.value.substring(0,e),n=this.state.value.substring(e+1);return this.props.socket.readFile(t,n,!0)}return Promise.resolve(null)}play(){this.loadFile().then(e=>{if(typeof AudioContext!="undefined"&&(e!=null&&e.file)){const t=new AudioContext,n=Wt.base64ToArrayBuffer(e.file);t.decodeAudioData(n,r=>{const o=t.createBufferSource();o.buffer=r,o.connect(t.destination),o.start(0)},r=>window.alert(`Cannot play: ${r.message}`))}})}getIcon(){const e=this.state.value.split(".").pop().toLowerCase();return Tt.includes(e)?i().createElement("div",{style:$e(Y({},yt.selectedImage),{backgroundImage:`url(${this.imagePrefix}/${this.state.value})`,backgroundSize:"contain",backgroundRepeat:"no-repeat"})}):Qt.includes(e)?i().createElement(l.IconButton,{style:{color:"#00FF00"},onClick:()=>this.play()},i().createElement(u.PlayArrow,null)):tn.includes(e)?i().createElement(u.Article,null):en.includes(e)?i().createElement(u.Videocam,null):nn.includes(e)?i().createElement(u.Code,null):null}renderFileBrowser(){return this.state.showFileBrowser?i().createElement(c.DialogSelectFile,{imagePrefix:this.props.imagePrefix,socket:this.props.socket,selected:this.state.value,onClose:()=>this.setState({showFileBrowser:!1}),onOk:e=>{const t=Array.isArray(e)?e[0]:e;this.setState({value:t},()=>this.onChange(this.props.attr,this.props.schema.trim===!1?t:(t||"").trim()))},selectOnlyFolders:this.props.schema.selectOnlyFolders,allowUpload:this.props.schema.allowUpload,allowDownload:this.props.schema.allowDownload,allowCreateFolder:this.props.schema.allowCreateFolder,allowView:this.props.schema.allowView,showToolbar:this.props.schema.showToolbar,limitPath:this.props.schema.limitPath,theme:this.props.theme}):null}renderItem(e,t){const n=this.getIcon();return i().createElement("div",{style:yt.fullWidth},n,i().createElement(l.TextField,{variant:"standard",style:n?yt.fullWidthIcon:yt.fullWidthOneButton,value:this.state.value===null||this.state.value===void 0?"":this.state.value,error:!!e,disabled:!!t,slotProps:{htmlInput:{maxLength:this.props.schema.maxLength||this.props.schema.max||void 0,readOnly:!!this.props.schema.disableEdit}},onChange:r=>{const o=r.target.value;this.setState({value:o},()=>this.onChange(this.props.attr,this.props.schema.trim===!1?o:(o||"").trim()))},placeholder:this.getText(this.props.schema.placeholder),label:this.getText(this.props.schema.label),helperText:this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)}),i().createElement(l.Button,{variant:"outlined",onClick:()=>this.setState({showFileBrowser:!0})},"..."),this.renderFileBrowser())}}const $=w;class ie extends d{componentDidMount(){super.componentDidMount();const s=d.getValue(this.props.data,this.props.attr);this.props.socket.getEnums("functions").then(e=>{const t=Object.keys(e).map(n=>({value:this.props.schema.short?n.replace("enum.functions.",""):n,label:this.getText(e[n].common.name),obj:e[n]}));this.props.schema.allowDeactivate!==!1&&t.unshift({label:c.I18n.t(d.NONE_LABEL),value:d.NONE_VALUE}),this.setState({value:s,selectOptions:t})})}renderItem(s,e){if(!this.state.selectOptions)return null;const t=this.state.selectOptions.find(n=>n.value===this.state.value);return i().createElement(l.FormControl,{variant:"standard",fullWidth:!0},this.props.schema.label?i().createElement(l.InputLabel,null,this.getText(this.props.schema.label)):null,i().createElement(l.Select,{variant:"standard",error:!!s,disabled:!!e,value:this.state.value||"_",renderValue:()=>t?t.obj?i().createElement(c.TextWithIcon,{value:t.obj,themeType:this.props.themeType,lang:c.I18n.getLanguage()}):t.label:"",onChange:n=>{this.setState({value:n.target.value==="_"?"":n.target.value},()=>this.onChange(this.props.attr,this.state.value))}},this.state.selectOptions.map(n=>i().createElement(l.MenuItem,{key:n.value,value:n.value,style:n.value===d.DIFFERENT_VALUE?{opacity:.5}:{}},n.obj?i().createElement(c.TextWithIcon,{value:n.obj,themeType:this.props.themeType,lang:c.I18n.getLanguage()}):n.label))),this.props.schema.help?i().createElement(l.FormHelperText,null,this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)):null)}}const ne=ie;class ae extends d{componentDidMount(){super.componentDidMount(),this.props.socket.getHostByIp(this.props.common.host).then(s=>{this.props.schema.listenOnAllPorts||(s=s.filter(e=>e.address!=="0.0.0.0"&&e.address!=="::")),this.props.schema.onlyIp4?s=s.filter(e=>e.family==="ipv4"):this.props.schema.onlyIp6&&(s=s.filter(e=>e.family==="ipv6")),this.props.schema.noInternal&&(s=s.filter(e=>!e.internal)),s.forEach(e=>{e.address==="0.0.0.0"?e.name=`[IPv4] 0.0.0.0 - ${c.I18n.t("ra_Listen on all IPs")}`:e.address==="::"&&(e.name=`[IPv6] :: - ${c.I18n.t("ra_Listen on all IPs")}`)}),this.setState({ips:s})}).catch(s=>console.error(s))}renderItem(s,e){var r,o;const t=d.getValue(this.props.data,this.props.attr),n=(r=this.state.ips)==null?void 0:r.find(a=>a.address===t);return i().createElement(l.FormControl,{fullWidth:!0,variant:"standard"},this.state.ips&&this.props.schema.label?i().createElement(l.InputLabel,null,this.getText(this.props.schema.label)):null,this.state.ips?i().createElement(l.Select,{variant:"standard",error:!!s,disabled:!!e,value:t,renderValue:a=>(n==null?void 0:n.name)||a,onChange:a=>this.onChange(this.props.attr,a.target.value)},(o=this.state.ips)==null?void 0:o.map((a,h)=>i().createElement(l.MenuItem,{key:h,value:a.address},a.name))):i().createElement(l.TextField,{fullWidth:!0,variant:"standard",error:!!s,disabled:!!e,value:t,onChange:a=>this.onChange(this.props.attr,a.target.value),label:this.getText(this.props.schema.label)}),this.props.schema.help?i().createElement(l.FormHelperText,null,this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)):null)}}const De=ae;class Ce extends d{constructor(){super(...arguments);X(this,"initialized",!1);X(this,"_context")}componentDidMount(){super.componentDidMount(),this.askInstance()}askInstance(){if(this.props.alive){let e=this.props.schema.data;if(e===void 0&&this.props.schema.jsonData){const t=this.getPattern(this.props.schema.jsonData);if(t)try{e=JSON.parse(t)}catch(n){console.error(`Cannot parse json data: ${JSON.stringify(e)}`)}}e===void 0&&(e=null),this.props.socket.sendTo(`${this.props.adapterName}.${this.props.instance}`,this.props.schema.command||"send",e).then(t=>this.setState({image:t||""}))}}getContext(){const e={};return Array.isArray(this.props.schema.alsoDependsOn)&&this.props.schema.alsoDependsOn.forEach(t=>e[t]=d.getValue(this.props.data,t)),JSON.stringify(e)}renderItem(){if(this.props.alive){const e=this.getContext();(e!==this._context||!this.initialized)&&(this._context=e,setTimeout(()=>this.askInstance(),this.initialized?300:50),this.initialized=!0)}return this.state.image===void 0?null:i().createElement("img",{alt:"dynamic content",src:this.state.image,style:{width:this.props.schema.width||"100%",height:this.props.schema.height}})}}const Me=Ce;class Be extends d{constructor(e){super(e);X(this,"index");this.index=Date.now()}componentDidMount(){if(super.componentDidMount(),this.props.schema.base64){const e=d.getValue(this.props.data,this.props.attr);this.setState({value:e})}else this.props.socket.fileExists(`${this.props.adapterName}.${this.props.instance}`,this.props.attr).then(e=>e&&this.loadImage())}_getUrl(e){e&&(this.index=Date.now());let t=`files/${this.props.adapterName}.${this.props.instance}/${this.props.attr}?t=${this.index}`;return window.location.port==="3000"&&(t=`${window.location.protocol}//${window.location.hostname}:8081/${t}`),t}loadImage(){fetch(this._getUrl()).then(e=>e.blob()).then(e=>{const t=new FileReader;t.onload=()=>{this.setState({value:t.result})},t.readAsDataURL(e)}).catch(e=>console.error(e))}renderItem(e,t){return i().createElement(l.FormControl,{fullWidth:!0,variant:"standard"},this.props.schema.label?i().createElement(l.InputLabel,{shrink:!0},this.getText(this.props.schema.label)):null,i().createElement(c.UploadImage,{error:!!e,disabled:t,accept:this.props.schema.accept,crop:this.props.schema.crop,maxSize:this.props.schema.maxSize||256*1024,icon:this.state.value||void 0,removeIconFunc:()=>this.setState({value:null},()=>{if(this.props.schema.base64){const n=this.onChange(this.props.attr,this.state.value);n instanceof Promise&&n.catch(r=>console.error(`Cannot set value: ${r}`))}else this.props.socket.deleteFile(`${this.props.adapterName}.${this.props.instance}`,this.props.attr).catch(n=>console.error(n))}),onChange:n=>this.setState({value:n},()=>{if(this.props.schema.base64){const r=this.onChange(this.props.attr,this.state.value);r instanceof Promise&&r.catch(o=>console.error(`Cannot set value: ${o}`))}else n.startsWith("data")&&(n=n.split(",")[1]);this.props.socket.writeFile64(`${this.props.adapterName}.${this.props.instance}`,this.props.attr,n).catch(r=>console.error(r))})}),this.props.schema.help?i().createElement(l.FormHelperText,null,this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)):null)}}const ot=Be,at={icon:{width:20,height:20,marginRight:4}};class je extends d{constructor(){super(...arguments);X(this,"onInstancesUpdate",(e,t)=>{if(!e.match(/^system\.adapter\.[-_a-z\d]+\.\d+$/))return;const n=this.props.schema.long?e:this.props.schema.short?e.split(".").pop():e.replace(/^system\.adapter\./,""),r=this.state.selectOptions.findIndex(o=>o.value===n);if(t){if(this.props.schema.adapter==="_dataSources"&&(!t.common||!t.common.getHistory))return;if(r===-1){const o=JSON.parse(JSON.stringify(this.state.selectOptions)),a=typeof t.common.name=="object"?t.common.name[c.I18n.getLanguage()]||t.common.name.en:t.common.name;o.push({value:this.props.schema.long?t._id:this.props.schema.short?t._id.split(".").pop():t._id.replace(/^system\.adapter\./,""),label:`${a} [${t._id.replace(/^system\.adapter\./,"")}]`,icon:`adapter/${a}/${t.common.icon}`}),o.sort((h,I)=>h.label>I.label?1:h.label<I.label?-1:0),this.setState({selectOptions:o})}}else if(r!==-1){const o=JSON.parse(JSON.stringify(this.state.selectOptions)),a={};this.state.value===o[r].value&&(a.value=d.NONE_VALUE),o.splice(r,1),a.selectOptions=o,this.setState(a)}})}componentDidMount(){super.componentDidMount();const e=d.getValue(this.props.data,this.props.attr);let t=this.props.schema.adapter;t==="_dataSources"&&(t=void 0),this.props.socket.getAdapterInstances(t,!0).then(n=>pe(this,null,function*(){this.props.schema.adapter==="_dataSources"?n=n.filter(o=>{var a;return(a=o==null?void 0:o.common)==null?void 0:a.getHistory}):this.props.schema.adapter?n=n.filter(o=>o==null?void 0:o._id.startsWith(`system.adapter.${this.props.schema.adapter}.`)):this.props.schema.adapters&&Array.isArray(this.props.schema.adapters)&&(n=n.filter(o=>{var a;return this.props.schema.adapters.includes((a=o==null?void 0:o.common)==null?void 0:a.name)})),this.props.schema.onlyEnabled&&(n=n.filter(o=>{var a;return(a=o==null?void 0:o.common)==null?void 0:a.enabled}));const r=n.map(o=>({value:this.props.schema.long?o._id:this.props.schema.short?o._id.split(".").pop():o._id.replace(/^system\.adapter\./,""),label:`${o.common.name} [${o._id.replace(/^system\.adapter\./,"")}]`,icon:`adapter/${o.common.name}/${o.common.icon}`}));r.sort((o,a)=>o.value>a.value?1:o.value<a.value?-1:0),this.props.schema.allowDeactivate!==!1&&r.unshift({label:c.I18n.t(d.NONE_LABEL),value:d.NONE_VALUE}),this.props.schema.all&&r.unshift({label:c.I18n.t("sch_all"),value:"*"}),this.setState({value:e||"",selectOptions:r}),yield this.props.socket.subscribeObject(`system.adapter.${t?`${t}.`:""}*`,this.onInstancesUpdate)})).catch(n=>console.error(`Cannot get instances: ${n}`))}componentWillUnmount(){this.props.socket.unsubscribeObject("system.adapter.*",this.onInstancesUpdate).then(()=>{}),super.componentWillUnmount()}renderItem(e,t){var r;if(!this.state.selectOptions)return null;const n=(r=this.state.selectOptions)==null?void 0:r.find(o=>o.value===this.state.value);return i().createElement(l.FormControl,{fullWidth:!0,key:this.props.attr,variant:"standard"},this.props.schema.label?i().createElement(l.InputLabel,{shrink:!0},this.getText(this.props.schema.label)):null,i().createElement(l.Select,{variant:"standard",error:!!e,displayEmpty:!0,disabled:!!t,value:this.state.value,renderValue:()=>i().createElement("span",{style:{display:"flex"}},n!=null&&n.icon?i().createElement("img",{src:`./${n.icon}`,alt:n.value,style:at.icon}):null,this.getText(n==null?void 0:n.label,!0)),onChange:o=>this.setState({value:o.target.value},()=>this.onChange(this.props.attr,this.state.value))},this.state.selectOptions.map(o=>i().createElement(l.MenuItem,{key:o.value,value:o.value,style:o.value===d.NONE_VALUE?{opacity:.5}:{}},o.icon?i().createElement("img",{src:`./${o.icon}`,alt:o.value,style:at.icon}):null,this.getText(o.label,!0)))),this.props.schema.help?i().createElement(l.FormHelperText,null,this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)):null)}}const Ge=je,Ne={address:{fontSize:"smaller",opacity:.5,marginLeft:8}};class ht extends d{componentDidMount(){super.componentDidMount(),this.props.socket.getObject(`system.host.${this.props.common.host}`).then(s=>{var t,n;const e=[];if((n=(t=s==null?void 0:s.native)==null?void 0:t.hardware)!=null&&n.networkInterfaces){const r=s.native.hardware.networkInterfaces;Object.keys(r).forEach(o=>{if(this.props.schema.ignoreInternal&&!r[o].find(h=>!h.internal)||this.props.schema.ignoreLoopback&&r[o].find(h=>h.address==="127.0.0.1"||h.address==="::1"))return;let a=r[o].find(h=>h.family==="IPv4");a=a||r[o].find(h=>h.family==="IPv6"),e.push({value:o,address:a.address})})}this.setState({interfaces:e})}).catch(s=>window.alert(`Cannot read interfaces: ${s}`))}renderItem(s,e){var r,o,a;const t=d.getValue(this.props.data,this.props.attr),n=(r=this.state.interfaces)==null?void 0:r.find(h=>h.value===t);return i().createElement(l.FormControl,{fullWidth:!0,variant:"standard"},(o=this.state.interfaces)!=null&&o.length&&this.props.schema.label?i().createElement(l.InputLabel,null,this.getText(this.props.schema.label)):null,(a=this.state.interfaces)!=null&&a.length?i().createElement(l.Select,{variant:"standard",error:!!s,disabled:!!e,value:t,renderValue:h=>n?i().createElement("span",null,n.value,i().createElement("span",{style:Ne.address},n.address)):h,onChange:h=>this.onChange(this.props.attr,h.target.value)},this.state.interfaces.map((h,I)=>i().createElement(l.MenuItem,{key:I,value:h.value},i().createElement("span",null,h.value,i().createElement("span",{style:Ne.address},h.address))))):i().createElement(l.TextField,{fullWidth:!0,variant:"standard",error:!!s,disabled:!!e,value:t,onChange:h=>this.onChange(this.props.attr,h.target.value),label:this.getText(this.props.schema.label)}),this.props.schema.help?i().createElement(l.FormHelperText,null,this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)):null)}}const It=ht,pt={modalDialog:{minWidth:400,maxWidth:800},overflowHidden:{display:"flex",overflow:"hidden"},titleIcon:{marginRight:5},content:{fontSize:16},languageButton:{position:"absolute",right:8,top:8},languageButtonActive:{color:"primary.main"}},sn=({toggleTranslation:x,noTranslation:s,title:e,fullWidth:t,help:n,maxWidth:r,progress:o,icon:a,applyDisabled:h,applyButton:I,onClose:O,children:L,titleButtonApply:q,titleButtonClose:he,onApply:Ee,textInput:se,defaultValue:ye,overflowHidden:fe})=>{const[Xe,Rt]=(0,A.useState)(ye);(0,A.useEffect)(()=>{Rt(ye)},[ye]);let Ht=null;return a&&(Ht=a),i().createElement(l.Dialog,{open:!0,maxWidth:r||"md",fullWidth:!!t,disableEscapeKeyDown:!1,onClose:O,sx:{"& .MuiPaper-root":pt.modalDialog}},e&&i().createElement(l.DialogTitle,null,a?i().createElement(Ht,{style:pt.titleIcon}):null,e,c.I18n.getLanguage()!=="en"&&x?i().createElement(l.IconButton,{size:"large",style:Y(Y({},pt.languageButton),s?pt.languageButtonActive:{}),onClick:()=>x(),title:c.I18n.t("Disable/Enable translation")},i().createElement(u.Language,null)):null),i().createElement(l.DialogContent,{sx:Y(Y({},fe?pt.overflowHidden:{}),pt.content),style:{paddingTop:8}},se&&i().createElement(l.TextField,{autoComplete:"off",fullWidth:!0,autoFocus:!0,variant:"outlined",size:"medium",multiline:!0,value:Xe,onChange:fn=>Rt(fn.target.value)}),L,n?i().createElement("div",null,n):null),i().createElement(l.DialogActions,null,I!==!1&&i().createElement(l.Button,{startIcon:i().createElement(u.Check,null),disabled:o||h&&ye===Xe,onClick:()=>Ee&&Ee(se?Xe:""),variant:"contained",color:"primary"},c.I18n.t(q||"Ok")),i().createElement(l.Button,{color:"grey",onClick:()=>O&&O(),disabled:o,variant:"contained",startIcon:i().createElement(u.Close,null)},c.I18n.t(he||"Cancel"))))};var be=G(8093),Le=G.n(be),ge=G(7726),Pe=G(1197),qe=G(9285),Ve=G(4210),dt=G(2292);const Ye={jsonError:{border:"1px solid red",minHeight:200},jsonNoError:{border:"1px solid #00000000",minHeight:200}};function et(x){return i().createElement(Le(),{style:x.error===!0?Ye.jsonError:x.error===!1?Ye.jsonNoError:void 0,mode:x.mode||"json",width:"100%",height:"100%",showPrintMargin:x.editValueMode,showGutter:x.editValueMode,highlightActiveLine:x.editValueMode,defaultValue:x.defaultValue,theme:x.themeType==="dark"?"clouds_midnight":"chrome",value:x.value,readOnly:!x.onChange,onChange:s=>x.onChange(s),name:x.name||"UNIQUE_ID_OF_DIV1",fontSize:x.fontSize||14,setOptions:{enableBasicAutocompletion:!0,enableLiveAutocompletion:!0,enableSnippets:!0,showLineNumbers:x.editValueMode,tabSize:x.editValueMode?2:void 0},editorProps:{$blockScrolling:!0}})}const lt=et,mt={fullWidth:{width:"100%"},flex:{display:"flex"},button:{height:48,minWidth:48},wrapper:{width:"calc(100vw - 40px)",height:"calc(100vh - 188px)"}};class rn extends d{componentDidMount(){super.componentDidMount();const{data:s,attr:e}=this.props,t=d.getValue(s,e)||{};this.setState({value:t,initialized:!0,jsonError:this.validateJson(t)})}validateJson(s){let e=!1;if(this.props.schema.validateJson!==!1&&(s||!this.props.schema.allowEmpty))try{JSON.parse(s)}catch(t){console.log("Error in JSON",t),e=!0}return e}renderItem(){if(!this.state.initialized)return null;const{schema:s,data:e,attr:t}=this.props,{value:n,showSelectId:r}=this.state;return i().createElement(l.FormControl,{fullWidth:!0,variant:"standard"},i().createElement("div",{style:mt.flex},i().createElement(l.Button,{color:"grey",style:mt.button,size:"small",variant:"outlined",onClick:()=>this.setState({showSelectId:!0})},c.I18n.t("ra_JSON editor"))),r?i().createElement(sn,{title:this.getText(s.label),overflowHidden:!0,onClose:()=>this.setState({showSelectId:!1,value:d.getValue(e,t)||{}}),onApply:()=>this.setState({showSelectId:!1},()=>this.onChange(t,n))},i().createElement("div",{style:Y(Y({},mt.wrapper),this.state.jsonError?{}:void 0)},i().createElement(lt,{value:typeof n=="object"?JSON.stringify(n):n,onChange:o=>this.setState({value:o,jsonError:this.validateJson(o)}),name:"ConfigJsonEditor",themeType:this.props.themeType}))):null,s.help||this.state.jsonError?i().createElement(l.FormHelperText,null,this.state.jsonError?c.I18n.t("ra_Invalid JSON"):this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)):null)}}const Nn=rn,Ln=[{value:"en",label:"English"},{value:"de",label:"Deutsch"},{value:"ru",label:"\u0440\u0443\u0441\u0441\u043A\u0438\u0439"},{value:"pt",label:"Portugues"},{value:"nl",label:"Nederlands"},{value:"fr",label:"fran\xE7ais"},{value:"it",label:"Italiano"},{value:"es",label:"Espanol"},{value:"pl",label:"Polski"},{value:"uk",label:"\u0423\u043A\u0440\u0430\u0457\u043D\u0441\u044C\u043A\u0438\u0439"},{value:"zh-ch",label:"\u7B80\u4F53\u4E2D\u6587"}];class Pn extends d{componentDidMount(){super.componentDidMount();const s=d.getValue(this.props.data,this.props.attr),e=[...Ln];this.props.schema.system?e.unshift({value:"",label:c.I18n.t("ra_System language")}):e.unshift({value:"",label:c.I18n.t("ra_none")}),this.setState({value:this.props.schema.system?s||"":s||c.I18n.getLanguage(),selectOptions:e})}renderItem(s,e){var n,r;if(!this.state.selectOptions)return null;const t=(n=this.state.selectOptions)==null?void 0:n.find(o=>o.value===this.state.value||!o.value&&!this.state.value);return i().createElement(l.FormControl,{fullWidth:!0,variant:"standard"},this.props.schema.label?i().createElement(l.InputLabel,null,this.getText(this.props.schema.label)):null,i().createElement(l.Select,{variant:"standard",error:!!s,disabled:e,value:this.state.value||"_",renderValue:()=>this.getText(t==null?void 0:t.label,this.props.schema.noTranslation),onChange:o=>{let{value:a}=o.target;a==="_"&&(a=""),this.setState({value:a},()=>{const h=this.onChange(this.props.attr,a);if(h instanceof Promise&&h.catch(I=>console.error(I)),this.props.schema.changeGuiLanguage)if(a){if(a===c.I18n.getLanguage())return;c.I18n.setLanguage(a),this.props.changeLanguage&&this.props.changeLanguage()}else this.props.socket.getSystemConfig().then(I=>{I.common.language!==c.I18n.getLanguage()&&I.common.language&&(c.I18n.setLanguage(I.common.language),this.props.changeLanguage&&this.props.changeLanguage())}).catch(I=>console.error(`Cannot read system config: ${I}`))})}},(r=this.state.selectOptions)==null?void 0:r.map(o=>i().createElement(l.MenuItem,{key:o.value,value:o.value},o.label))),this.props.schema.help?i().createElement(l.FormHelperText,null,this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)):null)}}const Rn=Pn;class Mn extends d{constructor(e){super(e);X(this,"scrollRef");this.scrollRef=i().createRef()}scrolledDown(){return this.scrollRef.current?this.scrollRef.current.offsetHeight+this.scrollRef.current.scrollTop>=this.scrollRef.current.scrollHeight:!1}componentDidMount(){super.componentDidMount(),d.getValue(this.props.data,this.props.attr)||(this.props.schema.licenseUrl?(this.setState({showLicenseDialog:!0,loading:!0,scrolledDown:!1}),fetch(this.props.schema.licenseUrl).then(e=>e.text()).then(e=>this.setState({license:e,loading:!1})).catch(e=>this.setState({license:e.toString(),loading:!1,error:!0,scrolledDown:!1}))):this.setState({showLicenseDialog:!0,scrolledDown:!1}),setTimeout(()=>{this.scrollRef.current&&(this.scrolledDown()?this.setState({scrolledDown:!0}):this.scrollRef.current.addEventListener("scroll",()=>{!this.state.scrolledDown&&this.scrolledDown()&&this.setState({scrolledDown:!0})}))},1e3))}renderItem(){return this.state.showLicenseDialog?i().createElement(l.Dialog,{maxWidth:"lg",open:!0,onClose:(e,t)=>{t!=="escapeKeyDown"&&t!=="backdropClick"&&this.setState({showLicenseDialog:!1})}},i().createElement(l.DialogTitle,null,this.props.schema.title?c.I18n.t(this.props.schema.title):c.I18n.t("ra_License agreement")),i().createElement(l.DialogContent,null,this.props.schema.licenseUrl?i().createElement(i().Fragment,null,this.state.loading?i().createElement(l.LinearProgress,null):null,i().createElement("pre",{ref:this.scrollRef,style:{width:"100%",height:"100%",overflowY:"auto",fontSize:14}},this.state.license)):null,!this.props.schema.licenseUrl&&this.props.schema.texts?i().createElement("div",{ref:this.scrollRef,style:{width:"100%",height:"100%",overflowY:"auto",fontSize:14}},this.props.schema.texts.map((e,t)=>this.props.schema.noTranslation?i().createElement("p",{key:t},e):i().createElement("p",{key:t},c.I18n.t(e)))):null),i().createElement(l.DialogActions,null,this.props.schema.checkBox?i().createElement(l.FormControlLabel,{control:i().createElement(l.Checkbox,{checked:!!this.state.licenseChecked,onClick:()=>this.setState({licenseChecked:!this.state.licenseChecked})}),label:c.I18n.t(this.props.schema.checkBox)}):null,i().createElement(l.Button,{disabled:this.state.loading||this.state.error||this.props.schema.checkBox&&!this.state.licenseChecked||!this.state.scrolledDown,onClick:()=>{this.setState({showLicenseDialog:!1});const e=this.onChange(this.props.attr,!0);e instanceof Promise&&e.catch(t=>console.error(`Cannot set value: ${t}`))},color:"primary",variant:"contained",startIcon:i().createElement(u.Check,null)},this.props.schema.agreeText?c.I18n.t(this.props.schema.agreeText):c.I18n.t("ra_Accept license")),i().createElement(l.Button,{onClick:()=>{this.setState({showLicenseDialog:!1}),setTimeout(()=>this.setState({showLicenseDialog:!0}),2e3)},color:"grey",variant:"contained",startIcon:i().createElement(u.Close,null)},c.I18n.t("ra_Close")))):null}}const Vn=Mn,Cn={indeterminate:{opacity:.5},control:{flexDirection:"row",width:"100%"}};class Wn extends d{constructor(){super(...arguments);X(this,"updateTimeout")}componentDidMount(){super.componentDidMount();let e=d.getValue(this.props.data,this.props.attr);if(e==null&&(e=""),Array.isArray(e)&&this.props.multiEdit){e=d.DIFFERENT_VALUE,this.setState({_value:e,oldValue:e});return}this.setState({_value:e.toString(),oldValue:e.toString()})}static getDerivedStateFromProps(e,t){if(e.schema.min!==void 0&&e.schema.min<0||e.schema.max!==void 0&&e.schema.max<0)return null;const n=d.getValue(e.data,e.attr);return e.multiEdit&&t._value===d.DIFFERENT_VALUE?{_value:d.DIFFERENT_VALUE}:n==null||t.oldValue===null||t.oldValue===void 0||n.toString()!==parseFloat(t._value).toString()&&n.toString()!==t.oldValue.toString()?{_value:n}:null}checkValue(e){if(e==null)return null;e=e.toString().trim();const t=e===""?0:parseFloat(e);return e!==""&&Number.isNaN(t)?"ra_Not a number":e!==""&&window.isFinite(t)?this.props.schema.min!==void 0&&t<this.props.schema.min?"ra_Too small":this.props.schema.max!==void 0&&t>this.props.schema.max?"ra_Too big":e===""||e==="-"||Number.isNaN(t)?"ra_Not a number":null:"ra_Not a number"}renderItem(e,t){const n=Array.isArray(this.state._value)||this.state._value===d.DIFFERENT_VALUE;if(this.state.oldValue!==null&&this.state.oldValue!==void 0?(this.updateTimeout&&clearTimeout(this.updateTimeout),this.updateTimeout=setTimeout(()=>{this.updateTimeout=void 0,this.setState({oldValue:null})},30)):this.updateTimeout&&(clearTimeout(this.updateTimeout),this.updateTimeout=void 0),n){const r=d.getValue(this.props.data,this.props.attr),o=(r==null?void 0:r.filter(a=>a||a===0).map(a=>({label:a.toString(),value:a})))||[];return o.unshift({label:c.I18n.t(d.DIFFERENT_LABEL),value:d.DIFFERENT_VALUE}),i().createElement(l.Autocomplete,{style:Cn.indeterminate,fullWidth:!0,freeSolo:!0,value:o[0],getOptionSelected:(a,h)=>a.label===h.label,onChange:(a,h)=>{const I=this.onChange(this.props.attr,h==null?void 0:h.value,()=>{this.setState({_value:h==null?void 0:h.value,oldValue:this.state._value})});I instanceof Promise&&I.catch(O=>console.error(O))},options:o,getOptionLabel:a=>a.label,renderInput:a=>i().createElement(l.TextField,$e(Y({},a),{label:this.getText(this.props.schema.label),variant:"standard",slotProps:{htmlInput:$e(Y({},a.inputProps),{readOnly:this.props.schema.readOnly||!1})},error:!!e,placeholder:this.getText(this.props.schema.placeholder),helperText:this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation),disabled:!!t}))})}return!e&&this.state._value!==null&&this.state._value!==void 0&&this.state._value&&(e=this.checkValue(this.state._value),e&&(e=c.I18n.t(e))),i().createElement(l.FormControl,{variant:"standard",style:Cn.control},i().createElement(l.TextField,{variant:"standard",type:"number",fullWidth:!0,slotProps:{htmlInput:{min:this.props.schema.min,max:this.props.schema.max,step:this.props.schema.step,readOnly:this.props.schema.readOnly||!1}},value:this.state._value===null||this.state._value===void 0?"":this.state._value,error:!!e,disabled:!!t,onChange:r=>{const o=r.target.value,a=this.checkValue(o);a?this.onError(this.props.attr,c.I18n.t(a)):this.onError(this.props.attr),this.setState({_value:o,oldValue:this.state._value},()=>this.onChange(this.props.attr,parseFloat(o)))},placeholder:this.getText(this.props.schema.placeholder),label:this.getText(this.props.schema.label),helperText:e&&typeof e=="string"?e:this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)}))}}const Un=Wn,yn={flex:{display:"flex"},button:{height:48,marginLeft:4,minWidth:48}};class Jn extends d{componentDidMount(){super.componentDidMount();const{data:s,attr:e}=this.props,t=d.getValue(s,e)||"";this.setState({value:t,initialized:!0})}renderItem(s,e){if(!this.state.initialized)return null;const{schema:t,socket:n,attr:r}=this.props,{value:o,showSelectId:a}=this.state;return i().createElement(l.FormControl,{fullWidth:!0,variant:"standard"},t.label?i().createElement(l.InputLabel,{shrink:!0},this.getText(t.label)):null,i().createElement("div",{style:yn.flex},i().createElement(l.TextField,{variant:"standard",fullWidth:!0,value:o,error:!!s,disabled:e,placeholder:this.getText(t.placeholder),label:this.getText(t.label),helperText:this.renderHelp(t.help,t.helpLink,t.noTranslation),onChange:h=>{const I=h.target.value;this.setState({value:I},()=>this.onChange(r,I))}}),i().createElement(l.Button,{color:"grey",style:yn.button,size:"small",variant:"outlined",onClick:()=>this.setState({showSelectId:!0})},"...")),a?i().createElement(c.DialogSelectID,{imagePrefix:this.props.imagePrefix===void 0?"../..":this.props.imagePrefix,dialogName:`admin.${this.props.adapterName}`,filterFunc:t.filterFunc,themeType:this.props.themeType,theme:this.props.theme,types:t.types?Array.isArray(t.types)?t.types:[t.types]:void 0,customFilter:t.customFilter,filters:t.filters,socket:n,selected:o,root:t.root,onClose:()=>this.setState({showSelectId:!1}),onOk:h=>this.setState({showSelectId:!1,value:h},()=>this.onChange(r,h))}):null)}}const jn=Jn,on={fullWidth:{width:"100%",display:"inline-block"},halfWidth1:{width:"calc(50% - 4px)",display:"inline-block",marginRight:8},halfWidth2:{width:"calc(50% - 4px)",display:"inline-block"}},_t="____ppp____";class Hn extends d{componentDidMount(){super.componentDidMount();const s=d.getValue(this.props.data,this.props.attr);this.setState({_repeat:s?_t:"",_visible:!1,value:s?_t:"",_notEqual:!1})}onChangePassword(s,e){s===void 0&&(s=this.state.value),e===void 0&&(e=this.state._repeat);const t=!!this.props.schema.repeat&&e!==s;this.setState({value:s,_repeat:e,_notEqual:t},()=>{if(t)this.onError(this.props.attr,c.I18n.t("ra_Passwords are not equal!"));else{this.onError(this.props.attr);const n=this.onChange(this.props.attr,s);n instanceof Promise&&n.catch(r=>this.onError(this.props.attr,r))}})}renderItem(s,e){if(this.state._notEqual===void 0)return null;const t=i().createElement(l.TextField,{variant:"standard",fullWidth:!0,type:this.state._visible&&this.state.value!==_t?"text":"password",value:this.state.value,error:!!s||this.state._notEqual,disabled:!!e,onChange:n=>this.onChangePassword(n.target.value),label:this.getText(this.props.schema.label),slotProps:{input:{autoComplete:"new-password",endAdornment:this.state.value&&this.state.value!==_t&&this.props.schema.visible&&!e&&!this.props.schema.readOnly?i().createElement(l.InputAdornment,{position:"end"},i().createElement(l.IconButton,{size:"large",tabIndex:-1,onClick:n=>{n.preventDefault(),n.stopPropagation(),this.setState({_visible:!this.state._visible})},edge:"end"},this.state._visible?i().createElement(u.VisibilityOff,null):i().createElement(u.Visibility,null))):void 0},htmlInput:{autoComplete:"new-password",form:{autoComplete:"off"},maxLength:this.props.schema.maxLength||this.props.schema.max||void 0,readOnly:this.props.schema.readOnly||!1}},helperText:this.state._notEqual?c.I18n.t("ra_Passwords are not equal!"):this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)});if(this.props.schema.repeat&&!this.props.schema.readOnly){const n=i().createElement(l.TextField,{variant:"standard",fullWidth:!0,type:this.state._visible&&this.state._repeat!==_t?"text":"password",value:this.state._repeat,error:!!s||this.state._notEqual,disabled:!!e,onChange:r=>this.onChangePassword(void 0,r.target.value),label:`${this.getText(this.props.schema.label)} (${c.I18n.t("ra_repeat")})`,slotProps:{input:{endAdornment:this.state._repeat&&this.state._repeat!==_t&&this.props.schema.visible&&!e?i().createElement(l.InputAdornment,{position:"end"},i().createElement(l.IconButton,{size:"large",tabIndex:-1,onClick:r=>{r.preventDefault(),r.stopPropagation(),this.setState({_visible:!this.state._visible})},edge:"end"},this.state._visible?i().createElement(u.VisibilityOff,null):i().createElement(u.Visibility,null))):void 0,autoComplete:"new-password"},htmlInput:{autoComplete:"new-password",form:{autoComplete:"off"},maxLength:this.props.schema.maxLength||this.props.schema.max||void 0}},helperText:this.state._notEqual?c.I18n.t("ra_Passwords are not equal!"):this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)});return i().createElement("div",{style:on.fullWidth},i().createElement("div",{style:on.halfWidth1},t),i().createElement("div",{style:on.halfWidth2},n))}return t}}const zn=Hn;class Kn extends d{renderItem(s,e){return i().createElement(l.TextField,{variant:"standard",fullWidth:!0,disabled:!!e,slotProps:{input:{endAdornment:this.props.schema.copyToClipboard?i().createElement(l.IconButton,{size:"small",onClick:()=>{c.Utils.copyToClipboard(this.getPattern(this.props.schema.pattern)),window.alert("Copied")}},i().createElement(c.IconCopy,null)):void 0}},value:this.getPattern(this.props.schema.pattern),label:this.getText(this.props.schema.label),helperText:this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)})}}const Gn=Kn,qn={warning:{"& .Mui-error":{color:"orange"}}};class an extends d{constructor(){super(...arguments);X(this,"updateTimeout")}componentDidMount(){return pe(this,null,function*(){st(an.prototype,this,"componentDidMount").call(this);let e=d.getValue(this.props.data,this.props.attr);e==null&&(e=""),this.setState({_value:e.toString(),oldValue:e.toString()});const t=yield this.props.socket.getAdapterInstances(),n=`system.adapter.${this.props.adapterName}.${this.props.instance}`,r=yield this.props.socket.getObject(n),o=r==null?void 0:r.common.host,a=[];t.forEach(h=>{var O,L,q,he;if(!h||h._id===n||h.common.host!==o||!((O=h.native)!=null&&O.bind))return;if(h!=null&&h.native&&h.native.secure&&h.native.leEnabled&&h.native.leUpdate){const Ee=parseInt(h.native.leCheckPort||h.native.lePort,10);Ee&&a.push({name:`${h._id.replace("system.adapter.","")} (LE)`,port:Ee,v6bind:h.native.bind.includes(":")?h.native.bind:h.native.v6bind,bind:h.native.bind,enabled:!!((L=h.common)!=null&&L.enabled)})}const I=parseInt((q=h==null?void 0:h.native)==null?void 0:q.port,10);I&&a.push({name:h._id.replace("system.adapter.",""),bind:h.native.bind,v6bind:h.native.bind.includes(":")?h.native.bind:h.native.v6bind,port:I,enabled:!!((he=h.common)!=null&&he.enabled)})}),this.setState({ports:a})})}static getDerivedStateFromProps(e,t){const n=d.getValue(e.data,e.attr);return n==null||t.oldValue===null||t.oldValue===void 0||n.toString()!==parseInt(t._value,10).toString()&&n.toString()!==t.oldValue.toString()?{_value:n}:null}checkValue(e){if(e==null)return null;const t=this.props.schema.min===void 0?20:this.props.schema.min,n=this.props.schema.max||65535;e=e.toString().trim();const r=e===""?0:parseInt(e,10);return e!==""&&Number.isNaN(r)?"ra_Not a number":e!==""&&window.isFinite(Number(e))?r<t?"ra_Too small":r>n?"ra_Too big":e===""||e==="-"||Number.isNaN(r)?"ra_Not a number":null:"ra_Not a number"}renderItem(e,t){this.state.oldValue!==null&&this.state.oldValue!==void 0?(this.updateTimeout&&clearTimeout(this.updateTimeout),this.updateTimeout=setTimeout(()=>{this.updateTimeout=void 0,this.setState({oldValue:null})},30)):this.updateTimeout&&(clearTimeout(this.updateTimeout),this.updateTimeout=void 0);const n=this.props.schema.min===void 0?20:this.props.schema.min,r=this.props.schema.max||65535;let o;if(this.state.ports){const a=parseInt(this.state._value,10);if(a){const h=this.state.ports.filter(O=>!this.props.data.bind||this.props.data.bind===O.bind||this.props.data.bind==="0.0.0.0"||O.bind==="0.0.0.0");let I=h.findIndex(O=>O.port===a&&O.enabled);I!==-1?e=c.I18n.t("ra_Port is already used by %s",this.state.ports[I].name):(I=h.findIndex(O=>O.port===a&&!O.enabled),I!==-1&&(o=!0,e=c.I18n.t("ra_Port could be used by %s",this.state.ports[I].name)))}}return!e&&this.state._value!==null&&this.state._value!==void 0&&(e=this.checkValue(this.state._value),typeof e=="string"&&(e=c.I18n.t(e))),i().createElement(l.TextField,{variant:"standard",type:"number",fullWidth:!0,slotProps:{htmlInput:{min:n,max:r,readOnly:this.props.schema.readOnly||!1}},value:this.state._value===null||this.state._value===void 0?"":this.state._value,error:!!e,disabled:!!t,sx:o?qn.warning:void 0,onChange:a=>{const h=Number(a.target.value.toString().replace(/[^0-9]/g,"")).toString(),I=this.checkValue(h);I?this.onError(this.props.attr,c.I18n.t(I)):this.onError(this.props.attr),this.setState({_value:h,oldValue:this.state._value},()=>{if(h.trim()===parseInt(h,10).toString()){const O=this.onChange(this.props.attr,parseInt(h,10)||0);O instanceof Promise&&O.catch(L=>{console.error(`Cannot set value for ${this.props.attr}: ${L}`)})}})},placeholder:this.getText(this.props.schema.placeholder),label:this.getText(this.props.schema.label),helperText:e&&typeof e=="string"?e:this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)})}}const Yn=an;class Xn extends d{componentDidMount(){super.componentDidMount();const s=d.getValue(this.props.data,this.props.attr);this.props.socket.getEnums("rooms").then(e=>{const t=Object.keys(e).map(n=>({value:this.props.schema.short?n.replace("enum.rooms.",""):n,label:this.getText(e[n].common.name),obj:e[n]}));this.props.schema.allowDeactivate!==!1&&t.unshift({label:c.I18n.t(d.NONE_LABEL),value:d.NONE_VALUE}),this.setState({value:s,selectOptions:t})}).catch(e=>console.error(`Cannot get enums: ${e}`))}renderItem(s,e){if(!this.state.selectOptions)return null;const t=this.state.selectOptions.find(n=>n.value===this.state.value);return i().createElement(l.FormControl,{variant:"standard",fullWidth:!0},this.props.schema.label?i().createElement(l.InputLabel,null,this.getText(this.props.schema.label)):null,i().createElement(l.Select,{variant:"standard",error:!!s,disabled:!!e,value:this.state.value||"_",renderValue:()=>t?t.obj?i().createElement(c.TextWithIcon,{value:t.obj,themeType:this.props.themeType,lang:c.I18n.getLanguage()}):t.label:"",onChange:n=>{this.setState({value:n.target.value==="_"?"":n.target.value},()=>this.onChange(this.props.attr,this.state.value))}},this.state.selectOptions.map(n=>i().createElement(l.MenuItem,{key:n.value,value:n.value,style:n.value===d.DIFFERENT_VALUE?{opacity:.5}:{}},n.obj?i().createElement(c.TextWithIcon,{value:n.obj,themeType:this.props.themeType,lang:c.I18n.getLanguage()}):n.label))),this.props.schema.help?i().createElement(l.FormHelperText,null,this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)):null)}}const Zn=Xn,Qn={fullWidth:{width:"100%"},noMargin:{"&>div":{marginTop:0}}};class es extends d{constructor(){super(...arguments);X(this,"initialValue","")}componentDidMount(){super.componentDidMount();const e=d.getValue(this.props.data,this.props.attr),t=[];(this.props.schema.options||[]).forEach(n=>{const r=n;Array.isArray(r.items)?(t.push({label:this.getText(n.label),value:n.value,group:!0}),r.items.forEach(o=>t.push({label:this.getText(o.label),value:o.value,hidden:o.hidden}))):t.push({label:this.getText(n.label),value:n.value,hidden:n.hidden})}),Array.isArray(e)?(this.initialValue=[...e],t.unshift({label:c.I18n.t(d.DIFFERENT_LABEL),value:d.DIFFERENT_VALUE}),this.setState({value:d.DIFFERENT_VALUE,selectOptions:t})):this.setState({value:e,selectOptions:t})}renderItem(e,t){if(!this.state.selectOptions)return null;const n=(this.state.selectOptions||[]).filter(o=>o.hidden?this.props.custom?!this.executeCustom(o.hidden,this.props.data,this.props.customObj,this.props.instanceObj,this.props.arrayIndex,this.props.globalData):!this.execute(o.hidden,this.props.schema.default,this.props.data,this.props.arrayIndex,this.props.globalData):!0),r=n.find(o=>o.value==this.state.value);return i().createElement(l.FormControl,{variant:"standard",fullWidth:!0,sx:this.props.table!==void 0&&Qn.noMargin,id:`jsonSelect_${this.props.attr}_${this.props.index||this.props.index===0?this.props.index:""}`},this.props.schema.label?i().createElement(l.InputLabel,null,this.getText(this.props.schema.label)):null,i().createElement(l.Select,{variant:"standard",error:!!e,disabled:!!t,value:this.state.value||"_",renderValue:()=>this.getText(r==null?void 0:r.label,this.props.schema.noTranslation),onChange:o=>{this.setState({value:o.target.value==="_"?"":o.target.value},()=>{let a;this.state.value===d.DIFFERENT_VALUE?a=this.onChange(this.props.attr,this.initialValue):a=this.onChange(this.props.attr,this.state.value),a instanceof Promise&&a.catch(h=>console.error(h))})}},n.map((o,a)=>o.group?i().createElement(l.ListSubheader,{key:a},this.getText(o.label,this.props.schema.noTranslation)):i().createElement(l.MenuItem,{key:a,value:o.value,style:o.value===d.DIFFERENT_VALUE?{opacity:.5}:{}},this.getText(o.label,this.props.schema.noTranslation)))),this.props.schema.help?i().createElement(l.FormHelperText,null,this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)):null)}}const ts=es,ns={menuPaper:{maxHeight:800}};class ss extends d{constructor(){super(...arguments);X(this,"initialized",!1);X(this,"_context")}askInstance(){if(this.props.alive){let e=this.props.schema.data;if(e===void 0&&this.props.schema.jsonData){const t=this.getPattern(this.props.schema.jsonData);try{e=JSON.parse(t)}catch(n){console.error(`Cannot parse json data: ${t}`)}}e===void 0&&(e=null),this.setState({running:!0},()=>{this.props.socket.sendTo(`${this.props.adapterName}.${this.props.instance}`,this.props.schema.command||"send",e).then(t=>this.setState({list:t,running:!1})).catch(t=>{console.error(`Cannot send command: ${t}`)})})}else{const e=d.getValue(this.props.data,this.props.attr);this.setState({value:e,running:!1})}}getContext(){const e={};return Array.isArray(this.props.schema.alsoDependsOn)&&this.props.schema.alsoDependsOn.forEach(t=>e[t]=d.getValue(this.props.data,t)),JSON.stringify(e)}_getValue(){let e=this.state.value===null||this.state.value===void 0?d.getValue(this.props.data,this.props.attr):this.state.value;return this.props.schema.multiple&&(typeof e=="string"?e=[e]:e==null&&(e=[])),e}renderItem(e,t){var a;if(this.props.alive){const h=this.getContext();(h!==this._context||!this.initialized)&&(this._context=h,setTimeout(()=>this.askInstance(),this.initialized?300:50),this.initialized=!0)}const n=this._getValue();if(!this.props.alive||!this.state.running&&!((a=this.state.list)!=null&&a.length))return this.props.schema.multiple||this.props.schema.manual===!1?c.I18n.t("ra_Cannot retrieve options, as instance is offline"):i().createElement(l.TextField,{variant:"standard",fullWidth:!0,value:n,error:!!e,disabled:!!t,onChange:h=>{const I=h.target.value;this.setState({value:I},()=>this.onChange(this.props.attr,(I||"").trim()))},placeholder:this.getText(this.props.schema.placeholder),label:this.getText(this.props.schema.label),helperText:this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation),slotProps:{input:{endAdornment:this.state.value&&!this.props.schema.noClearButton?i().createElement(l.InputAdornment,{position:"end"},i().createElement(l.IconButton,{size:"small",onClick:()=>this.setState({value:""},()=>this.onChange(this.props.attr,""))},i().createElement(u.Close,null))):null}}});if(this.state.running)return i().createElement(l.CircularProgress,{size:"24"});const r=this.state.list.filter(h=>h.hidden?this.props.custom?!this.executeCustom(h.hidden,this.props.data,this.props.customObj,this.props.instanceObj,this.props.arrayIndex,this.props.globalData):!this.execute(h.hidden,this.props.schema.default,this.props.data,this.props.arrayIndex,this.props.globalData):!0),o=r.find(h=>h.value===n);return i().createElement(l.FormControl,{variant:"standard",fullWidth:!0},this.props.schema.label?i().createElement(l.InputLabel,null,this.getText(this.props.schema.label)):null,i().createElement(l.Select,{variant:"standard",error:!!e,multiple:this.props.schema.multiple,disabled:!!t,sx:{"&.MuiSelect-paper":this.props.schema.multiple?ns.menuPaper:void 0},value:n,renderValue:h=>this.props.schema.multiple?i().createElement(l.Box,{sx:{display:"flex",flexWrap:"wrap",gap:.5}},h.map(I=>{const O=r.find(L=>L.value===I);if(O||this.props.schema.showAllValues!==!1){const L=(O==null?void 0:O.label)||I;return i().createElement(l.Chip,{key:I,label:L})}return null})):(o==null?void 0:o.label)||h,onChange:h=>{const I=this.onChange(this.props.attr,h.target.value);I instanceof Promise&&I.catch(O=>console.error(`Cannot set value: ${O}`))}},r.map((h,I)=>i().createElement(l.MenuItem,{key:I,value:h.value},this.props.schema.multiple?i().createElement(l.Checkbox,{checked:n.includes(h.value),onClick:()=>{const O=JSON.parse(JSON.stringify(this._getValue())),L=n.indexOf(h.value);L!==-1?O.splice(L,1):(O.push(h.value),O.sort()),this.setState({value:O},()=>this.onChange(this.props.attr,O))}}):null,i().createElement(l.ListItemText,{primary:h.label})))),this.props.schema.help?i().createElement(l.FormHelperText,null,this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)):null)}}const is=ss,En={fullWidth:{width:"100%"}};function ft(x){return x.split(".").reduce((s,e)=>(s<<8)+parseInt(e,10),0)>>>0}function rs(x,s){var n,r;const e=(r=(n=x==null?void 0:x.native)==null?void 0:n.hardware)==null?void 0:r.networkInterfaces;if(!e)return null;let t;return Object.keys(e).forEach(o=>e[o].forEach(a=>{a.internal||s.includes(":")&&a.family!=="IPv6"||s.includes(".")&&!s.match(/[^.\d]/)&&a.family!=="IPv4"||(a.family==="IPv4"&&!a.address.startsWith("172")&&(s==="127.0.0.0"||s==="localhost"||s.match(/[^.\d]/))?t=a.address:t||(a.family==="IPv4"&&s.includes(".")&&(ft(s)&ft(a.netmask),ft(a.address)&ft(a.netmask)),t=a.address))})),t||Object.keys(e).forEach(o=>e[o].forEach(a=>{a.internal||s.includes(":")&&a.family!=="IPv6"||s.includes(".")&&!s.match(/[^.\d]/)&&a.family!=="IPv4"||(a.family==="IPv6"&&(s==="127.0.0.0"||s==="localhost"||s.match(/[^.\d]/))?t=a.address:t||(a.family==="IPv4"&&s.includes(".")&&(ft(s)&ft(a.netmask),ft(a.address)&ft(a.netmask)),t=a.address))})),t||Object.keys(e).forEach(o=>{e[o].forEach(a=>{a.internal||s.includes(":")&&a.family!=="IPv6"||s.includes(".")&&!s.match(/[^.\d]/)&&a.family!=="IPv4"||(s==="127.0.0.0"||s==="localhost"||s.match(/[^.\d]/),t=a.address)})}),t||Object.keys(e).forEach(o=>{e[o].forEach(a=>{a.internal||(t=a.address)})}),t}class ln extends d{componentDidMount(){return pe(this,null,function*(){var e;st(ln.prototype,this,"componentDidMount").call(this);let s=window.location.hostname;if(this.props.schema.openUrl){const t=yield this.props.socket.getCurrentInstance(),n=yield this.props.socket.getObject(`system.adapter.${t}`);if(n){const r=yield this.props.socket.getObject(`system.host.${(e=n==null?void 0:n.common)==null?void 0:e.host}`);if(r){const o=rs(r,window.location.hostname);if(o)s=`${o}:${window.location.port}`;else{console.warn(`Cannot find suitable IP in host ${n.common.host} for ${n._id}`);return}}}}yield new Promise(t=>{this.setState({_error:"",_message:"",hostname:s},t)}),this.props.schema.onLoaded&&this._onClick()})}renderErrorDialog(){return this.state._error?i().createElement(c.DialogError,{text:this.state._error,onClose:()=>this.setState({_error:""})}):null}renderMessageDialog(){return this.state._message?i().createElement(c.DialogMessage,{text:this.state._message,onClose:()=>this.setState({_message:""})}):null}_onClick(){this.props.onCommandRunning(!0),this.setState({running:!0});const s=`${window.location.protocol}//${window.location.host}${window.location.pathname.replace(/\/index\.html$/,"")}`,e=`${window.location.protocol}//${this.state.hostname.split(":").length>3?`[${this.state.hostname}]`:this.state.hostname}${window.location.pathname.replace(/\/index\.html$/,"")}`;let t=this.props.schema.data;if(t===void 0&&this.props.schema.jsonData){const r=this.getPattern(this.props.schema.jsonData,Y({_origin:s,_originIp:e},this.props.data));try{t=JSON.parse(r)}catch(o){console.error(`Cannot parse json data: ${r}`)}}t===void 0&&(t=null),this.props.schema.openUrl&&!t&&(t={_origin:s,_originIp:e});let n;this.props.schema.timeout&&(n=setTimeout(()=>{this.props.onCommandRunning(!1),this.setState({_error:c.I18n.t("ra_Request timed out"),running:!1})},parseInt(this.props.schema.timeout,10)||1e4)),this.props.socket.sendTo(`${this.props.adapterName}.${this.props.instance}`,this.props.schema.command||"send",t).then(r=>pe(this,null,function*(){if(n&&(clearTimeout(n),n=void 0),r!=null&&r.error)if(this.props.schema.error&&this.props.schema.error[r.error]){let o=this.getText(this.props.schema.error[r.error]);r.args&&r.args.forEach(a=>o=o.replace("%s",a)),this.setState({_error:o})}else this.setState({_error:r.error?c.I18n.t(r.error):c.I18n.t("ra_Error")});else{if(r!=null&&r.command){this.props.onBackEndCommand&&this.props.onBackEndCommand(r.command);return}if(r!=null&&r.reloadBrowser&&this.props.schema.reloadBrowser)window.location.reload();else if(r!=null&&r.openUrl&&this.props.schema.openUrl)window.open(r.openUrl,r.window||this.props.schema.window||"_blank");else if(r!=null&&r.result&&this.props.schema.result&&this.props.schema.result[r.result]){let o=this.getText(this.props.schema.result[r.result]);r.args&&r.args.forEach(a=>o=o.replace("%s",a)),window.alert(o)}if(r!=null&&r.native&&this.props.schema.useNative){for(const[o,a]of Object.entries(r.native))yield this.onChangeAsync(o,a);setTimeout(()=>this.props.forceUpdate(Object.keys(r.native),this.props.data),300)}else r!=null&&r.result?window.alert(typeof r.result=="object"?JSON.stringify(r.result):r.result):window.alert(c.I18n.t("ra_Ok"));r!=null&&r.saveConfig&&this.props.onChange(null,null,null,!0)}})).catch(r=>{this.props.schema.error&&this.props.schema.error[r.toString()]?this.setState({_error:this.getText(this.props.schema.error[r.toString()])}):this.setState({_error:c.I18n.t(r.toString())||c.I18n.t("ra_Error")})}).then(()=>{this.props.onCommandRunning(!1),this.setState({running:!1})})}renderDialogConfirm(){if(!this.state.confirmDialog)return null;const s=this.state.confirmData||this.props.schema.confirm;let e=null;return s.type==="warning"?e=i().createElement(u.Warning,null):s.type==="error"?e=i().createElement(u.Error,null):s.type==="info"&&(e=i().createElement(u.Info,null)),i().createElement(c.DialogConfirm,{title:this.getText(s.title)||c.I18n.t("ra_Please confirm"),text:this.getText(s.text),ok:this.getText(s.ok)||c.I18n.t("ra_Ok"),cancel:this.getText(s.cancel)||c.I18n.t("ra_Cancel"),icon:e||void 0,onClose:t=>this.setState({confirmDialog:!1},()=>t&&this._onClick())})}renderItem(s,e){const t=this.getIcon();return i().createElement("div",{style:En.fullWidth},i().createElement(l.Button,{variant:this.props.schema.variant||void 0,color:this.props.schema.color||"grey",style:Y(Y({},En.fullWidth),this.props.schema.controlStyle||void 0),disabled:e||!this.props.alive,startIcon:t,title:this.props.alive?this.getText(this.props.schema.title)||"":c.I18n.t("ra_Instance is not alive"),onClick:()=>{this.props.schema.confirm?this.setState({confirmDialog:!0}):this._onClick()}},this.props.schema.showProcess&&this.state.running?i().createElement(l.CircularProgress,{size:20,style:{marginRight:8}}):null,this.getText(this.props.schema.label,this.props.schema.noTranslation)),this.renderErrorDialog(),this.renderMessageDialog())}}const bn=ln,xn={fullWidth:{width:"100%"},icon:{width:24,height:24,marginRight:4}};class os extends d{_onClick(){return pe(this,null,function*(){var t,n;let s=this.props.schema.val;if(typeof s=="string"&&s.includes("${")){s=this.getPattern(s);const r=yield this.props.socket.getObject(this.props.schema.id);((t=r==null?void 0:r.common)==null?void 0:t.type)==="number"?s=parseFloat(s):((n=r==null?void 0:r.common)==null?void 0:n.type)==="boolean"&&(s=s==="true"||s===!0||s==="1"||s===1)}const e=(this.props.schema.id||"").replace(/%INSTANCE%/g,(this.props.instance||0).toString());try{yield this.props.socket.setState(e,{val:s,ack:!!this.props.schema.ack}),this.props.schema.okText&&window.alert(this.getText(this.props.schema.okText))}catch(r){this.props.schema.error&&this.props.schema.error[r.toString()]?window.alert(this.getText(this.props.schema.error[r.toString()])):window.alert(c.I18n.t(r.toString())||c.I18n.t("ra_Error"))}})}renderDialogConfirm(){if(!this.state.confirmDialog)return null;const s=this.state.confirmData||this.props.schema.confirm;let e=null;return s.type==="warning"?e=i().createElement(u.Warning,null):s.type==="error"?e=i().createElement(u.Error,null):s.type==="info"&&(e=i().createElement(u.Info,null)),i().createElement(c.DialogConfirm,{title:this.getText(s.title)||c.I18n.t("ra_Please confirm"),text:this.getText(s.text),ok:this.getText(s.ok)||c.I18n.t("ra_Ok"),cancel:this.getText(s.cancel)||c.I18n.t("ra_Cancel"),icon:e,onClose:t=>this.setState({confirmDialog:!1},()=>t&&this._onClick())})}renderItem(s,e){return i().createElement(l.Button,{variant:this.props.schema.variant||void 0,color:this.props.schema.color||"grey",style:xn.fullWidth,disabled:e,onClick:()=>pe(this,null,function*(){this.props.schema.confirm?this.setState({confirmDialog:!0}):yield this._onClick()})},this.props.schema.icon?i().createElement(c.Icon,{src:this.props.schema.icon,style:xn.icon}):null,this.getText(this.props.schema.label,this.props.schema.noTranslation))}}const as=os,wn={fullWidth:{width:"100%"},slider:{marginLeft:10,marginRight:10,width:"calc(100% - 20px)"}};class ls extends d{componentDidMount(){super.componentDidMount();const s=d.getValue(this.props.data,this.props.attr);this.setState({_value:s})}static getDerivedStateFromProps(s,e){if(s.schema.min!==void 0&&s.schema.min<0||s.schema.max!==void 0&&s.schema.max<0)return null;const t=d.getValue(s.data,s.attr);return t==null||t.toString()!==parseFloat(e._value).toString()?{_value:t}:null}renderItem(s,e){const t=this.props.schema.min||0,n=this.props.schema.max||100,r=this.props.schema.unit||"",o=[{value:t,label:t+r},{value:n,label:n+r}];return i().createElement(l.Box,{style:wn.fullWidth},this.props.schema.label?i().createElement(l.Typography,{gutterBottom:!0},this.getText(this.props.schema.label)):null,i().createElement(l.Slider,{style:wn.slider,value:this.state._value,getAriaValueText:a=>a+r,step:this.props.schema.step||(n-t)/100,valueLabelDisplay:"auto",marks:o,min:t,max:n,disabled:!!e,onChange:a=>{const h=a.target.value;this.setState({_value:h},()=>this.onChange(this.props.attr,h))}}),this.props.schema.help?i().createElement(l.Typography,null,this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)):null)}}const us=ls;function gt(x,s){return x==="edit"||x==="rename"?i().createElement(u.Edit,{style:s}):x==="delete"?i().createElement(u.Delete,{style:s}):x==="refresh"?i().createElement(u.Refresh,{style:s}):x==="newDevice"||x==="new"||x==="add"?i().createElement(u.Add,{style:s}):x==="discover"||x==="search"?i().createElement(u.Search,{style:s}):x==="unpairDevice"||x==="unpair"?i().createElement(u.LinkOff,{style:s}):x==="pairDevice"||x==="pair"?i().createElement(u.Link,{style:s}):x==="identify"?i().createElement(u.NotListedLocation,{style:s}):x==="play"?i().createElement(u.PlayArrow,{style:s}):x==="stop"?i().createElement(u.Stop,{style:s}):x==="pause"?i().createElement(u.Pause,{style:s}):x==="forward"||x==="next"?i().createElement(u.FastForward,{style:s}):x==="rewind"||x==="previous"?i().createElement(u.FastRewind,{style:s}):x==="lamp"||x==="light"?i().createElement(u.Lightbulb,{style:s}):x==="backlight"?i().createElement(u.Fluorescent,{style:s}):x==="dimmer"?i().createElement(u.WbIncandescent,{style:s}):x==="socket"?i().createElement(u.Power,{style:s}):x==="settings"?i().createElement(u.Settings,{style:s}):x==="users"||x==="group"?i().createElement(u.Group,{style:s}):x==="user"?i().createElement(u.Person,{style:s}):x==="qrcode"?i().createElement(u.QrCode,{style:s}):x==="connection"?i().createElement(u.Wifi,{style:s}):x==="no-connection"?i().createElement(u.WifiOff,{style:s}):x==="visible"?i().createElement(u.Visibility,{style:s}):null}class un extends d{constructor(){super(...arguments);X(this,"controlTimeout",null);X(this,"delayedUpdate",{timer:null,value:null});X(this,"onStateChanged",(e,t)=>{let n=t?t.val:null;this.state.controlType==="button"||this.state.controlType==="switch"?(n=!!n,this.state.stateValue!==n&&this.setState({stateValue:n})):n!==null&&(this.state.controlType==="slider"||this.state.controlType==="number")?(n=parseFloat(n),console.log(`${Date.now()} Received new value: ${n}`),n!==this.state.stateValue?(this.delayedUpdate.timer&&(clearTimeout(this.delayedUpdate.timer),this.delayedUpdate.timer=null),this.delayedUpdate.value=n,this.delayedUpdate.timer=setTimeout(()=>{this.setState({stateValue:this.delayedUpdate.value})},500)):this.delayedUpdate.timer&&(clearTimeout(this.delayedUpdate.timer),this.delayedUpdate.timer=null)):this.state.stateValue.toString()!==n.toString()&&this.setState({stateValue:n})})}getObjectID(){return`${this.props.schema.system?"system.adapter.":""}${this.props.adapterName}.${this.props.instance}.${this.props.schema.oid}`}componentDidMount(){return pe(this,null,function*(){st(un.prototype,this,"componentDidMount").call(this);const e=yield this.props.socket.getObject(this.getObjectID()),t=this.props.schema.control||this.detectType(e),n=yield this.props.socket.getState(this.getObjectID());this.setState({stateValue:n?n.val:null,controlType:t,obj:e},()=>pe(this,null,function*(){yield this.props.socket.subscribeState(this.getObjectID(),this.onStateChanged)}))})}componentWillUnmount(){super.componentWillUnmount(),this.props.socket.unsubscribeState(this.getObjectID(),this.onStateChanged),this.delayedUpdate.timer&&(clearTimeout(this.delayedUpdate.timer),this.delayedUpdate.timer=null),this.controlTimeout&&(clearTimeout(this.controlTimeout),this.controlTimeout=null,this.props.socket.setState(this.getObjectID(),this.state.stateValue,!1).catch(e=>console.error(`Cannot control value: ${e}`)))}detectType(e){if(e=e||{},e.common=e.common||{},e.common.type==="boolean"){if(this.props.schema.controlled!==!1){if(e.common.read===!1||this.props.schema.controlled===!0)return"button";if(e.common.write||this.props.schema.controlled===!0)return"switch"}return"text"}return e.common.type==="number"&&this.props.schema.controlled!==!1?e.common.write||this.props.schema.controlled===!0?e.common.max!==void 0?"slider":"input":"text":e.common.write&&this.props.schema.controlled!==!1?"input":"text"}renderItem(){if(!this.state.obj)return null;let e;if(this.state.controlType==="button"){let t=null;this.props.schema.falseImage&&(t=gt(this.props.schema.falseImage));const n=this.getText(this.props.schema.falseText,this.props.schema.noTranslation)||this.getText(this.props.schema.label,this.props.schema.noTranslation);!n&&t?e=i().createElement(l.IconButton,{style:this.props.schema.falseTextStyle,disabled:!!this.props.schema.readOnly,onClick:()=>pe(this,null,function*(){this.props.schema.confirm?this.setState({confirmDialog:!0,confirmCallback:r=>pe(this,null,function*(){r&&(yield this.props.socket.setState(this.getObjectID(),!0,!1))})}):yield this.props.socket.setState(this.getObjectID(),!0,!1)})},t):e=i().createElement(l.Button,{variant:this.props.schema.variant||"contained",startIcon:t,style:this.props.schema.falseTextStyle,disabled:!!this.props.schema.readOnly,onClick:()=>pe(this,null,function*(){this.props.schema.confirm?this.setState({confirmDialog:!0,confirmCallback:r=>pe(this,null,function*(){r&&(yield this.props.socket.setState(this.getObjectID(),!0,!1))})}):yield this.props.socket.setState(this.getObjectID(),!0,!1)})},n||this.getObjectID().split(".").pop())}else if(this.state.controlType==="switch"){let t=null;const n=this.getText(this.props.schema.falseText,this.props.schema.noTranslation);this.props.schema.falseImage&&(t=gt(this.props.schema.falseImage,n?{marginLeft:8}:void 0));let r=null;const o=this.getText(this.props.schema.trueText,this.props.schema.noTranslation);this.props.schema.trueImage&&(r=gt(this.props.schema.trueImage,o?{marginRight:8}:void 0)),e=i().createElement(l.Switch,{checked:!!this.state.stateValue,disabled:!!this.props.schema.readOnly,onChange:()=>pe(this,null,function*(){this.props.schema.confirm?this.setState({confirmDialog:!0,confirmCallback:h=>pe(this,null,function*(){h&&(yield this.props.socket.setState(this.getObjectID(),!this.state.stateValue,!1))})}):yield this.props.socket.setState(this.getObjectID(),!this.state.stateValue,!1)})}),(n||t||o||r)&&(e=i().createElement("div",{style:{display:"flex",alignItems:"center",fontSize:14}},i().createElement("span",{style:this.props.schema.falseTextStyle},n,t),e,i().createElement("span",{style:this.props.schema.trueTextStyle},r,o)));const a=this.getText(this.props.schema.label,this.props.schema.noTranslation);a&&(e=i().createElement("div",{style:{display:"flex",alignItems:"center",fontSize:"1rem"}},i().createElement("span",{style:{marginRight:8}},a),e))}else if(this.state.controlType==="slider"){let t=null;const n=this.getText(this.props.schema.falseText,this.props.schema.noTranslation);this.props.schema.falseImage&&(t=gt(this.props.schema.falseImage,n?{marginLeft:8}:void 0));let r=null;const o=this.getText(this.props.schema.trueText,this.props.schema.noTranslation);this.props.schema.trueImage&&(r=gt(this.props.schema.trueImage,o?{marginRight:8}:void 0));const a=this.props.schema.min===void 0?this.state.obj.common.min||0:this.props.schema.min,h=this.props.schema.max===void 0?this.state.obj.common.max===void 0?100:this.state.obj.common.max:this.props.schema.max,I=this.props.schema.step===void 0?this.state.obj.common.step||1:this.props.schema.step;e=i().createElement(l.Slider,{style:{width:"100%",flexGrow:1},min:a,max:h,disabled:!!this.props.schema.readOnly,step:I,value:this.state.stateValue,valueLabelDisplay:"auto",valueLabelFormat:L=>`${L}${this.getText(this.props.schema.unit,this.props.schema.noTranslation)||this.state.obj.common.unit||""}`,onChange:(L,q)=>{this.setState({stateValue:q},()=>{this.controlTimeout&&clearTimeout(this.controlTimeout),this.controlTimeout=setTimeout(()=>pe(this,null,function*(){console.log(`${Date.now()} Send new value: ${this.state.stateValue}`),this.controlTimeout=null,yield this.props.socket.setState(this.getObjectID(),this.state.stateValue,!1)}),this.props.schema.controlDelay||0)})}}),(n||t||o||r)&&(e=i().createElement("div",{style:{display:"flex",width:"100%",flexGrow:1,alignItems:"center"}},i().createElement("span",{style:Y({marginRight:16},this.props.schema.falseTextStyle)},n,t),e,i().createElement("span",{style:Y({marginLeft:16},this.props.schema.trueTextStyle)},r,o)));const O=this.getText(this.props.schema.label,this.props.schema.noTranslation);O&&(e=i().createElement("div",{style:{display:"flex",width:"100%",alignItems:"center"}},i().createElement("span",{style:{whiteSpace:"nowrap",marginRight:8,fontSize:"1rem"}},O),e))}else if(this.state.controlType==="input")e=i().createElement(l.TextField,{style:{width:"100%"},value:this.state.stateValue,variant:"standard",slotProps:{input:{endAdornment:this.getText(this.props.schema.unit,this.props.schema.noTranslation)||this.state.obj.common.unit||void 0},htmlInput:{readOnly:!!this.props.schema.readOnly}},onChange:t=>{this.setState({stateValue:t.target.value},()=>{this.controlTimeout&&clearTimeout(this.controlTimeout),this.controlTimeout=setTimeout(()=>pe(this,null,function*(){this.controlTimeout=null,yield this.props.socket.setState(this.getObjectID(),this.state.stateValue,!1)}),this.props.schema.controlDelay||0)})},label:this.getText(this.props.schema.label),helperText:this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)});else if(this.state.obj.common.type==="number"){const t=this.props.schema.min===void 0?this.state.obj.common.min||0:this.props.schema.min,n=this.props.schema.max===void 0?this.state.obj.common.max===void 0?100:this.state.obj.common.max:this.props.schema.max,r=this.props.schema.step===void 0?this.state.obj.common.step||1:this.props.schema.step;e=i().createElement(l.TextField,{variant:"standard",style:{width:"100%"},value:this.state.stateValue,type:"number",slotProps:{htmlInput:{min:t,max:n,step:r,readOnly:!!this.props.schema.readOnly},input:{endAdornment:this.getText(this.props.schema.unit,this.props.schema.noTranslation)||this.state.obj.common.unit||void 0}},onChange:o=>{this.setState({stateValue:o.target.value},()=>{this.controlTimeout&&clearTimeout(this.controlTimeout),this.controlTimeout=setTimeout(()=>pe(this,null,function*(){this.controlTimeout=null;const a=parseFloat(this.state.stateValue);yield this.props.socket.setState(this.getObjectID(),a,!1)}),this.props.schema.controlDelay||0)})},label:this.getText(this.props.schema.label),helperText:this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)})}else if(this.state.obj.common.type==="boolean"){let t=null,n,r;this.state.stateValue?(n=this.getText(this.props.schema.trueText,this.props.schema.noTranslation),this.props.schema.trueImage&&(t=gt(this.props.schema.falseImage,n?{marginRight:8}:void 0)),r=this.props.schema.trueTextStyle):(n=this.getText(this.props.schema.falseText,this.props.schema.noTranslation),this.props.schema.falseImage&&(t=gt(this.props.schema.falseImage,n?{marginLeft:8}:void 0)),r=this.props.schema.falseTextStyle);const o=this.getText(this.props.schema.label,this.props.schema.noTranslation);e=i().createElement("div",{style:Y({fontSize:"1rem"},r)},o,o?i().createElement("span",{style:{marginRight:8}},":"):null,t,n||(this.state.stateValue?c.I18n.t("ra_true"):c.I18n.t("ra_false")))}else{const t=this.getText(this.props.schema.label,this.props.schema.noTranslation),n=this.getText(this.props.schema.unit,this.props.schema.noTranslation)||this.state.obj.common.unit;let r;this.state.controlType==="html"?r=i().createElement("span",{dangerouslySetInnerHTML:{__html:this.state.stateValue}}):this.state.stateValue===null?r="null":this.state.stateValue===void 0?r="undefined":r=this.state.stateValue,e=i().createElement("div",{style:{fontSize:"1rem"}},t,t?i().createElement("span",{style:{marginRight:8}},":"):null,r,n?i().createElement("span",{style:{opacity:.7}},n):null)}return e}}const cs=un,cn={fullWidth:x=>({width:"100%",backgroundColor:x.palette.mode==="dark"?"#FFF":"#000",borderStyle:"hidden"}),primary:x=>({backgroundColor:x.palette.primary.main}),secondary:x=>({backgroundColor:x.palette.secondary.main})};class hs extends d{renderItem(){return i().createElement(l.Box,{component:"hr",sx:te.getStyle(this.props.theme,cn.fullWidth,this.props.schema.color==="primary"?cn.primary:this.props.schema.color==="secondary"?cn.secondary:{backgroundColor:this.props.schema.color||(this.props.themeType==="dark"?"#333":"#ddd")},{height:this.props.schema.color?this.props.schema.height||2:this.props.schema.height||1})})}}const ps=hs,Nt={header:x=>({width:"100%",background:x.palette.primary.main,color:x.palette.primary.contrastText,padding:"4px !important",borderRadius:"3px",marginBlockEnd:0,marginBlockStart:0})};class ds extends d{renderItem(){switch((this.props.schema.size||5).toString()){case"1":return i().createElement(l.Box,{component:"h1",sx:Nt.header},this.getText(this.props.schema.text,this.props.schema.noTranslation));case"2":return i().createElement(l.Box,{component:"h2",sx:Nt.header},this.getText(this.props.schema.text,this.props.schema.noTranslation));case"3":return i().createElement(l.Box,{component:"h3",sx:Nt.header},this.getText(this.props.schema.text,this.props.schema.noTranslation));case"4":return i().createElement(l.Box,{component:"h4",sx:Nt.header},this.getText(this.props.schema.text,this.props.schema.noTranslation));case"5":default:return i().createElement(l.Box,{component:"h5",sx:Nt.header},this.getText(this.props.schema.text,this.props.schema.noTranslation))}}}const ms=ds;class fs extends d{renderItem(){let s=this.props.schema.src;return s&&!s.startsWith(".")&&!s.startsWith("http")&&!s.startsWith(`adapter/${this.props.adapterName}/`)&&!s.startsWith(`./adapter/${this.props.adapterName}/`)&&(s=`adapter/${this.props.adapterName}/${s}`),i().createElement("img",{src:s,style:{cursor:this.props.schema.href?"pointer":void 0,width:"100%",height:"100%"},onClick:this.props.schema.href?()=>this.props.schema.href&&window.open(this.props.schema.href,"_blank"):null,alt:""})}}const gs=fs,Fn={fullWidth:{height:"100%",width:"100%"},link:x=>({textDecoration:"underline",color:x.palette.mode==="dark"?"#4dabf5":"#254e72",cursor:"pointer"})};function An(x,s,e){let t,n="";x?x.toString().startsWith("#")||x.toString().startsWith("/")?(t=s||"_self",n=x):x.startsWith("http://")||x.startsWith("https://")?(t=s||"_blank",n=x):(n=`#tab-instances/config/${e}/${x}`,t=s||"_self"):(n=`#tab-instances/config/${e}`,t=s||"_self"),t==="_self"?setTimeout(r=>{r.startsWith("#")?window.location.hash=r:r.startsWith("/")?n=`${window.location.protocol}:${window.location.host}${n}`:(r.startsWith("http://")||r.startsWith("https://"))&&(window.location.href=r)},100,n):(n.startsWith("#")?n=`${window.location.protocol}:${window.location.host}${window.location.pathname}${n}`:n.startsWith("/")&&(n=`${window.location.protocol}:${window.location.host}${n}`),window.open(n,t))}class Ds extends d{renderItem(s,e){if(this.props.schema.button){const n=this.getIcon();return i().createElement(l.Button,{variant:this.props.schema.variant||void 0,color:this.props.schema.color||"grey",style:Y(Y({},Fn.fullWidth),this.props.schema.controlStyle||void 0),disabled:e,startIcon:n,onClick:this.props.schema.href?()=>{const r=this.props.schema.href?this.getText(this.props.schema.href,!0):null;r&&(this.props.onBackEndCommand?this.props.onBackEndCommand({command:"link",url:r,target:this.props.schema.target,close:this.props.schema.close}):An(r,this.props.schema.target,`${this.props.adapterName}.${this.props.instance}`))}:null},this.getText(this.props.schema.text||this.props.schema.label,this.props.schema.noTranslation))}let t=this.getText(this.props.schema.text||this.props.schema.label,this.props.schema.noTranslation);return t&&(t.includes("<a ")||t.includes("<br")||t.includes("<b>")||t.includes("<i>"))&&(t=c.Utils.renderTextWithA(t)),i().createElement(l.Box,{component:"span",style:Y({},this.props.schema.controlStyle||void 0),sx:this.props.schema.href?Fn.link:void 0,onClick:this.props.schema.href?()=>{const n=this.props.schema.href?this.getText(this.props.schema.href,!0):null;n&&(this.props.onBackEndCommand?this.props.onBackEndCommand({command:"link",url:n,target:this.props.schema.target||"_blank",close:this.props.schema.close}):An(n,this.props.schema.target||"_blank",`${this.props.adapterName}.${this.props.instance}`))}:null},t)}}const Sn=Ds,hn=1024*1024,Fe={fullWidth:{width:"100%"},root:{width:"100%"},paper:{width:"100%",marginBottom:16,backgroundColor:"rgba(255, 255, 255, 0.1)"},headerText:{width:"100%"},table:{minWidth:750},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1},label:{display:"flex",justifyContent:"space-between"},title:{flex:"1 1 100%"},rootTool:{paddingLeft:16,paddingRight:8},silver:{opacity:.2},flex:{display:"flex",alignItems:"baseline"},filteredOut:{padding:10,display:"flex",textAlign:"center"},buttonEmpty:{width:34,display:"inline-block"},buttonCell:{whiteSpace:"nowrap"},dropZone:{width:"100%",height:100,position:"relative"},dropZoneEmpty:{},uploadDiv:{position:"relative",width:"100%",minHeight:300,opacity:.9,marginTop:30,cursor:"pointer",outline:"none"},uploadDivDragging:{opacity:1,background:"rgba(128,255,128,0.1)"},image:{objectFit:"contain",margin:"auto",display:"flex",width:"100%",height:"100%"},uploadCenterDiv:{margin:5,border:"3px dashed grey",borderRadius:5,width:"calc(100% - 10px)",height:"calc(100% - 10px)",minHeight:300,position:"relative",display:"flex"},uploadCenterIcon:{paddingTop:10,width:48,height:48},uploadCenterText:{fontSize:16},uploadCenterTextAndIcon:{textAlign:"center",position:"absolute",top:0,bottom:0,left:0,right:0,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},buttonRemoveWrapper:{position:"absolute",zIndex:222,right:0},error:{border:"2px solid red",boxSizing:"border-box"},tooltip:{pointerEvents:"none"}};function vs(x,s,e){s=s||"key";const t=[];return Object.keys(x).forEach(n=>{const r={};r[s]=n,e?(r[e]=x[n],t.push(r)):t.push(Object.assign(r,x[n]))}),t}function Tn(x,s,e){s=s||"key";const t={};return x.forEach(n=>{let r=n[s];r==null&&(r=""),delete n[s],e?t[r]=n[e]:t[r]=n}),t}function Cs(x,s){let e="";for(let t=0;t<s.length;t++)e+=String.fromCharCode(x[t%x.length].charCodeAt(0)^s.charCodeAt(t));return e}function ys(x,s){let e="";for(let t=0;t<s.length;t++)e+=String.fromCharCode(x[t%x.length].charCodeAt(0)^s.charCodeAt(t));return e}class He extends d{constructor(e){super(e);X(this,"filterRefs");X(this,"typingTimer",null);X(this,"secret","Zgfr56gFe87jJOM");X(this,"handleRequestSort",(e,t=!1)=>{const{order:n,orderBy:r}=this.state;if(r){const a=t?n:r===e&&n==="asc"?"desc":"asc",h=this.stableSort(a,e);this.setState({order:a,orderBy:e,iteration:this.state.iteration+1e4},()=>this.applyFilter(!1,h))}});X(this,"stableSort",(e,t)=>{const{value:n}=this.state,r=He.getComparator(e,t),o=n.map((a,h)=>({el:a,index:h}));return o.sort((a,h)=>{const I=r(a.el,h.el);return I!==0?I:a.index-h.index}),o.map(a=>a.el)});X(this,"onDelete",e=>()=>{const t=JSON.parse(JSON.stringify(this.state.value));t.splice(e,1),this.setState({value:t,iteration:this.state.iteration+1e4},()=>this.applyFilter(!1,null,()=>this.onChangeWrapper(t)))});X(this,"onClone",e=>()=>{const t=JSON.parse(JSON.stringify(this.state.value)),n=JSON.parse(JSON.stringify(t[e]));if(typeof this.props.schema.clone=="string"&&typeof n[this.props.schema.clone]=="string"){let r=1,o=n[this.props.schema.clone];const a=o.match(/(\d+)$/);for(a?(o=o.replace(a[0],""),r=parseInt(a[0],10)+1):o+="_";t.find(h=>h[this.props.schema.clone]===o+r.toString());)r++;n[this.props.schema.clone]=`${n[this.props.schema.clone]}_${r}`}t.splice(e,0,n),this.setState({value:t,iteration:this.state.iteration+1e4},()=>this.applyFilter(!1,null,()=>this.onChangeWrapper(t)))});X(this,"onChangeWrapper",(e,t)=>{this.typingTimer&&clearTimeout(this.typingTimer),this.typingTimer=setTimeout((n,r)=>{this.typingTimer=null;let o;if(this.props.schema.encryptedAttributes){const a=JSON.parse(JSON.stringify(n));if(a.forEach(h=>{this.props.schema.encryptedAttributes.forEach(I=>{h[I]&&(h[I]=Cs(this.secret,h[I]))})}),this.props.schema.objKeyName){const h=Tn(a,this.props.schema.objKeyName,this.props.schema.objValueName);o=this.onChange(this.props.attr,h)}else o=this.onChange(this.props.attr,a)}else if(this.props.schema.objKeyName){const a=Tn(JSON.parse(JSON.stringify(n)),this.props.schema.objKeyName,this.props.schema.objValueName);o=this.onChange(this.props.attr,a)}else o=this.onChange(this.props.attr,n);o instanceof Promise&&o.catch(a=>console.error(`Cannot save: ${a}`)),r&&(this.applyFilter(!1,n),this.handleRequestSort(this.state.orderBy,!0))},300,e,t)});X(this,"onAdd",()=>{var r;const{schema:e}=this.props,t=JSON.parse(JSON.stringify(this.state.value)),n=(r=e.items)==null?void 0:r.reduce((o,a)=>{let h;return a.defaultFunc?this.props.custom?h=a.defaultFunc?this.executeCustom(a.defaultFunc,this.props.data,this.props.customObj,this.props.instanceObj,t.length,this.props.data):this.props.schema.default:h=a.defaultFunc?this.execute(a.defaultFunc,this.props.schema.default,this.props.data,t.length,this.props.data):this.props.schema.default:h=a.default===void 0?null:a.default,o[a.attr]=h,o},{});t.push(n),this.setState({value:t},()=>this.applyFilter(!1,null,()=>this.onChangeWrapper(t)))});X(this,"applyFilter",(e,t,n)=>{t=t||this.state.value;let r=t.map((o,a)=>a);if(Object.keys(this.filterRefs).forEach(o=>{let a=He.getFilterValue(this.filterRefs[o]);!e&&a?(a=a.toLowerCase(),r=r.filter(h=>t[h]&&t[h][o]&&t[h][o].toLowerCase().includes(a))):this.filterRefs[o].current&&He.setFilterValue(this.filterRefs[o],"")}),r.length===t.length&&(r=null),r===null&&this.state.visibleValue===null){n&&n();return}JSON.stringify(r)!==JSON.stringify(this.state.visibleValue)?this.setState({visibleValue:r},()=>n&&n()):n&&n()});this.filterRefs={},this.props.schema.items=this.props.schema.items||[],this.props.schema.items.forEach(t=>{t.filter&&(this.filterRefs[t.attr]=(0,A.createRef)())})}componentDidMount(){return pe(this,null,function*(){st(He.prototype,this,"componentDidMount").call(this);const e=d.getValue(this.props.data,this.props.attr)||[];let t;if(this.props.schema.objKeyName?t=vs(e,this.props.schema.objKeyName,this.props.schema.objValueName):t=e,Array.isArray(t)||(t=[]),this.props.schema.encryptedAttributes){const n=yield this.props.socket.getCompactSystemConfig();this.secret=(n==null?void 0:n.native.secret)||this.secret,e.forEach(r=>{this.props.schema.encryptedAttributes.forEach(o=>{r[o]&&(r[o]=ys(this.secret,r[o]))})})}this.setState({value:t,visibleValue:null,orderBy:"",order:"asc",iteration:0,filterOn:[]},()=>this.validateUniqueProps())})}componentWillUnmount(){this.typingTimer&&(clearTimeout(this.typingTimer),this.typingTimer=null),super.componentWillUnmount()}itemTable(e,t,n){const{schema:r}=this.props,o=r.items&&r.items.find(h=>h.attr===e);if(!o)return null;const a={items:{[e]:o}};return i().createElement(Lt,{index:n+this.state.iteration,arrayIndex:n,changed:this.props.changed,globalData:this.props.data,socket:this.props.socket,adapterName:this.props.adapterName,instance:this.props.instance,common:this.props.common,alive:this.props.alive,themeType:this.props.themeType,themeName:this.props.themeName,data:t,table:!0,custom:!0,schema:a,systemConfig:this.props.systemConfig,dateFormat:this.props.dateFormat,isFloatComma:this.props.isFloatComma,imagePrefix:this.props.imagePrefix,onCommandRunning:this.props.onCommandRunning,forceUpdate:this.props.forceUpdate,originalData:this.props.originalData,customs:this.props.customs,theme:this.props.theme,DeviceManager:this.props.DeviceManager,onChange:(h,I)=>{const O=JSON.parse(JSON.stringify(this.state.value));O[n][h]=I,this.setState({value:O},()=>{this.validateUniqueProps(),this.onChangeWrapper(O,!0)})},onError:(h,I)=>this.onError(h,I),onBackEndCommand:this.props.onBackEndCommand})}validateUniqueProps(){if(this.props.schema.uniqueColumns)for(const e of this.props.schema.uniqueColumns){const t=[];this.state.value.find(r=>{const o=r[e];return t.includes(o)?(this.onError(e,"is not unique"),this.setState({errorMessage:c.I18n.t('Non-allowed duplicate entry "%s" in column "%s"',o,e)}),!0):(t.push(o),!1)})||(this.onError(e,null),this.setState({errorMessage:""}))}}static descendingComparator(e,t,n){return t[n]<e[n]?-1:t[n]>e[n]?1:0}static getComparator(e,t){return e==="desc"?(n,r)=>He.descendingComparator(n,r,t):(n,r)=>-He.descendingComparator(n,r,t)}static getFilterValue(e){var t,n,r;return(r=(n=(t=e==null?void 0:e.current)==null?void 0:t.children[0])==null?void 0:n.children[0])==null?void 0:r.value}static setFilterValue(e,t){return e.current.children[0].children[0].value=t}enhancedTableHead(e,t){const{schema:n}=this.props,{order:r,orderBy:o}=this.state;return i().createElement(l.TableHead,null,i().createElement(l.TableRow,null,n.items&&n.items.map((a,h)=>i().createElement(l.TableCell,{style:{width:(typeof a.width=="string"&&a.width.endsWith("%"),a.width)},key:`${a.attr}_${h}`,align:"left",sortDirection:o===a.attr?r:!1},i().createElement("div",{style:Y(Y({},Fe.flex),n.showFirstAddOnTop?{flexDirection:"column"}:void 0)},!h&&!n.noDelete?i().createElement(l.Tooltip,{title:t?c.I18n.t("ra_Cannot add items with set filter"):c.I18n.t("ra_Add row"),slotProps:{popper:{sx:Fe.tooltip}}},i().createElement("span",null,i().createElement(l.IconButton,{size:"small",color:"primary",disabled:!!t&&!this.props.schema.allowAddByFilter,onClick:this.onAdd},i().createElement(u.Add,null)))):null,a.sort&&i().createElement(l.TableSortLabel,{active:!0,style:o!==a.attr?Fe.silver:void 0,direction:o===a.attr?r:"asc",onClick:()=>this.handleRequestSort(a.attr)}),a.filter&&this.state.filterOn.includes(a.attr)?i().createElement(l.TextField,{variant:"standard",ref:this.filterRefs[a.attr],onChange:()=>this.applyFilter(),title:c.I18n.t("ra_You can filter entries by entering here some text"),slotProps:{input:{endAdornment:He.getFilterValue(this.filterRefs[a.attr])&&i().createElement(l.InputAdornment,{position:"end"},i().createElement(l.IconButton,{size:"small",onClick:()=>{He.setFilterValue(this.filterRefs[a.attr],""),this.applyFilter()}},i().createElement(u.Close,null)))}},fullWidth:!0,placeholder:this.getText(a.title)}):i().createElement("span",{style:Fe.headerText},this.getText(a.title)),a.filter?i().createElement(l.IconButton,{title:c.I18n.t("ra_Show/hide filter input"),size:"small",onClick:()=>{const I=[...this.state.filterOn],O=this.state.filterOn.indexOf(a.attr);O===-1?I.push(a.attr):I.splice(O,1),this.setState({filterOn:I},()=>{O&&He.getFilterValue(this.filterRefs[a.attr])&&(He.setFilterValue(this.filterRefs[a.attr],""),this.applyFilter())})}},this.state.filterOn.includes(a.attr)?i().createElement(u.FilterAltOff,null):i().createElement(u.FilterAlt,null)):null))),!n.noDelete&&i().createElement(l.TableCell,{style:{paddingLeft:20,paddingRight:20,width:e,textAlign:"right"},padding:"checkbox"},n.import?i().createElement(l.IconButton,{style:{marginRight:10},size:"small",onClick:()=>this.setState({showImportDialog:!0}),title:c.I18n.t("ra_import data from %s file","CSV")},i().createElement(u.UploadFile,null)):null,n.export?i().createElement(l.IconButton,{style:{marginRight:10},size:"small",onClick:()=>this.onExport(),title:c.I18n.t("ra_Export data to %s file","CSV")},i().createElement(u.Download,null)):null,i().createElement(l.IconButton,{disabled:!0,size:"small"},i().createElement(u.Delete,null)))))}onExport(){const{schema:e}=this.props,{value:t}=this.state,r=[e.items.map(h=>h.attr).join(";")];t.forEach(h=>{const I=[];e.items.forEach(O=>{var L;(L=h[O.attr])!=null&&L.includes(";")?I.push(`"${h[O.attr]}"`):I.push(h[O.attr]===void 0||h[O.attr]===null?"":h[O.attr])}),r.push(I.join(";"))});const o=document.createElement("a");o.setAttribute("href",`data:text/csv;charset=utf-8,${encodeURIComponent(r.join(`
`))}`);const a=new Date;o.setAttribute("download",`${a.getFullYear()}_${(a.getMonth()+1).toString().padStart(2,"0")}_${a.getDate().toString().padStart(2,"0")}_${this.props.adapterName}.${this.props.instance}_${this.props.attr}.csv`),o.style.display="none",document.body.appendChild(o),o.click(),document.body.removeChild(o)}onImport(e){var a;const t=e.split(`
`).map(h=>h.replace("\r","").trim()),{schema:n}=this.props,r=t.shift().split(";").filter(h=>h&&n.items.find(I=>I.attr===h)),o=[];t.forEach(h=>{const I=h.split(";"),O={};for(let L=0;L<I.length;L++){let q=I[L];if(q.startsWith('"')){for(q=q.substring(1);L<I.length&&!q.endsWith('"');)q+=`;${I[++L]}`;q=q.substring(0,q.length-1)}let he=q;if(q==="true")he=!0;else if(q==="false")he=!1;else if(window.isFinite(q)){const Ee=this.props.schema.items.find(se=>se.attr===r[L]);Ee&&Ee.type==="number"?he=parseFloat(q):he=q}else he=q;O[r[L]]=he}o.push(O)}),o.length?(a=this.state.value)!=null&&a.length?this.setState({showTypeOfImportDialog:o,showImportDialog:!1}):this.setState({value:o,showImportDialog:!1}):window.alert("ra_No data found in file")}isAnyFilterSet(){return!!Object.keys(this.filterRefs).find(e=>He.getFilterValue(this.filterRefs[e]))}onMoveUp(e){const t=JSON.parse(JSON.stringify(this.state.value)),n=t[e];t.splice(e,1),t.splice(e-1,0,n),this.setState({value:t,iteration:this.state.iteration+1e4},()=>this.applyFilter(!1,null,()=>this.onChangeWrapper(t)))}onMoveDown(e){const t=JSON.parse(JSON.stringify(this.state.value)),n=t[e];t.splice(e,1),t.splice(e+1,0,n),this.setState({value:t,iteration:this.state.iteration+1e4},()=>this.applyFilter(!1,null,()=>this.onChangeWrapper(t)))}onDrop(e){const t=e[0],n=new FileReader;n.onabort=()=>console.log("file reading was aborted"),n.onerror=()=>console.log("file reading has failed"),n.onload=()=>{if(t.size>hn){window.alert(c.I18n.t("ra_File is too big. Max %sk allowed. Try use SVG.",Math.round(hn/1024)));return}const r=new Uint8Array(n.result).reduce((o,a)=>o+String.fromCharCode(a),"");this.onImport(r)},n.readAsArrayBuffer(t)}showTypeOfImportDialog(){return this.state.showTypeOfImportDialog?i().createElement(l.Dialog,{open:!0,onClose:()=>this.setState({showTypeOfImportDialog:!1}),maxWidth:"md"},i().createElement(l.DialogTitle,null,c.I18n.t("ra_Append or replace?")),i().createElement(l.DialogContent,null,c.I18n.t("ra_Append %s entries or replace existing?",this.state.showTypeOfImportDialog.length)),i().createElement(l.DialogActions,null,i().createElement(l.Button,{variant:"contained",color:"primary",autoFocus:!0,onClick:()=>{const e=JSON.parse(JSON.stringify(this.state.value));this.state.showTypeOfImportDialog.forEach(t=>e.push(t)),this.setState({value:e,iteration:this.state.iteration+1e4,showTypeOfImportDialog:!1},()=>this.applyFilter(!1,null,()=>this.onChangeWrapper(e)))}},c.I18n.t("ra_Append")),i().createElement(l.Button,{variant:"contained",color:"secondary",autoFocus:!0,onClick:()=>{const e=this.state.showTypeOfImportDialog;this.setState({value:e,iteration:this.state.iteration+1e4,showTypeOfImportDialog:!1},()=>this.applyFilter(!1,null,()=>this.onChangeWrapper(e)))}},c.I18n.t("ra_Replace")))):null}showImportDialog(){return this.state.showImportDialog?i().createElement(l.Dialog,{open:!0,onClose:()=>this.setState({showImportDialog:!1}),sx:{"& .MuiDialog-paper":{minHeight:500}},maxWidth:"md",fullWidth:!0},i().createElement(l.DialogTitle,null,c.I18n.t("ra_Import from %s","CSV")),i().createElement(l.DialogContent,null,i().createElement(Vt(),{multiple:!1,accept:{"text/csv":[".csv"]},maxSize:hn,onDragEnter:()=>this.setState({uploadFile:"dragging"}),onDragLeave:()=>this.setState({uploadFile:!0}),onDrop:(e,t)=>{this.setState({uploadFile:!1}),e.length?this.onDrop(e):window.alert(t&&t[0]&&t[0].errors&&t[0].errors[0]&&t[0].errors[0].message||c.I18n.t("ra_Cannot upload"))}},({getRootProps:e,getInputProps:t})=>i().createElement("div",Y({style:Y(Y(Y(Y({},Fe.uploadDiv),this.state.uploadFile==="dragging"?Fe.uploadDivDragging:void 0),Fe.dropZone),this.state.icon?void 0:Fe.dropZoneEmpty)},e()),i().createElement("input",Y({},t())),i().createElement("div",{style:Fe.uploadCenterDiv},i().createElement("div",{style:Fe.uploadCenterTextAndIcon},i().createElement(u.UploadFile,{style:Fe.uploadCenterIcon}),i().createElement("div",{style:Fe.uploadCenterText},this.state.uploadFile==="dragging"?c.I18n.t("ra_Drop file here"):c.I18n.t("ra_Place your files here or click here to open the browse dialog"))))))),i().createElement(l.DialogActions,null,i().createElement(l.Button,{variant:"contained",onClick:()=>this.setState({showImportDialog:!1}),color:"primary",startIcon:i().createElement(u.Close,null)},c.I18n.t("Cancel")))):null}renderItem(){const{schema:e}=this.props;let{visibleValue:t}=this.state;if(!this.state.value||!Array.isArray(this.state.value))return null;t=t||this.state.value.map((o,a)=>a);const n=this.isAnyFilterSet();let r;return this.props.schema.compact&&(r={paddingTop:1,paddingBottom:1}),i().createElement(l.Paper,{style:Fe.paper},this.showImportDialog(),this.showTypeOfImportDialog(),e.label?i().createElement("div",{style:Fe.label},i().createElement(l.Toolbar,{variant:"dense",style:Fe.rootTool},i().createElement(l.Typography,{style:Fe.title,variant:"h6",id:"tableTitle",component:"div"},this.getText(e.label)))):null,i().createElement(l.TableContainer,null,i().createElement(l.Table,{style:Fe.table,size:"small"},this.enhancedTableHead(!n&&!this.state.orderBy?120:64,n),i().createElement(l.TableBody,null,t.map((o,a)=>i().createElement(l.TableRow,{hover:!0,key:`${o}_${a}`},e.items&&e.items.map(h=>i().createElement(l.TableCell,{key:`${h.attr}_${o}`,align:"left",style:r},this.itemTable(h.attr,this.state.value[o],o))),!e.noDelete&&i().createElement(l.TableCell,{align:"left",style:Y(Y({},r),Fe.buttonCell)},!n&&!this.state.orderBy?a?i().createElement(l.Tooltip,{title:c.I18n.t("ra_Move up"),slotProps:{popper:{sx:Fe.tooltip}}},i().createElement(l.IconButton,{size:"small",onClick:()=>this.onMoveUp(o)},i().createElement(u.ArrowUpward,null))):i().createElement("div",{style:Fe.buttonEmpty}):null,!n&&!this.state.orderBy?a<t.length-1?i().createElement(l.Tooltip,{title:c.I18n.t("ra_Move down"),slotProps:{popper:{sx:Fe.tooltip}}},i().createElement(l.IconButton,{size:"small",onClick:()=>this.onMoveDown(o)},i().createElement(u.ArrowDownward,null))):i().createElement("div",{style:Fe.buttonEmpty}):null,i().createElement(l.Tooltip,{title:c.I18n.t("ra_Delete current row"),slotProps:{popper:{sx:Fe.tooltip}}},i().createElement(l.IconButton,{size:"small",onClick:this.onDelete(o)},i().createElement(u.Delete,null))),this.props.schema.clone?i().createElement(l.Tooltip,{title:c.I18n.t("ra_Clone current row"),slotProps:{popper:{sx:Fe.tooltip}}},i().createElement(l.IconButton,{size:"small",onClick:this.onClone(o)},i().createElement(u.ContentCopy,null))):null))),!e.noDelete&&t.length>=(e.showSecondAddAt||5)?i().createElement(l.TableRow,null,i().createElement(l.TableCell,{colSpan:e.items.length+1,style:Y({},r)},i().createElement(l.Tooltip,{title:n?c.I18n.t("ra_Cannot add items with set filter"):c.I18n.t("ra_Add row"),slotProps:{popper:{sx:Fe.tooltip}}},i().createElement("span",null,i().createElement(l.IconButton,{size:"small",color:"primary",disabled:!!n&&!this.props.schema.allowAddByFilter,onClick:this.onAdd},i().createElement(u.Add,null)))))):null)),!t.length&&this.state.value.length?i().createElement("div",{style:Fe.filteredOut},i().createElement(l.Typography,{style:Fe.title,variant:"h6",id:"tableTitle",component:"div"},c.I18n.t("ra_All items are filtered out"),i().createElement(l.IconButton,{size:"small",onClick:()=>this.applyFilter(!0)},i().createElement(u.Close,null)))):null),e.help?i().createElement(l.FormHelperText,null,this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)):null,this.state.errorMessage?i().createElement("div",{style:{display:"flex",padding:"5px"}},i().createElement(u.Warning,{color:"error"}),i().createElement("span",{style:{color:"red",alignSelf:"center"}},this.state.errorMessage)):null)}}const Es=He,Ut={indeterminate:{opacity:.5},label:{width:"100%",fontSize:16},helper:{width:"100%",fontSize:12},error:{width:"100%",fontSize:12,color:"#FF0000"}};class bs extends d{constructor(){super(...arguments);X(this,"updateTimeout",null)}componentDidMount(){super.componentDidMount();let e=d.getValue(this.props.data,this.props.attr);if(Array.isArray(e)&&this.props.multiEdit){e=d.DIFFERENT_VALUE,this.setState({value:e,oldValue:e,jsonError:!1});return}this.setState({value:e,oldValue:e,jsonError:this.validateJson(e)})}validateJson(e){let t=!1;if(this.props.schema.validateJson&&(e||!this.props.schema.allowEmpty))try{JSON.parse(e)}catch(n){console.log("Error in JSON",n),t=!0}return t}static getDerivedStateFromProps(e,t){if(e.multiEdit&&t.value===d.DIFFERENT_VALUE)return{value:d.DIFFERENT_VALUE};let n=d.getValue(e.data,e.attr);return n!=null&&(n=n.toString()),n==null||n!==t.value&&n!==t.oldValue?{value:n}:null}renderItem(e,t){const n=Array.isArray(this.state.value)||this.state.value===d.DIFFERENT_VALUE;if(this.props.schema.time){let r="";return typeof this.state.value=="number"?this.state.value&&this.state.value<9466596e5?r=new Date(this.state.value*1e3).toLocaleString():r=new Date(this.state.value).toLocaleString():typeof this.state.value=="string"&&(r=new Date(this.state.value).toLocaleString()),i().createElement(l.TextField,{variant:"standard",fullWidth:!0,value:r,error:!!e||!!this.state.jsonError,disabled:!!t,slotProps:{htmlInput:{readOnly:!0}},placeholder:this.getText(this.props.schema.placeholder),label:this.getText(this.props.schema.label),helperText:this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)})}if(this.state.oldValue!==null&&this.state.oldValue!==void 0?(this.updateTimeout&&clearTimeout(this.updateTimeout),this.updateTimeout=setTimeout(()=>{this.updateTimeout=null,this.setState({oldValue:null})},30)):this.updateTimeout&&(clearTimeout(this.updateTimeout),this.updateTimeout=null),n){const r=d.getValue(this.props.data,this.props.attr),o=(r==null?void 0:r.filter(a=>a||a===0).map(a=>({label:a.toString()||"",value:a})))||[];return o.unshift({label:c.I18n.t(d.DIFFERENT_LABEL),value:d.DIFFERENT_VALUE}),i().createElement(l.Autocomplete,{style:Ut.indeterminate,fullWidth:!0,value:o[0],onChange:(a,h)=>{const I=h?h.value:"",O=this.onChange(this.props.attr,I,()=>{this.setState({value:I,oldValue:I,jsonError:this.validateJson(h)})});O instanceof Promise&&O.catch(L=>console.error(`Cannot set value: ${L}`))},options:o,getOptionLabel:a=>a.label,renderInput:a=>i().createElement(l.TextField,$e(Y({variant:"standard"},a),{error:!!e,placeholder:this.getText(this.props.schema.placeholder),slotProps:{htmlInput:$e(Y({},a.inputProps),{maxLength:this.props.schema.maxLength||this.props.schema.max||void 0,readOnly:this.props.schema.readOnly||!1})},label:this.getText(this.props.schema.label),helperText:this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation),disabled:!!t}))})}if(this.props.schema.minRows>1){const r=this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation);return i().createElement("div",{style:{width:"100%"}},this.props.schema.label?i().createElement("div",{style:Ut.label},this.getText(this.props.schema.label)):null,i().createElement(l.TextareaAutosize,{style:{width:"100%",resize:"vertical",backgroundColor:this.props.themeType==="dark"?"#363636":"#cccccc",color:this.props.themeType==="dark"?"#fff":"#111"},minRows:this.props.schema.minRows,maxRows:this.props.schema.maxRows,value:this.state.value===null||this.state.value===void 0?"":this.state.value,disabled:!!t,readOnly:this.props.schema.readOnly||!1,onChange:o=>{const a=o.target.value;this.setState({value:a,oldValue:this.state.value,jsonError:this.validateJson(a)},()=>this.onChange(this.props.attr,a||""))},placeholder:this.getText(this.props.schema.placeholder)}),r||e||this.state.jsonError?i().createElement("div",{style:e?Ut.error:Ut.helper},e||(this.state.jsonError?c.I18n.t("ra_Invalid JSON"):r)):null)}return i().createElement(l.TextField,{variant:"standard",fullWidth:!0,value:this.state.value===null||this.state.value===void 0?"":this.state.value,error:!!e||!!this.state.jsonError,disabled:!!t,slotProps:{htmlInput:{maxLength:this.props.schema.maxLength||this.props.schema.max||void 0,readOnly:this.props.schema.readOnly||!1},input:{endAdornment:!this.props.schema.readOnly&&!t&&this.state.value&&!this.props.schema.noClearButton?i().createElement(l.InputAdornment,{position:"end"},i().createElement(l.IconButton,{size:"small",onClick:()=>this.setState({value:"",oldValue:this.state.value},()=>this.onChange(this.props.attr,""))},i().createElement(u.Close,null))):null}},onChange:r=>{const o=r.target.value;this.setState({value:o,oldValue:this.state.value,jsonError:this.validateJson(o)},()=>this.onChange(this.props.attr,o))},placeholder:this.getText(this.props.schema.placeholder),label:this.getText(this.props.schema.label),helperText:this.state.jsonError?c.I18n.t("ra_Invalid JSON"):this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)})}}const xs=bs,ws={fullWidth:{width:"100%"}};class Fs extends d{constructor(){super(...arguments);X(this,"initialized",!1);X(this,"_context")}askInstance(){if(this.props.alive){let e=this.props.schema.data;if(e===void 0&&this.props.schema.jsonData){const t=this.getPattern(this.props.schema.jsonData);try{e=JSON.parse(t)}catch(n){console.error(`Cannot parse json data: ${t}`)}}e===void 0&&(e=null),this.props.socket.sendTo(`${this.props.adapterName}.${this.props.instance}`,this.props.schema.command||"send",e).then(t=>{if(typeof t=="object"){const n=t;this.setState({text:n.text||"",style:n.style,icon:n.icon,iconStyle:n.iconStyle})}else typeof t=="string"&&this.setState({text:t||""})}).catch(t=>console.error(`Cannot send command: ${t}`))}}getContext(){const e={};return Array.isArray(this.props.schema.alsoDependsOn)&&this.props.schema.alsoDependsOn.forEach(t=>e[t]=d.getValue(this.props.data,t)),JSON.stringify(e)}renderItem(){if(this.props.alive){const t=this.getContext();(t!==this._context||!this.initialized)&&(this._context=t,setTimeout(()=>this.askInstance(),this.initialized?300:50),this.initialized=!0)}if(this.state.text===void 0)return null;let e=null;return this.state.icon&&(e=gt(this.state.icon,Y({marginRight:this.state.text?8:void 0},this.state.iconStyle||void 0)),e||(e=i().createElement(c.Icon,{src:this.state.icon,style:Y({marginRight:this.state.text?8:void 0},this.state.iconStyle||void 0)}))),this.props.schema.container==="text"?i().createElement(l.TextField,{variant:"standard",fullWidth:!0,slotProps:{input:{endAdornment:this.props.schema.copyToClipboard?i().createElement(l.IconButton,{size:"small",onClick:()=>{c.Utils.copyToClipboard(this.state.text),window.alert("Copied")}},i().createElement(c.IconCopy,null)):void 0}},value:this.state.text,label:this.getText(this.props.schema.label),helperText:this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)}):i().createElement("div",{style:Y(Y({},ws.fullWidth),this.state.style||void 0)},e,this.props.schema.container==="html"?i().createElement("span",{dangerouslySetInnerHTML:{__html:this.state.text||""}}):this.state.text)}}const As=Fs;class Ss extends d{componentDidMount(){super.componentDidMount();const s=d.getValue(this.props.data,this.props.attr);this.setState({value:s})}renderItem(s,e){const t=this.props.schema.returnFormat!=="HH:mm:ss",n=new Date(Date.parse(`Thu, 01 Jan 1970 ${this.state.value||"00:00:00"}`));return i().createElement(Ke.TimePicker,{sx:r=>({width:"100%",borderBottom:`1px solid ${r.palette.text.primary}`,"& fieldset":{display:"none"},"& input":{padding:`${r.spacing(1.5)} 0 4px 0`},"& .MuiInputAdornment-root":{marginLeft:0,marginTop:1},"& label":{transform:"translate(0px, -9px) scale(0.75)"}}),ampm:this.props.systemConfig.dateFormat.includes("/"),timeSteps:this.props.schema.timeSteps||this.props.schema.timesteps||{hours:1,minutes:5,seconds:5},format:this.props.schema.format||"HH:mm:ss",disabled:!!e,value:n,onChange:r=>{let o;o=r instanceof Date?r.toTimeString().split(" ")[0]:r.toTimeString(),t&&(o=o.split(":").slice(0,2).join(":")),this.setState({value:o},()=>this.onChange(this.props.attr,this.state.value))},views:this.props.schema.views||["hours","minutes","seconds"],label:this.getText(this.props.schema.label)})}}function Ts(x,s){let e;return s&&x.substring(0,s.length)===s?e=x.substring(s.length+1):e=x,e=e.replace(/\./g,"/").replace(/_/g," "),e}class Is extends d{componentDidMount(){var e;super.componentDidMount();const s=d.getValue(this.props.data,this.props.attr);if(!s&&((e=this.props.customObj)!=null&&e._id)){const t=Ts(this.props.customObj._id,`${this.props.adapterName}.${this.props.instance}`);this.setState({value:t})}else this.setState({value:s||""})}renderItem(s,e){return i().createElement(l.TextField,{variant:"standard",fullWidth:!0,slotProps:{htmlInput:{maxLength:this.props.schema.maxLength||this.props.schema.max||void 0}},value:this.state.value,error:!!s,disabled:e,placeholder:this.getText(this.props.schema.placeholder),label:this.getText(this.props.schema.label),helperText:this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation),onChange:t=>{const n=t.target.value;this.setState({value:n},()=>this.onChange(this.props.attr,n))}})}}const _s=Is;class pn extends d{componentDidMount(){return pe(this,null,function*(){var e;st(pn.prototype,this,"componentDidMount").call(this);const s=yield this.props.socket.getObject("system.meta.uuid");this.setState({uuid:((e=s==null?void 0:s.native)==null?void 0:e.uuid)||"unknown"})})}renderItem(s,e){return i().createElement(l.TextField,{variant:"standard",fullWidth:!0,error:!!s,disabled:!!e,slotProps:{htmlInput:{readOnly:!0},input:{endAdornment:i().createElement(l.IconButton,{onClick:()=>{c.Utils.copyToClipboard(this.state.uuid),window.alert(c.I18n.t("ra_Copied %s",this.state.uuid))}},i().createElement(u.ContentCopy,null))}},value:this.state.uuid||"",label:this.getText(this.props.schema.label)||c.I18n.t("ra_Serial number (UUID)"),helperText:this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)})}}const ks=pn,In={icon:{width:16,height:16,marginRight:8}};class Bs extends d{componentDidMount(){super.componentDidMount(),this.props.socket.getUsers().then(s=>{const e={},t=c.I18n.getLanguage();this.props.schema.short?s.forEach(n=>{var r,o;return e[n._id]={color:(r=n.common)==null?void 0:r.color,icon:(o=n.common)==null?void 0:o.icon,name:c.Utils.getObjectNameFromObj(n,t)}}):s.forEach(n=>{var r,o;return e[n._id.replace(/^system\.user\./,"")]={color:(r=n.common)==null?void 0:r.color,icon:(o=n.common)==null?void 0:o.icon,name:c.Utils.getObjectNameFromObj(n,t)}}),this.setState({users:e})}).catch(s=>console.error(`Cannot get users: ${s}`))}renderItem(s,e){var n,r;const t=d.getValue(this.props.data,this.props.attr);return i().createElement(l.FormControl,{variant:"standard",fullWidth:!0},this.state.users&&this.props.schema.label?i().createElement(l.InputLabel,null,this.getText(this.props.schema.label)):null,this.state.users?i().createElement(l.Select,{variant:"standard",error:!!s,disabled:!!e,value:t,renderValue:o=>{var a,h,I;return i().createElement("span",null,this.state.users&&((a=this.state.users[o])!=null&&a.icon)?i().createElement(c.Icon,{src:this.state.users&&((h=this.state.users[o])==null?void 0:h.icon),style:In.icon}):null,this.state.users&&((I=this.state.users[o])==null?void 0:I.name)||o||"")},style:{color:this.state.users&&((n=this.state.users[t])==null?void 0:n.color)||void 0,backgroundColor:c.Utils.getInvertedColor(this.state.users&&((r=this.state.users[t])==null?void 0:r.color),this.props.themeType)},onChange:o=>this.onChange(this.props.attr,o.target.value)},this.state.users&&Object.keys(this.state.users).map(o=>i().createElement(l.MenuItem,{style:{color:this.state.users[o].color||void 0,backgroundColor:c.Utils.getInvertedColor(this.state.users[o].color,this.props.themeType)},key:o,value:o},this.state.users[o].icon?i().createElement(c.Icon,{src:this.state.users[o].icon,style:In.icon}):null,this.state.users[o].name))):i().createElement(l.TextField,{variant:"standard",error:!!s,disabled:!!e,value:t,onChange:o=>this.onChange(this.props.attr,o.target.value),label:this.getText(this.props.schema.label)}),this.props.schema.help?i().createElement(l.FormHelperText,null,this.renderHelp(this.props.schema.help,this.props.schema.helpLink,this.props.schema.noTranslation)):null)}}const Os=Bs;class dn extends d{componentDidMount(){return pe(this,null,function*(){st(dn.prototype,this,"componentDidMount").call(this);const s=yield G.e("vendors-node_modules_react-qr-code_lib_index_js").then(G.bind(G,732));this.setState({QRCode:s.default})})}renderItem(){const s=this.state.QRCode;return s?i().createElement(s,{value:this.props.schema.data,size:this.props.schema.size,fgColor:this.props.schema.fgColor,bgColor:this.props.schema.bgColor,level:this.props.schema.level}):null}}const $s={accordion:g,alive:E,autocomplete:B,autocompleteSendTo:F,certCollection:K,certificate:ce,certificates:z,checkbox:Ie,checkLicense:ke,chip:wt,chips:wt,color:Ot,coordinates:Ct,cron:re,custom:Ft,datePicker:U,deviceManager:xe,divider:ps,file:$,fileSelector:Wt,func:ne,header:ms,image:ot,imageSendTo:Me,instance:Ge,interface:It,ip:De,jsonEditor:Nn,language:Rn,license:Vn,number:Un,objectId:jn,password:zn,pattern:Gn,port:Yn,qrCode:dn,room:Zn,select:ts,selectSendTo:is,sendto:bn,sendTo:bn,setState:as,slider:us,state:cs,staticImage:gs,staticLink:Sn,staticText:Sn,table:Es,text:xs,textSendTo:As,timePicker:Ss,topic:_s,uuid:ks,user:Os},tt={fullWidth:{width:"100%"},paper:{margin:1,width:"auto !important",overflowY:"auto",paddingBottom:1},paperWithIcons:{height:"calc(100vh - 259px) !important"},paperWithoutIcons:{height:"calc(100vh - 235px) !important"},padding:{padding:"10px"},heading:{},primary:x=>({backgroundColor:x.palette.primary.main,color:x.palette.mode==="dark"?"inherit":"#FFF"}),secondary:x=>({backgroundColor:x.palette.secondary.main})};class mn extends d{componentDidMount(){super.componentDidMount(),this.props.schema&&this.props.schema.collapsable&&this.setState({expanded:(window._localStorage||window.localStorage).getItem(`${this.props.adapterName}.${this.props.attr}`)==="true"})}renderItems(s,e){return s?Object.keys(s).map(t=>{if(this.props.multiEdit&&s[t].noMultiEdit)return null;const n=s[t].type||"panel";let r;return n==="custom"?s[t].url?r=Ft:this.props.customs&&this.props.customs[s[t].component]?r=this.props.customs[s[t].component]:(console.error(`Cannot find custom component: ${s[t].component}`),r=d):n==="panel"?r=mn:r=$s[n]||d,i().createElement(r,{key:`${t}_${this.props.index===void 0?"":this.props.index}`,index:this.props.index,changed:this.props.changed,arrayIndex:this.props.arrayIndex,globalData:this.props.globalData,onCommandRunning:this.props.onCommandRunning,commandRunning:this.props.commandRunning,style:tt.panel,socket:this.props.socket,adapterName:this.props.adapterName,instance:this.props.instance,common:this.props.common,customs:this.props.customs,alive:this.props.alive,themeType:this.props.themeType,themeName:this.props.themeName,theme:this.props.theme,data:this.props.data,originalData:this.props.originalData,systemConfig:this.props.systemConfig,onError:this.props.onError,onChange:this.props.onChange,onBackEndCommand:this.props.onBackEndCommand,multiEdit:this.props.multiEdit,dateFormat:this.props.dateFormat,isFloatComma:this.props.isFloatComma,disabled:e,imagePrefix:this.props.imagePrefix,changeLanguage:this.props.changeLanguage,forceUpdate:this.props.forceUpdate,registerOnForceUpdate:this.props.registerOnForceUpdate,customObj:this.props.customObj,instanceObj:this.props.instanceObj,custom:this.props.custom,schema:s[t],DeviceManager:this.props.DeviceManager,attr:t,table:this.props.table})}):null}render(){const s=this.props.schema;if(!s)return null;const{disabled:e,hidden:t}=this.calculate(s),n=this.props.schema.items,r=this.props.schema.style||{};if(t){if(s.hideOnlyControl){const a=i().createElement(l.Grid2,{size:{xs:s.xs||void 0,sm:s.sm||void 0,md:s.md||void 0,lg:s.lg||void 0,xl:s.xl||void 0},sx:te.getStyle(this.props.theme,{marginBottom:0,textAlign:"left"},r,this.props.themeType==="dark"&&s.darkStyle)});return s.newLine?i().createElement(i().Fragment,null,i().createElement("div",{style:{flexBasis:"100%",height:0}}),a):a}return null}if(this.props.table)return this.renderItems(n,e);if(this.props.custom)return i().createElement(l.Grid2,{key:`${this.props.attr}_${this.props.index}`,container:!0,style:tt.fullWidth,columnSpacing:2,rowSpacing:1,sx:r},this.renderItems(n,e));let o;if(s.collapsable?o=i().createElement(l.Accordion,{key:`${this.props.attr}_${this.props.index}`,style:tt.fullWidth,expanded:!!this.state.expanded,onChange:()=>{(window._localStorage||window.localStorage).setItem(`${this.props.adapterName}.${this.props.attr}`,this.state.expanded?"false":"true"),this.setState({expanded:!this.state.expanded})}},i().createElement(l.AccordionSummary,{expandIcon:i().createElement(u.ExpandMore,null),sx:te.getStyle(this.props.theme,r,this.props.themeType&&s.darkStyle,s.color==="primary"?tt.primary:s.color==="secondary"&&tt.secondary,{width:"100%"})},i().createElement(l.Typography,{style:tt.heading},this.getText(s.label))),i().createElement(l.AccordionDetails,null,i().createElement(l.Grid2,{container:!0,columnSpacing:2,rowSpacing:1,sx:$e(Y({},r),{width:"100%",padding:"10px"})},this.renderItems(n,e)))):o=i().createElement(l.Box,{component:"div",key:`${this.props.attr}_${this.props.index}`,className:this.props.className,sx:te.getStyle(this.props.theme,this.props.style,r,{width:"100%"},this.props.isParentTab&&tt.paper,this.props.isParentTab&&(this.props.withIcons?tt.paperWithIcons:tt.paperWithoutIcons))},i().createElement(l.Grid2,{container:!0,columnSpacing:2,rowSpacing:1,sx:te.getStyle(this.props.theme,{width:"100%"},this.props.isParentTab&&tt.padding,this.props.schema.innerStyle)},this.renderItems(n,e))),!this.props.isParentTab){const a=i().createElement(l.Grid2,{title:this.getText(s.tooltip),size:{xs:s.xs||void 0,sm:s.sm||void 0,md:s.md||void 0,lg:s.lg||void 0,xl:s.xl||void 0},sx:Y({marginBottom:0,textAlign:"left"},r)},o);return s.newLine?i().createElement(i().Fragment,null,i().createElement("div",{style:{flexBasis:"100%",height:0}}),a):a}return o}}const Lt=mn,Jt={tabs:{height:"100%",width:"100%"},panel:{width:"100%",display:"block"},panelWithIcons:{height:"calc(100% - 72px)"},panelWithoutIcons:{height:"calc(100% - 48px)"}};class Ns extends d{constructor(e){super(e);X(this,"onHashTabsChanged",()=>{const e=(window.location.hash||"").replace(/^#/,"").split("/");if(e.length>3&&e[1]==="config"){const t=e[3],n=parseInt(t,10);let r;n.toString()===t?n>=0&&n<Object.keys(this.props.schema.items).length&&(r=Object.keys(this.props.schema.items)[n]):Object.keys(this.props.schema.items).includes(t)&&(r=t),r!==void 0&&r!==this.state.tab&&((window._localStorage||window.localStorage).setItem(`${this.props.dialogName||"App"}.${this.props.adapterName}`,r),this.setState({tab:r}))}});let t;if(this.props.root){const n=(window.location.hash||"").replace(/^#/,"").split("/");if(n.length>=3&&n[1]==="config"){const r=n[3],o=parseInt(r,10);r&&o.toString()===r?o>=0&&o<Object.keys(this.props.schema.items).length&&(t=Object.keys(this.props.schema.items)[o]):r&&Object.keys(this.props.schema.items).includes(r)&&(t=r),window.addEventListener("hashchange",this.onHashTabsChanged,!1)}}t===void 0&&(t=(window._localStorage||window.localStorage).getItem(`${this.props.dialogName||"App"}.${this.props.adapterName}`)||Object.keys(this.props.schema.items)[0],Object.keys(this.props.schema.items).includes(t)||(t=Object.keys(this.props.schema.items)[0])),Object.assign(this.state,{tab:t})}componentWillUnmount(){window.removeEventListener("hashchange",this.onHashTabsChanged,!1),super.componentWillUnmount()}render(){const e=this.props.schema.items;let t=!1;return i().createElement("div",{style:Jt.tabs},i().createElement(l.Tabs,{variant:"scrollable",scrollButtons:"auto",style:this.props.schema.tabsStyle,value:this.state.tab,onChange:(n,r)=>{(window._localStorage||window.localStorage).setItem(`${this.props.dialogName||"App"}.${this.props.adapterName}`,r),this.setState({tab:r},()=>{if(this.props.root){const o=(window.location.hash||"").split("/");o.length>=3&&o[1]==="config"&&(o[3]=this.state.tab,window.location.hash=o.join("/"))}})}},Object.keys(e).map(n=>{let r;if(this.props.custom){if(this.executeCustom(e[n].hidden,this.props.data,this.props.customObj,this.props.instanceObj,this.props.index,this.props.globalData))return null;r=this.executeCustom(e[n].disabled,this.props.data,this.props.customObj,this.props.instanceObj,this.props.index,this.props.globalData)}else{if(this.execute(e[n].hidden,!1,this.props.data,this.props.index,this.props.globalData))return null;r=this.execute(e[n].disabled,!1,this.props.data,this.props.index,this.props.globalData)}const o=this.getIcon(e[n].icon);return t=t||!!o,i().createElement(l.Tab,{id:n,wrapped:!0,disabled:r,key:n,value:n,iconPosition:this.props.schema.iconPosition||"start",icon:o,label:this.getText(e[n].label)})})),i().createElement(Lt,{isParentTab:!0,changed:this.props.changed,key:this.state.tab,index:1001,arrayIndex:this.props.arrayIndex,globalData:this.props.globalData,onCommandRunning:this.props.onCommandRunning,commandRunning:this.props.commandRunning,style:Y(Y({},Jt.panel),t?Jt.panelWithIcons:Jt.panelWithoutIcons),socket:this.props.socket,adapterName:this.props.adapterName,instance:this.props.instance,common:this.props.common,customs:this.props.customs,alive:this.props.alive,themeType:this.props.themeType,themeName:this.props.themeName,data:this.props.data,originalData:this.props.originalData,systemConfig:this.props.systemConfig,onChange:this.props.onChange,onError:this.props.onError,onBackEndCommand:this.props.onBackEndCommand,multiEdit:this.props.multiEdit,dateFormat:this.props.dateFormat,isFloatComma:this.props.isFloatComma,imagePrefix:this.props.imagePrefix,changeLanguage:this.props.changeLanguage,forceUpdate:this.props.forceUpdate,registerOnForceUpdate:this.props.registerOnForceUpdate,customObj:this.props.customObj,instanceObj:this.props.instanceObj,custom:this.props.custom,schema:e[this.state.tab],table:this.props.table,theme:this.props.theme,DeviceManager:this.props.DeviceManager,withIcons:t}))}}const Ls=Ns,Ps={root:{width:"100%",height:"100%"}};class Rs extends A.Component{constructor(e){super(e);X(this,"forceUpdateHandlers");X(this,"errorTimeout",null);X(this,"errorCached",null);X(this,"onCommandRunning",e=>this.setState({commandRunning:e}));X(this,"onAlive",(e,t)=>{!!(t!=null&&t.val)!==this.state.alive&&this.setState({alive:!!(t!=null&&t.val)})});X(this,"onChange",(e,t,n,r)=>{if(this.props.onValueChange)this.props.onValueChange(e,t,r),n&&n();else if(e&&this.props.onChange){const o={changed:JSON.stringify(e)!==this.state.originalData};this.setState(o,()=>{this.props.onChange(e,o.changed,r),n&&n()})}else r&&this.props.onChange(null,null,r)});X(this,"onError",(e,t)=>{this.errorCached=this.errorCached||JSON.parse(JSON.stringify(this.state.errors));const n=this.errorCached;t?n[e]=t:delete n[e],this.errorTimeout&&clearTimeout(this.errorTimeout),JSON.stringify(n)!==JSON.stringify(this.state.errors)?this.errorTimeout=setTimeout(()=>this.setState({errors:this.errorCached},()=>{this.errorTimeout=null,this.errorCached=null,this.props.onError(!!Object.keys(this.state.errors).length)}),50):this.errorCached=null});X(this,"changeLanguage",()=>{this.forceUpdate()});X(this,"forceAttrUpdate",(e,t)=>{Array.isArray(e)?e.forEach(n=>this.forceUpdateHandlers[n]&&this.forceUpdateHandlers[n](t)):this.forceUpdateHandlers[e]&&this.forceUpdateHandlers[e](t)});X(this,"registerOnForceUpdate",(e,t)=>{t?this.forceUpdateHandlers[e]=t:this.forceUpdateHandlers[e]&&delete this.forceUpdateHandlers[e]});this.state={originalData:JSON.stringify(this.props.data),changed:!1,errors:{},updateData:this.props.updateData||0,systemConfig:null,alive:!1,commandRunning:!1,schema:JSON.parse(JSON.stringify(this.props.schema))},this.forceUpdateHandlers={},this.buildDependencies(this.state.schema),this.readData()}static getDerivedStateFromProps(e,t){return e.updateData!==t.updateData?{updateData:e.updateData,originalData:JSON.stringify(e.data),schema:JSON.parse(JSON.stringify(e.schema))}:null}static loadI18n(e,t,n){return pe(this,null,function*(){if(t===!0||t&&typeof t=="string"){const r=c.I18n.getLanguage(),o=typeof t=="string"?t:"i18n";let a=yield e.fileExists(`${n}.admin`,`${o}/${r}.json`),h;if(a?h=`${o}/${r}.json`:(a=yield e.fileExists(`${n}.admin`,`${o}/${r}/translations.json`),a?h=`${o}/${r}/translations.json`:r!=="en"&&(a=yield e.fileExists(`${n}.admin`,`${o}/en.json`),a?h=`${o}/en.json`:(a=yield e.fileExists(`${n}.admin`,`${o}/en/translations.json`),a&&(h=`${o}/en/translations.json`)))),h){const I=yield e.readFile(`${n}.admin`,h);let O;I.file!==void 0?O=I.file:O=I;try{const L=JSON.parse(O);c.I18n.extendTranslations(L,r)}catch(L){return console.error(`Cannot parse language file "${n}.admin/${h}: ${L}`),""}return h}return console.warn(`Cannot find i18n for ${n} / ${h}`),""}return t&&typeof t=="object"&&c.I18n.extendTranslations(t),""})}readData(){this.props.socket.getCompactSystemConfig().then(e=>this.props.socket.getState(`system.adapter.${this.props.adapterName}.${this.props.instance}.alive`).then(t=>{this.props.custom?this.setState({systemConfig:e.common,alive:!!(t&&t.val)}):this.setState({systemConfig:e.common,alive:!!(t&&t.val)},()=>this.props.socket.subscribeState(`system.adapter.${this.props.adapterName}.${this.props.instance}.alive`,this.onAlive))})).catch(e=>console.error(`Cannot read system config: ${e}`))}flatten(e,t){return t=t||{},e.items&&Object.keys(e.items).forEach(n=>{t[n]=e.items[n],this.flatten(e.items[n],t)}),t}buildDependencies(e){const t=this.flatten(e);Object.keys(t).forEach(n=>{var r,o,a,h,I,O,L,q,he,Ee;(r=t[n].confirm)!=null&&r.alsoDependsOn&&((o=t[n].confirm)==null||o.alsoDependsOn.forEach(se=>{if(!t[se])console.error(`[JsonConfigComponent] Attribute ${se} does not exist!`),se.startsWith("data.")&&console.warn(`[JsonConfigComponent] please use "${se.replace(/^data\./,"")}" instead of "${se}"`);else{t[se].confirmDependsOn=t[se].confirmDependsOn||[];const ye=$e(Y({},t[n]),{attr:n});ye.confirm&&(ye.confirm.cancel="Undo"),t[se].confirmDependsOn.push(ye)}})),(a=t[n].onChange)!=null&&a.alsoDependsOn&&((h=t[n].onChange)==null||h.alsoDependsOn.forEach(se=>{if(!t[se])console.error(`[JsonConfigComponent] Attribute ${se} does not exist!`),se.startsWith("data.")&&console.warn(`[JsonConfigComponent] please use "${se.replace(/^data\./,"")}" instead of "${se}"`);else{t[se].onChangeDependsOn=t[se].onChangeDependsOn||[];const ye=$e(Y({},t[n]),{attr:n});t[se].onChangeDependsOn.push(ye)}})),(I=t[n].hidden)!=null&&I.alsoDependsOn&&((O=t[n].hidden)==null||O.alsoDependsOn.forEach(se=>{if(!t[se])console.error(`[JsonConfigComponent] Attribute ${se} does not exist!`),se.startsWith("data.")&&console.warn(`[JsonConfigComponent] please use "${se.replace(/^data\./,"")}" instead of "${se}"`);else{t[se].hiddenDependsOn=t[se].hiddenDependsOn||[];const ye=$e(Y({},t[n]),{attr:n});t[se].hiddenDependsOn.push(ye)}})),(L=t[n].label)!=null&&L.alsoDependsOn&&((q=t[n].label)==null||q.alsoDependsOn.forEach(se=>{if(!t[se])console.error(`[JsonConfigComponent] Attribute ${se} does not exist!`),se.startsWith("data.")&&console.warn(`[JsonConfigComponent] please use "${se.replace(/^data\./,"")}" instead of "${se}"`);else{t[se].labelDependsOn=t[se].labelDependsOn||[];const ye=$e(Y({},t[n]),{attr:n});t[se].labelDependsOn.push(ye)}})),(he=t[n].help)!=null&&he.alsoDependsOn&&((Ee=t[n].help)==null||Ee.alsoDependsOn.forEach(se=>{if(!t[se])console.error(`[JsonConfigComponent] Attribute ${se} does not exist!`),se.startsWith("data.")&&console.warn(`[JsonConfigComponent] please use "${se.replace(/^data\./,"")}" instead of "${se}"`);else{t[se].helpDependsOn=t[se].helpDependsOn||[];const ye=$e(Y({},t[n]),{attr:n});t[se].helpDependsOn.push(ye)}}))})}renderItem(e){return e.type==="tabs"?i().createElement(Ls,{DeviceManager:this.props.DeviceManager,adapterName:this.props.adapterName,alive:this.state.alive,changeLanguage:this.changeLanguage,changed:this.state.changed,commandRunning:this.state.commandRunning,common:this.props.common,custom:this.props.custom,customObj:this.props.customObj,customs:this.props.customs,data:this.props.data,dateFormat:this.props.dateFormat,forceUpdate:this.forceAttrUpdate,imagePrefix:this.props.imagePrefix,instance:this.props.instance,instanceObj:this.props.instanceObj,isFloatComma:this.props.isFloatComma,multiEdit:this.props.multiEdit,onChange:this.onChange,onCommandRunning:this.onCommandRunning,onError:(t,n)=>this.onError(t,n),onBackEndCommand:this.props.onBackEndCommand,originalData:JSON.parse(this.state.originalData),registerOnForceUpdate:this.registerOnForceUpdate,root:!0,schema:e,socket:this.props.socket,systemConfig:this.state.systemConfig,theme:this.props.theme,themeName:this.props.themeName,themeType:this.props.themeType}):e.type==="panel"||!e.type?i().createElement(Lt,{DeviceManager:this.props.DeviceManager,adapterName:this.props.adapterName,alive:this.state.alive,changeLanguage:this.changeLanguage,changed:this.state.changed,commandRunning:this.state.commandRunning,common:this.props.common,custom:this.props.custom,customObj:this.props.customObj,customs:this.props.customs,data:this.props.data,dateFormat:this.props.dateFormat,forceUpdate:this.forceAttrUpdate,imagePrefix:this.props.imagePrefix,index:1e3,instance:this.props.instance,instanceObj:this.props.instanceObj,isFloatComma:this.props.isFloatComma,isParentTab:!this.props.embedded,multiEdit:this.props.multiEdit,onChange:this.onChange,onCommandRunning:this.onCommandRunning,onError:(t,n)=>this.onError(t,n),onBackEndCommand:this.props.onBackEndCommand,originalData:JSON.parse(this.state.originalData),registerOnForceUpdate:this.registerOnForceUpdate,root:!0,schema:e,socket:this.props.socket,systemConfig:this.state.systemConfig,theme:this.props.theme,themeName:this.props.themeName,themeType:this.props.themeType}):null}render(){return this.state.systemConfig?i().createElement("div",{style:Y(Y(Y({},this.props.embedded?void 0:Ps.root),this.props.style),this.state.schema.style)},this.renderItem(this.state.schema)):i().createElement(l.LinearProgress,null)}}const jt=Rs,Et={root:{width:"100%",height:"100%",overflow:"hidden",position:"relative"},scroll:{height:"calc(100% - 48px)",overflowY:"auto"},exportImportButtons:{position:"absolute",top:5,right:0,zIndex:3},button:{marginRight:"5px"},tooltip:{pointerEvents:"none"}};function Ms(x,s){let e="";for(let t=0;t<s.length;t++)e+=String.fromCharCode(x[t%x.length].charCodeAt(0)^s.charCodeAt(t));return e}function Vs(x,s){let e="";for(let t=0;t<s.length;t++)e+=String.fromCharCode(x[t%x.length].charCodeAt(0)^s.charCodeAt(t));return e}function Ws(x,s){if(typeof s!="string")return s;if(!s.startsWith("$/aes-192-cbc:")||!/^[0-9a-f]{48}$/.test(x))return Ms(x,s);const e=s.split(":",3),t=window.CryptoJS.enc.Hex.parse(x),n=window.CryptoJS.enc.Hex.parse(e[1]),r=window.CryptoJS.lib.CipherParams.create({ciphertext:window.CryptoJS.enc.Hex.parse(e[2])}),o=window.CryptoJS.AES.decrypt(r,t,{iv:n});return window.CryptoJS.enc.Utf8.stringify(o)}function Us(x,s,e){if(typeof s!="string")return s;if(!/^[0-9a-f]{48}$/.test(x))return Vs(x,s);let t;e?t=window.CryptoJS.enc.Hex.parse(e):t=window.CryptoJS.lib.WordArray.random(128/8);const n=window.CryptoJS.enc.Hex.parse(x),r=window.CryptoJS.AES.encrypt(s,n,{iv:t}).ciphertext;return`$/aes-192-cbc:${window.CryptoJS.enc.Hex.stringify(t)}:${r}`}function _n(x,s){var e;return!s||!document.getElementById(s)?new Promise(t=>{const n=document.createElement("script");n.setAttribute("id",s),n.onload=t,n.src=x,document.getElementsByTagName("head")[0].appendChild(n)}):(e=document.getElementById(s))==null?void 0:e.onload}class Js extends c.Router{constructor(e){super(e);X(this,"fileSubscribed",[]);X(this,"fileLangSubscribed","");X(this,"secret");X(this,"handleFileSelect",e=>{const t=e.target.files[0];if(t){const n=new FileReader;n.onload=r=>{if(!r.target)return;const o=r.target.result;try{const a=JSON.parse(o);this.setState({data:a,changed:JSON.stringify(a)!==JSON.stringify(this.state.originalData)})}catch(a){window.alert(c.I18n.t("[JsonConfig] Failed to parse JSON file"))}},n.readAsText(t)}else window.alert(c.I18n.t("[JsonConfig] Failed to open JSON File"))});X(this,"onFileChange",(e,t,n)=>pe(this,null,function*(){var r;if(e===`${this.props.adapterName}.admin`&&n){if(t===this.fileLangSubscribed)try{yield jt.loadI18n(this.props.socket,(r=this.state.schema)==null?void 0:r.i18n,this.props.adapterName),this.setState({hash:`${this.state.hash}1`})}catch(o){}else if(this.fileSubscribed.includes(t))try{const o=yield this.getConfigFile(this.fileSubscribed[0]);this.setState({schema:o,hash:C()(JSON.stringify(o)).toString()})}catch(o){}}}));this.state={updateData:0,changed:!1,confirmDialog:!1,theme:(0,c.Theme)(e.themeName),saveConfigDialog:!1,hash:"_"},this.secret=e.secret||"",this.getInstanceObject().then(t=>this.getConfigFile().then(n=>jt.loadI18n(this.props.socket,n==null?void 0:n.i18n,this.props.adapterName).then(r=>{r&&(this.fileLangSubscribed||(this.fileLangSubscribed=r,this.props.socket.subscribeFiles(`${this.props.adapterName}.admin`,this.fileLangSubscribed,this.onFileChange))),t?this.setState({schema:n,data:t.native,common:t.common,hash:C()(JSON.stringify(n)).toString()}):window.alert(`Instance system.adapter.${this.props.adapterName}.${this.props.instance} not found!`)})))}componentWillUnmount(){super.componentWillUnmount(),this.fileSubscribed.length&&(this.props.socket.unsubscribeFiles(`${this.props.adapterName}.admin`,this.fileSubscribed,this.onFileChange),this.fileSubscribed=[]),this.fileLangSubscribed&&(this.props.socket.unsubscribeFiles(`${this.props.adapterName}.admin`,this.fileLangSubscribed,this.onFileChange),this.fileLangSubscribed="")}getExportImportButtons(){return i().createElement("div",{style:Et.exportImportButtons},i().createElement(l.Tooltip,{title:this.props.t("Import settings from JSON file"),slotProps:{popper:{sx:Et.tooltip}}},i().createElement(l.Fab,{size:"small",sx:{"&.MuiFab-root":Et.button},onClick:()=>{const e=document.createElement("input");e.setAttribute("type","file"),e.setAttribute("id","files"),e.setAttribute("opacity",0),e.addEventListener("change",t=>this.handleFileSelect(t),!1),e.click()}},i().createElement(u.Publish,null))),i().createElement(l.Tooltip,{title:this.props.t("Export setting to JSON file"),slotProps:{popper:{sx:Et.tooltip}}},i().createElement(l.Fab,{size:"small",sx:{"&.MuiFab-root":Et.button},onClick:()=>{this.state.data&&te.generateFile(`${this.props.adapterName}.${this.props.instance}.json`,this.state.data)}},i().createElement(u.Publish,{style:{transform:"rotate(180deg)"}}))))}getInstanceObject(){return pe(this,null,function*(){var e;try{const t=yield this.props.socket.getObject(`system.adapter.${this.props.adapterName}.${this.props.instance}`);if(Array.isArray(t.encryptedNative)){if(!this.secret){const n=yield this.props.socket.getSystemConfig();yield _n("../../lib/js/crypto-js/crypto-js.js","crypto-js"),this.secret=n.native.secret}return(e=t.encryptedNative)==null||e.forEach(n=>{t.native[n]&&(t.native[n]=Ws(this.secret,t.native[n]))}),t}return t}catch(t){window.alert(`[JsonConfig] Cannot read instance object: ${t}`)}return null})}renderDialogConfirm(){return this.state.confirmDialog?i().createElement(c.DialogConfirm,{title:c.I18n.t("ra_Please confirm"),text:c.I18n.t("ra_Some data are not stored. Discard?"),ok:c.I18n.t("ra_Discard"),cancel:c.I18n.t("ra_Cancel"),onClose:e=>this.setState({confirmDialog:!1},()=>e&&c.Router.doNavigate(null))}):null}scanForInclude(e,t){return pe(this,null,function*(){if(typeof e["#include"]=="string"){const r=yield this._getConfigFile(e["#include"],[...t]);return delete e["#include"],r&&(e=Y(Y({},e),r)),e}const n=Object.keys(e);for(let r=0;r<n.length;r++)e[n[r]]&&typeof e[n[r]]=="object"&&(e[n[r]]=yield this.scanForInclude(e[n[r]],t));return e})}getConfigFile(e){return pe(this,null,function*(){return this._getConfigFile(e)})}_getConfigFile(e,t){return pe(this,null,function*(){if(e=e||"jsonConfig.json5",t=t||[],t.includes(e))return window.alert(`[JsonConfig] Circular reference in file: ${e} => ${t.join(" => ")}`),null;t.push(e);try{(yield this.props.socket.fileExists(`${this.props.adapterName}.admin`,e))||(e="jsonConfig.json");const r=yield this.props.socket.readFile(`${this.props.adapterName}.admin`,e);let o="",a="";if(r.file!==void 0&&(a=r.file),typeof a=="string")o=a;else if(a.type==="Buffer"){let h="";const I=new Uint8Array(a.data),O=I.byteLength;for(let L=0;L<O;L++)h+=String.fromCharCode(I[L]);o=h}this.fileSubscribed.includes(e)||(this.fileSubscribed.push(e),yield this.props.socket.subscribeFiles(`${this.props.adapterName}.admin`,e,this.onFileChange));try{return yield this.scanForInclude(f().parse(o),t)}catch(h){window.alert("[JsonConfig] Cannot parse json5 config!"),console.log(h)}}catch(n){this.state.schema||window.alert(`[JsonConfig] Cannot read file "${e}: ${n}`)}return null})}renderSaveConfigDialog(){return this.state.saveConfigDialog?i().createElement(c.DialogConfirm,{title:c.I18n.t("ra_Please confirm"),text:c.I18n.t("Save configuration?"),ok:c.I18n.t("ra_Save"),cancel:c.I18n.t("ra_Cancel"),onClose:e=>this.setState({saveConfigDialog:!1},()=>e&&this.onSave(!0))}):null}findAttr(e,t){if(t=t||this.state.schema,t!=null&&t.items){if(e in t.items)return t.items[e];for(const n of Object.values(t.items)){const r=this.findAttr(e,n);if(r)return r}}return null}postProcessing(e,t,n){if(n=n||this.state.schema,!e){console.error(`Data is empty in postProcessing: ${t}, ${JSON.stringify(n)}`);return}const r=e[t];if(n.items)if(n.type==="table"){const o=r;if(!Array.isArray(o))return;for(const a of o)for(const h of n.items)this.postProcessing(a,h.attr,h)}else for(const[o,a]of Object.entries(n.items)){if(a.type==="panel"||a.type==="tabs"||a.type==="accordion")return;this.postProcessing(e,o,a)}else if(t&&typeof r=="string")if(n.type==="text")n.trim!==!1&&(e[t]=r.trim());else if(n.type==="ip")e[t]=r.trim();else if(n.type==="number"){const o=parseFloat(r.toString().replace(",","."));n.min!==void 0&&o<n.min?e[t]=n.min:n.max!==void 0&&o>n.max?e[t]=n.max:e[t]=o}else if(n.type==="port"){const o=parseInt(r.toString(),10);n.min!==void 0&&o<n.min?e[t]=n.min:n.max!==void 0&&o>n.max&&(e[t]=n.max),e[t]!==0&&o<20?e[t]=20:o>65535?e[t]=65535:e[t]=o}else n.type==="checkbox"&&(e[t]=e[t]===!0||e[t]==="true"||e[t]==="on"||e[t]===1||e[t]==="1")}onSave(e,t){return pe(this,null,function*(){if(e){const n=yield this.getInstanceObject();if(!n){console.error("Something went wrong: may be no connection?"),window.alert("Something went wrong: may be no connection?");return}if(!this.state.data||!this.state.schema)return;const r={};for(const a of Object.keys(this.state.data)){const h=this.findAttr(a);(!h||!h.doNotSave||h.type==="state")&&!a.startsWith("_")?d.setValue(n.native,a,this.state.data[a]):(d.setValue(n.native,a,null),r[a]=this.state.data[a])}try{const a=JSON.parse(JSON.stringify(n));if(Array.isArray(a.encryptedNative)){yield _n("../../lib/js/crypto-js/crypto-js.js","crypto-js");for(const h of a.encryptedNative)a.native[h]&&(a.native[h]=Us(this.secret,a.native[h]))}yield this.props.socket.setObject(a._id,a)}catch(a){window.alert(`[JsonConfig] Cannot set object: ${a}`)}const o=Y(Y({},n.native),r);console.log(o),this.setState({changed:!1,data:o,updateData:this.state.updateData+1,originalData:o},()=>t&&c.Router.doNavigate(null))}else this.state.changed?this.setState({confirmDialog:!0}):c.Router.doNavigate(null)})}componentDidUpdate(e,t){t.changed!==this.state.changed&&this.props.configStored(!this.state.changed)}componentDidMount(){return pe(this,null,function*(){const e=`${window.location.protocol}//${window.location.host}${window.location.pathname}validate_config/${this.props.adapterName}`;console.log(`fetch ${e}`),yield fetch(e)})}render(){return!this.state.data||!this.state.schema?i().createElement(l.LinearProgress,null):i().createElement("div",{style:Et.root},this.renderDialogConfirm(),this.getExportImportButtons(),this.renderSaveConfigDialog(),i().createElement(jt,{key:this.state.hash,style:Et.scroll,socket:this.props.socket,themeName:this.props.themeName,themeType:this.props.themeType,adapterName:this.props.adapterName,instance:this.props.instance,isFloatComma:this.props.isFloatComma,dateFormat:this.props.dateFormat,schema:this.state.schema,common:this.state.common,data:this.state.data,updateData:this.state.updateData,onError:e=>this.setState({error:e}),onChange:(e,t,n)=>{n&&this.state.error&&(window.alert(c.I18n.t("Cannot save configuration because of error in configuration")),n=!1),n&&!this.state.changed&&!t&&(n=!1),e?this.setState({data:e,changed:t,saveConfigDialog:n}):n!==void 0&&this.setState({saveConfigDialog:n})},DeviceManager:this.props.DeviceManager,theme:this.state.theme}),i().createElement(c.SaveCloseButtons,{isIFrame:!1,dense:!0,paddingLeft:0,newReact:!0,theme:this.state.theme,noTextOnButtons:this.props.width==="xs"||this.props.width==="sm"||this.props.width==="md",changed:!!(this.state.error||this.state.changed),error:!!this.state.error,onSave:e=>this.onSave(!0,e),onClose:()=>this.onSave(!1)}))}}const js=Js},2292:(M,ee,G)=>{M=G.nmd(M),ace.define("ace/snippets",["require","exports","module","ace/lib/dom","ace/lib/oop","ace/lib/event_emitter","ace/lib/lang","ace/range","ace/range_list","ace/keyboard/hash_handler","ace/tokenizer","ace/clipboard","ace/editor"],function(A,i,D){"use strict";function f(p){var g=new Date().toLocaleString("en-us",p);return g.length==1?"0"+g:g}var v=A("./lib/dom"),C=A("./lib/oop"),l=A("./lib/event_emitter").EventEmitter,u=A("./lib/lang"),c=A("./range").Range,S=A("./range_list").RangeList,P=A("./keyboard/hash_handler").HashHandler,H=A("./tokenizer").Tokenizer,Q=A("./clipboard"),R={CURRENT_WORD:function(p){return p.session.getTextRange(p.session.getWordRange())},SELECTION:function(p,g,m){var b=p.session.getTextRange();return m?b.replace(/\n\r?([ \t]*\S)/g,`
`+m+"$1"):b},CURRENT_LINE:function(p){return p.session.getLine(p.getCursorPosition().row)},PREV_LINE:function(p){return p.session.getLine(p.getCursorPosition().row-1)},LINE_INDEX:function(p){return p.getCursorPosition().row},LINE_NUMBER:function(p){return p.getCursorPosition().row+1},SOFT_TABS:function(p){return p.session.getUseSoftTabs()?"YES":"NO"},TAB_SIZE:function(p){return p.session.getTabSize()},CLIPBOARD:function(p){return Q.getText&&Q.getText()},FILENAME:function(p){return/[^/\\]*$/.exec(this.FILEPATH(p))[0]},FILENAME_BASE:function(p){return/[^/\\]*$/.exec(this.FILEPATH(p))[0].replace(/\.[^.]*$/,"")},DIRECTORY:function(p){return this.FILEPATH(p).replace(/[^/\\]*$/,"")},FILEPATH:function(p){return"/not implemented.txt"},WORKSPACE_NAME:function(){return"Unknown"},FULLNAME:function(){return"Unknown"},BLOCK_COMMENT_START:function(p){var g=p.session.$mode||{};return g.blockComment&&g.blockComment.start||""},BLOCK_COMMENT_END:function(p){var g=p.session.$mode||{};return g.blockComment&&g.blockComment.end||""},LINE_COMMENT:function(p){var g=p.session.$mode||{};return g.lineCommentStart||""},CURRENT_YEAR:f.bind(null,{year:"numeric"}),CURRENT_YEAR_SHORT:f.bind(null,{year:"2-digit"}),CURRENT_MONTH:f.bind(null,{month:"numeric"}),CURRENT_MONTH_NAME:f.bind(null,{month:"long"}),CURRENT_MONTH_NAME_SHORT:f.bind(null,{month:"short"}),CURRENT_DATE:f.bind(null,{day:"2-digit"}),CURRENT_DAY_NAME:f.bind(null,{weekday:"long"}),CURRENT_DAY_NAME_SHORT:f.bind(null,{weekday:"short"}),CURRENT_HOUR:f.bind(null,{hour:"2-digit",hour12:!1}),CURRENT_MINUTE:f.bind(null,{minute:"2-digit"}),CURRENT_SECOND:f.bind(null,{second:"2-digit"})};R.SELECTED_TEXT=R.SELECTION;var J=function(){function p(){this.snippetMap={},this.snippetNameMap={},this.variables=R}return p.prototype.getTokenizer=function(){return p.$tokenizer||this.createTokenizer()},p.prototype.createTokenizer=function(){function g(E){return E=E.substr(1),/^\d+$/.test(E)?[{tabstopId:parseInt(E,10)}]:[{text:E}]}function m(E){return"(?:[^\\\\"+E+"]|\\\\.)"}var b={regex:"/("+m("/")+"+)/",onMatch:function(E,k,B){var _=B[0];return _.fmtString=!0,_.guard=E.slice(1,-1),_.flag="",""},next:"formatString"};return p.$tokenizer=new H({start:[{regex:/\\./,onMatch:function(E,k,B){var _=E[1];return(_=="}"&&B.length||"`$\\".indexOf(_)!=-1)&&(E=_),[E]}},{regex:/}/,onMatch:function(E,k,B){return[B.length?B.shift():E]}},{regex:/\$(?:\d+|\w+)/,onMatch:g},{regex:/\$\{[\dA-Z_a-z]+/,onMatch:function(E,k,B){var _=g(E.substr(1));return B.unshift(_[0]),_},next:"snippetVar"},{regex:/\n/,token:"newline",merge:!1}],snippetVar:[{regex:"\\|"+m("\\|")+"*\\|",onMatch:function(E,k,B){var _=E.slice(1,-1).replace(/\\[,|\\]|,/g,function(F){return F.length==2?F[1]:"\0"}).split("\0").map(function(F){return{value:F}});return B[0].choices=_,[_[0]]},next:"start"},b,{regex:"([^:}\\\\]|\\\\.)*:?",token:"",next:"start"}],formatString:[{regex:/:/,onMatch:function(E,k,B){return B.length&&B[0].expectElse?(B[0].expectElse=!1,B[0].ifEnd={elseEnd:B[0]},[B[0].ifEnd]):":"}},{regex:/\\./,onMatch:function(E,k,B){var _=E[1];return _=="}"&&B.length||"`$\\".indexOf(_)!=-1?E=_:_=="n"?E=`
`:_=="t"?E="	":"ulULE".indexOf(_)!=-1&&(E={changeCase:_,local:_>"a"}),[E]}},{regex:"/\\w*}",onMatch:function(E,k,B){var _=B.shift();return _&&(_.flag=E.slice(1,-1)),this.next=_&&_.tabstopId?"start":"",[_||E]},next:"start"},{regex:/\$(?:\d+|\w+)/,onMatch:function(E,k,B){return[{text:E.slice(1)}]}},{regex:/\${\w+/,onMatch:function(E,k,B){var _={text:E.slice(2)};return B.unshift(_),[_]},next:"formatStringVar"},{regex:/\n/,token:"newline",merge:!1},{regex:/}/,onMatch:function(E,k,B){var _=B.shift();return this.next=_&&_.tabstopId?"start":"",[_||E]},next:"start"}],formatStringVar:[{regex:/:\/\w+}/,onMatch:function(E,k,B){var _=B[0];return _.formatFunction=E.slice(2,-1),[B.shift()]},next:"formatString"},b,{regex:/:[\?\-+]?/,onMatch:function(E,k,B){E[1]=="+"&&(B[0].ifEnd=B[0]),E[1]=="?"&&(B[0].expectElse=!0)},next:"formatString"},{regex:"([^:}\\\\]|\\\\.)*:?",token:"",next:"formatString"}]}),p.$tokenizer},p.prototype.tokenizeTmSnippet=function(g,m){return this.getTokenizer().getLineTokens(g,m).tokens.map(function(b){return b.value||b})},p.prototype.getVariableValue=function(g,m,b){if(/^\d+$/.test(m))return(this.variables.__||{})[m]||"";if(/^[A-Z]\d+$/.test(m))return(this.variables[m[0]+"__"]||{})[m.substr(1)]||"";if(m=m.replace(/^TM_/,""),!this.variables.hasOwnProperty(m))return"";var E=this.variables[m];return typeof E=="function"&&(E=this.variables[m](g,m,b)),E==null?"":E},p.prototype.tmStrFormat=function(g,m,b){if(!m.fmt)return g;var E=m.flag||"",k=m.guard;k=new RegExp(k,E.replace(/[^gim]/g,""));var B=typeof m.fmt=="string"?this.tokenizeTmSnippet(m.fmt,"formatString"):m.fmt,_=this,F=g.replace(k,function(){var T=_.variables.__;_.variables.__=[].slice.call(arguments);for(var W=_.resolveVariables(B,b),re="E",Z=0;Z<W.length;Z++){var ce=W[Z];if(typeof ce=="object")if(W[Z]="",ce.changeCase&&ce.local){var le=W[Z+1];le&&typeof le=="string"&&(ce.changeCase=="u"?W[Z]=le[0].toUpperCase():W[Z]=le[0].toLowerCase(),W[Z+1]=le.substr(1))}else ce.changeCase&&(re=ce.changeCase);else re=="U"?W[Z]=ce.toUpperCase():re=="L"&&(W[Z]=ce.toLowerCase())}return _.variables.__=T,W.join("")});return F},p.prototype.tmFormatFunction=function(g,m,b){return m.formatFunction=="upcase"?g.toUpperCase():m.formatFunction=="downcase"?g.toLowerCase():g},p.prototype.resolveVariables=function(g,m){function b(re){var Z=g.indexOf(re,_+1);Z!=-1&&(_=Z)}for(var E=[],k="",B=!0,_=0;_<g.length;_++){var F=g[_];if(typeof F=="string"){E.push(F),F==`
`?(B=!0,k=""):B&&(k=/^\t*/.exec(F)[0],B=/\S/.test(F));continue}if(F){if(B=!1,F.fmtString){var T=g.indexOf(F,_+1);T==-1&&(T=g.length),F.fmt=g.slice(_+1,T),_=T}if(F.text){var W=this.getVariableValue(m,F.text,k)+"";F.fmtString&&(W=this.tmStrFormat(W,F,m)),F.formatFunction&&(W=this.tmFormatFunction(W,F,m)),W&&!F.ifEnd?(E.push(W),b(F)):!W&&F.ifEnd&&b(F.ifEnd)}else F.elseEnd?b(F.elseEnd):(F.tabstopId!=null||F.changeCase!=null)&&E.push(F)}}return E},p.prototype.getDisplayTextForSnippet=function(g,m){var b=te.call(this,g,m);return b.text},p.prototype.insertSnippetForSelection=function(g,m,b){b===void 0&&(b={});var E=te.call(this,g,m,b),k=g.getSelectionRange(),B=g.session.replace(k,E.text),_=new oe(g),F=g.inVirtualSelectionMode&&g.selection.index;_.addTabstops(E.tabstops,k.start,B,F)},p.prototype.insertSnippet=function(g,m,b){b===void 0&&(b={});var E=this;if(g.inVirtualSelectionMode)return E.insertSnippetForSelection(g,m,b);g.forEachSelection(function(){E.insertSnippetForSelection(g,m,b)},null,{keepOrder:!0}),g.tabstopManager&&g.tabstopManager.tabNext()},p.prototype.$getScope=function(g){var m=g.session.$mode.$id||"";if(m=m.split("/").pop(),m==="html"||m==="php"){m==="php"&&!g.session.$mode.inlinePhp&&(m="html");var b=g.getCursorPosition(),E=g.session.getState(b.row);typeof E=="object"&&(E=E[0]),E.substring&&(E.substring(0,3)=="js-"?m="javascript":E.substring(0,4)=="css-"?m="css":E.substring(0,4)=="php-"&&(m="php"))}return m},p.prototype.getActiveScopes=function(g){var m=this.$getScope(g),b=[m],E=this.snippetMap;return E[m]&&E[m].includeScopes&&b.push.apply(b,E[m].includeScopes),b.push("_"),b},p.prototype.expandWithTab=function(g,m){var b=this,E=g.forEachSelection(function(){return b.expandSnippetForSelection(g,m)},null,{keepOrder:!0});return E&&g.tabstopManager&&g.tabstopManager.tabNext(),E},p.prototype.expandSnippetForSelection=function(g,m){var b=g.getCursorPosition(),E=g.session.getLine(b.row),k=E.substring(0,b.column),B=E.substr(b.column),_=this.snippetMap,F;return this.getActiveScopes(g).some(function(T){var W=_[T];return W&&(F=this.findMatchingSnippet(W,k,B)),!!F},this),F?(m&&m.dryRun||(g.session.doc.removeInLine(b.row,b.column-F.replaceBefore.length,b.column+F.replaceAfter.length),this.variables.M__=F.matchBefore,this.variables.T__=F.matchAfter,this.insertSnippetForSelection(g,F.content),this.variables.M__=this.variables.T__=null),!0):!1},p.prototype.findMatchingSnippet=function(g,m,b){for(var E=g.length;E--;){var k=g[E];if(!(k.startRe&&!k.startRe.test(m))&&!(k.endRe&&!k.endRe.test(b))&&!(!k.startRe&&!k.endRe))return k.matchBefore=k.startRe?k.startRe.exec(m):[""],k.matchAfter=k.endRe?k.endRe.exec(b):[""],k.replaceBefore=k.triggerRe?k.triggerRe.exec(m)[0]:"",k.replaceAfter=k.endTriggerRe?k.endTriggerRe.exec(b)[0]:"",k}},p.prototype.register=function(g,m){function b(T){return T&&!/^\^?\(.*\)\$?$|^\\b$/.test(T)&&(T="(?:"+T+")"),T||""}function E(T,W,re){return T=b(T),W=b(W),re?(T=W+T,T&&T[T.length-1]!="$"&&(T+="$")):(T+=W,T&&T[0]!="^"&&(T="^"+T)),new RegExp(T)}function k(T){T.scope||(T.scope=m||"_"),m=T.scope,B[m]||(B[m]=[],_[m]={});var W=_[m];if(T.name){var re=W[T.name];re&&F.unregister(re),W[T.name]=T}B[m].push(T),T.prefix&&(T.tabTrigger=T.prefix),!T.content&&T.body&&(T.content=Array.isArray(T.body)?T.body.join(`
`):T.body),T.tabTrigger&&!T.trigger&&(!T.guard&&/^\w/.test(T.tabTrigger)&&(T.guard="\\b"),T.trigger=u.escapeRegExp(T.tabTrigger)),!(!T.trigger&&!T.guard&&!T.endTrigger&&!T.endGuard)&&(T.startRe=E(T.trigger,T.guard,!0),T.triggerRe=new RegExp(T.trigger),T.endRe=E(T.endTrigger,T.endGuard,!0),T.endTriggerRe=new RegExp(T.endTrigger))}var B=this.snippetMap,_=this.snippetNameMap,F=this;g||(g=[]),Array.isArray(g)?g.forEach(k):Object.keys(g).forEach(function(T){k(g[T])}),this._signal("registerSnippets",{scope:m})},p.prototype.unregister=function(g,m){function b(B){var _=k[B.scope||m];if(_&&_[B.name]){delete _[B.name];var F=E[B.scope||m],T=F&&F.indexOf(B);T>=0&&F.splice(T,1)}}var E=this.snippetMap,k=this.snippetNameMap;g.content?b(g):Array.isArray(g)&&g.forEach(b)},p.prototype.parseSnippetFile=function(g){g=g.replace(/\r/g,"");for(var m=[],b={},E=/^#.*|^({[\s\S]*})\s*$|^(\S+) (.*)$|^((?:\n*\t.*)+)/gm,k;k=E.exec(g);){if(k[1])try{b=JSON.parse(k[1]),m.push(b)}catch(T){}if(k[4])b.content=k[4].replace(/^\t/gm,""),m.push(b),b={};else{var B=k[2],_=k[3];if(B=="regex"){var F=/\/((?:[^\/\\]|\\.)*)|$/g;b.guard=F.exec(_)[1],b.trigger=F.exec(_)[1],b.endTrigger=F.exec(_)[1],b.endGuard=F.exec(_)[1]}else B=="snippet"?(b.tabTrigger=_.match(/^\S*/)[0],b.name||(b.name=_)):B&&(b[B]=_)}}return m},p.prototype.getSnippetByName=function(g,m){var b=this.snippetNameMap,E;return this.getActiveScopes(m).some(function(k){var B=b[k];return B&&(E=B[g]),!!E},this),E},p}();C.implement(J.prototype,l);var te=function(p,g,m){function b(ue){for(var ke=[],ze=0;ze<ue.length;ze++){var Ie=ue[ze];if(typeof Ie=="object"){if(W[Ie.tabstopId])continue;var ut=ue.lastIndexOf(Ie,ze-1);Ie=ke[ut]||{tabstopId:Ie.tabstopId}}ke[ze]=Ie}return ke}m===void 0&&(m={});var E=p.getCursorPosition(),k=p.session.getLine(E.row),B=p.session.getTabString(),_=k.match(/^\s*/)[0];E.column<_.length&&(_=_.slice(0,E.column)),g=g.replace(/\r/g,"");var F=this.tokenizeTmSnippet(g);F=this.resolveVariables(F,p),F=F.map(function(ue){return ue==`
`&&!m.excludeExtraIndent?ue+_:typeof ue=="string"?ue.replace(/\t/g,B):ue});var T=[];F.forEach(function(ue,ke){if(typeof ue=="object"){var ze=ue.tabstopId,Ie=T[ze];if(Ie||(Ie=T[ze]=[],Ie.index=ze,Ie.value="",Ie.parents={}),Ie.indexOf(ue)===-1){ue.choices&&!Ie.choices&&(Ie.choices=ue.choices),Ie.push(ue);var ut=F.indexOf(ue,ke+1);if(ut!==-1){var ct=F.slice(ke+1,ut),Dt=ct.some(function(_e){return typeof _e=="object"});Dt&&!Ie.value?Ie.value=ct:ct.length&&(!Ie.value||typeof Ie.value!="string")&&(Ie.value=ct.join(""))}}}}),T.forEach(function(ue){ue.length=0});for(var W={},re=0;re<F.length;re++){var Z=F[re];if(typeof Z=="object"){var ce=Z.tabstopId,le=T[ce],V=F.indexOf(Z,re+1);if(W[ce]){W[ce]===Z&&(delete W[ce],Object.keys(W).forEach(function(ue){le.parents[ue]=!0}));continue}W[ce]=Z;var z=le.value;typeof z!="string"?z=b(z):Z.fmt&&(z=this.tmStrFormat(z,Z,p)),F.splice.apply(F,[re+1,Math.max(0,V-re)].concat(z,Z)),le.indexOf(Z)===-1&&le.push(Z)}}var j=0,K=0,Se="";return F.forEach(function(ue){if(typeof ue=="string"){var ke=ue.split(`
`);ke.length>1?(K=ke[ke.length-1].length,j+=ke.length-1):K+=ue.length,Se+=ue}else ue&&(ue.start?ue.end={row:j,column:K}:ue.start={row:j,column:K})}),{text:Se,tabstops:T,tokens:F}},oe=function(){function p(g){if(this.index=0,this.ranges=[],this.tabstops=[],g.tabstopManager)return g.tabstopManager;g.tabstopManager=this,this.$onChange=this.onChange.bind(this),this.$onChangeSelection=u.delayedCall(this.onChangeSelection.bind(this)).schedule,this.$onChangeSession=this.onChangeSession.bind(this),this.$onAfterExec=this.onAfterExec.bind(this),this.attach(g)}return p.prototype.attach=function(g){this.$openTabstops=null,this.selectedTabstop=null,this.editor=g,this.session=g.session,this.editor.on("change",this.$onChange),this.editor.on("changeSelection",this.$onChangeSelection),this.editor.on("changeSession",this.$onChangeSession),this.editor.commands.on("afterExec",this.$onAfterExec),this.editor.keyBinding.addKeyboardHandler(this.keyboardHandler)},p.prototype.detach=function(){this.tabstops.forEach(this.removeTabstopMarkers,this),this.ranges.length=0,this.tabstops.length=0,this.selectedTabstop=null,this.editor.off("change",this.$onChange),this.editor.off("changeSelection",this.$onChangeSelection),this.editor.off("changeSession",this.$onChangeSession),this.editor.commands.off("afterExec",this.$onAfterExec),this.editor.keyBinding.removeKeyboardHandler(this.keyboardHandler),this.editor.tabstopManager=null,this.session=null,this.editor=null},p.prototype.onChange=function(g){for(var m=g.action[0]=="r",b=this.selectedTabstop||{},E=b.parents||{},k=this.tabstops.slice(),B=0;B<k.length;B++){var _=k[B],F=_==b||E[_.index];if(_.rangeList.$bias=F?0:1,g.action=="remove"&&_!==b){var T=_.parents&&_.parents[b.index],W=_.rangeList.pointIndex(g.start,T);W=W<0?-W-1:W+1;var re=_.rangeList.pointIndex(g.end,T);re=re<0?-re-1:re-1;for(var Z=_.rangeList.ranges.slice(W,re),ce=0;ce<Z.length;ce++)this.removeRange(Z[ce])}_.rangeList.$onChange(g)}var le=this.session;!this.$inChange&&m&&le.getLength()==1&&!le.getValue()&&this.detach()},p.prototype.updateLinkedFields=function(){var g=this.selectedTabstop;if(!(!g||!g.hasLinkedRanges||!g.firstNonLinked)){this.$inChange=!0;for(var m=this.session,b=m.getTextRange(g.firstNonLinked),E=0;E<g.length;E++){var k=g[E];if(k.linked){var B=k.original,_=i.snippetManager.tmStrFormat(b,B,this.editor);m.replace(k,_)}}this.$inChange=!1}},p.prototype.onAfterExec=function(g){g.command&&!g.command.readOnly&&this.updateLinkedFields()},p.prototype.onChangeSelection=function(){if(this.editor){for(var g=this.editor.selection.lead,m=this.editor.selection.anchor,b=this.editor.selection.isEmpty(),E=0;E<this.ranges.length;E++)if(!this.ranges[E].linked){var k=this.ranges[E].contains(g.row,g.column),B=b||this.ranges[E].contains(m.row,m.column);if(k&&B)return}this.detach()}},p.prototype.onChangeSession=function(){this.detach()},p.prototype.tabNext=function(g){var m=this.tabstops.length,b=this.index+(g||1);b=Math.min(Math.max(b,1),m),b==m&&(b=0),this.selectTabstop(b),this.updateTabstopMarkers(),b===0&&this.detach()},p.prototype.selectTabstop=function(g){this.$openTabstops=null;var m=this.tabstops[this.index];if(m&&this.addTabstopMarkers(m),this.index=g,m=this.tabstops[this.index],!(!m||!m.length)){this.selectedTabstop=m;var b=m.firstNonLinked||m;if(m.choices&&(b.cursor=b.start),this.editor.inVirtualSelectionMode)this.editor.selection.fromOrientedRange(b);else{var E=this.editor.multiSelect;E.toSingleRange(b);for(var k=0;k<m.length;k++)m.hasLinkedRanges&&m[k].linked||E.addRange(m[k].clone(),!0)}this.editor.keyBinding.addKeyboardHandler(this.keyboardHandler),this.selectedTabstop&&this.selectedTabstop.choices&&this.editor.execCommand("startAutocomplete",{matches:this.selectedTabstop.choices})}},p.prototype.addTabstops=function(g,m,b){var E=this.useLink||!this.editor.getOption("enableMultiselect");if(this.$openTabstops||(this.$openTabstops=[]),!g[0]){var k=c.fromPoints(b,b);d(k.start,m),d(k.end,m),g[0]=[k],g[0].index=0}var B=this.index,_=[B+1,0],F=this.ranges,T=this.snippetId=(this.snippetId||0)+1;g.forEach(function(W,re){var Z=this.$openTabstops[re]||W;Z.snippetId=T;for(var ce=0;ce<W.length;ce++){var le=W[ce],V=c.fromPoints(le.start,le.end||le.start);N(V.start,m),N(V.end,m),V.original=le,V.tabstop=Z,F.push(V),Z!=W?Z.unshift(V):Z[ce]=V,le.fmtString||Z.firstNonLinked&&E?(V.linked=!0,Z.hasLinkedRanges=!0):Z.firstNonLinked||(Z.firstNonLinked=V)}Z.firstNonLinked||(Z.hasLinkedRanges=!1),Z===W&&(_.push(Z),this.$openTabstops[re]=Z),this.addTabstopMarkers(Z),Z.rangeList=Z.rangeList||new S,Z.rangeList.$bias=0,Z.rangeList.addList(Z)},this),_.length>2&&(this.tabstops.length&&_.push(_.splice(2,1)[0]),this.tabstops.splice.apply(this.tabstops,_))},p.prototype.addTabstopMarkers=function(g){var m=this.session;g.forEach(function(b){b.markerId||(b.markerId=m.addMarker(b,"ace_snippet-marker","text"))})},p.prototype.removeTabstopMarkers=function(g){var m=this.session;g.forEach(function(b){m.removeMarker(b.markerId),b.markerId=null})},p.prototype.updateTabstopMarkers=function(){if(this.selectedTabstop){var g=this.selectedTabstop.snippetId;this.selectedTabstop.index===0&&g--,this.tabstops.forEach(function(m){m.snippetId===g?this.addTabstopMarkers(m):this.removeTabstopMarkers(m)},this)}},p.prototype.removeRange=function(g){var m=g.tabstop.indexOf(g);m!=-1&&g.tabstop.splice(m,1),m=this.ranges.indexOf(g),m!=-1&&this.ranges.splice(m,1),m=g.tabstop.rangeList.ranges.indexOf(g),m!=-1&&g.tabstop.splice(m,1),this.session.removeMarker(g.markerId),g.tabstop.length||(m=this.tabstops.indexOf(g.tabstop),m!=-1&&this.tabstops.splice(m,1),this.tabstops.length||this.detach())},p}();oe.prototype.keyboardHandler=new P,oe.prototype.keyboardHandler.bindKeys({Tab:function(p){i.snippetManager&&i.snippetManager.expandWithTab(p)||(p.tabstopManager.tabNext(1),p.renderer.scrollCursorIntoView())},"Shift-Tab":function(p){p.tabstopManager.tabNext(-1),p.renderer.scrollCursorIntoView()},Esc:function(p){p.tabstopManager.detach()}});var N=function(p,g){p.row==0&&(p.column+=g.column),p.row+=g.row},d=function(p,g){p.row==g.row&&(p.column-=g.column),p.row-=g.row};v.importCssString(`
.ace_snippet-marker {
    -moz-box-sizing: border-box;
    box-sizing: border-box;
    background: rgba(194, 193, 208, 0.09);
    border: 1px dotted rgba(211, 208, 235, 0.62);
    position: absolute;
}`,"snippets.css",!1),i.snippetManager=new J;var y=A("./editor").Editor;(function(){this.insertSnippet=function(p,g){return i.snippetManager.insertSnippet(this,p,g)},this.expandSnippet=function(p){return i.snippetManager.expandWithTab(this,p)}}).call(y.prototype)}),ace.define("ace/autocomplete/popup",["require","exports","module","ace/virtual_renderer","ace/editor","ace/range","ace/lib/event","ace/lib/lang","ace/lib/dom","ace/config","ace/lib/useragent"],function(A,i,D){"use strict";var f=A("../virtual_renderer").VirtualRenderer,v=A("../editor").Editor,C=A("../range").Range,l=A("../lib/event"),u=A("../lib/lang"),c=A("../lib/dom"),S=A("../config").nls,P=A("./../lib/useragent"),H=function(N){return"suggest-aria-id:".concat(N)},Q=P.isSafari?"menu":"listbox",R=P.isSafari?"menuitem":"option",J=P.isSafari?"aria-current":"aria-selected",te=function(N){var d=new f(N);d.$maxLines=4;var y=new v(d);return y.setHighlightActiveLine(!1),y.setShowPrintMargin(!1),y.renderer.setShowGutter(!1),y.renderer.setHighlightGutterLine(!1),y.$mouseHandler.$focusTimeout=0,y.$highlightTagPending=!0,y},oe=function(){function N(d){var y=c.createElement("div"),p=te(y);d&&d.appendChild(y),y.style.display="none",p.renderer.content.style.cursor="default",p.renderer.setStyle("ace_autocomplete"),p.renderer.$textLayer.element.setAttribute("role",Q),p.renderer.$textLayer.element.setAttribute("aria-roledescription",S("autocomplete.popup.aria-roledescription","Autocomplete suggestions")),p.renderer.$textLayer.element.setAttribute("aria-label",S("autocomplete.popup.aria-label","Autocomplete suggestions")),p.renderer.textarea.setAttribute("aria-hidden","true"),p.setOption("displayIndentGuides",!1),p.setOption("dragDelay",150);var g=function(){};p.focus=g,p.$isFocused=!0,p.renderer.$cursorLayer.restartTimer=g,p.renderer.$cursorLayer.element.style.opacity="0",p.renderer.$maxLines=8,p.renderer.$keepTextAreaAtCursor=!1,p.setHighlightActiveLine(!1),p.session.highlight(""),p.session.$searchHighlight.clazz="ace_highlight-marker",p.on("mousedown",function(F){var T=F.getDocumentPosition();p.selection.moveToPosition(T),E.start.row=E.end.row=T.row,F.stop()});var m,b=new C(-1,0,-1,1/0),E=new C(-1,0,-1,1/0);E.id=p.session.addMarker(E,"ace_active-line","fullLine"),p.setSelectOnHover=function(F){F?b.id&&(p.session.removeMarker(b.id),b.id=null):b.id=p.session.addMarker(b,"ace_line-hover","fullLine")},p.setSelectOnHover(!1),p.on("mousemove",function(F){if(!m){m=F;return}if(!(m.x==F.x&&m.y==F.y)){m=F,m.scrollTop=p.renderer.scrollTop,p.isMouseOver=!0;var T=m.getDocumentPosition().row;b.start.row!=T&&(b.id||p.setRow(T),B(T))}}),p.renderer.on("beforeRender",function(){if(m&&b.start.row!=-1){m.$pos=null;var F=m.getDocumentPosition().row;b.id||p.setRow(F),B(F,!0)}}),p.renderer.on("afterRender",function(){var F=p.getRow(),T=p.renderer.$textLayer,W=T.element.childNodes[F-T.config.firstRow],re=document.activeElement;if(W!==p.selectedNode&&p.selectedNode&&(c.removeCssClass(p.selectedNode,"ace_selected"),re.removeAttribute("aria-activedescendant"),p.selectedNode.removeAttribute(J),p.selectedNode.removeAttribute("id")),p.selectedNode=W,W){c.addCssClass(W,"ace_selected");var Z=H(F);W.id=Z,T.element.setAttribute("aria-activedescendant",Z),re.setAttribute("aria-activedescendant",Z),W.setAttribute("role",R),W.setAttribute("aria-roledescription",S("autocomplete.popup.item.aria-roledescription","item")),W.setAttribute("aria-label",p.getData(F).caption||p.getData(F).value),W.setAttribute("aria-setsize",p.data.length),W.setAttribute("aria-posinset",F+1),W.setAttribute("aria-describedby","doc-tooltip"),W.setAttribute(J,"true")}});var k=function(){B(-1)},B=function(F,T){F!==b.start.row&&(b.start.row=b.end.row=F,T||p.session._emit("changeBackMarker"),p._emit("changeHoverMarker"))};p.getHoveredRow=function(){return b.start.row},l.addListener(p.container,"mouseout",function(){p.isMouseOver=!1,k()}),p.on("hide",k),p.on("changeSelection",k),p.session.doc.getLength=function(){return p.data.length},p.session.doc.getLine=function(F){var T=p.data[F];return typeof T=="string"?T:T&&T.value||""};var _=p.session.bgTokenizer;return _.$tokenizeRow=function(F){function T(ue,ke){ue&&re.push({type:(W.className||"")+(ke||""),value:ue})}var W=p.data[F],re=[];if(!W)return re;typeof W=="string"&&(W={value:W});for(var Z=W.caption||W.value||W.name,ce=Z.toLowerCase(),le=(p.filterText||"").toLowerCase(),V=0,z=0,j=0;j<=le.length;j++)if(j!=z&&(W.matchMask&1<<j||j==le.length)){var K=le.slice(z,j);z=j;var Se=ce.indexOf(K,V);if(Se==-1)continue;T(Z.slice(V,Se),""),V=Se+K.length,T(Z.slice(Se,V),"completion-highlight")}return T(Z.slice(V,Z.length),""),re.push({type:"completion-spacer",value:" "}),W.meta&&re.push({type:"completion-meta",value:W.meta}),W.message&&re.push({type:"completion-message",value:W.message}),re},_.$updateOnChange=g,_.start=g,p.session.$computeWidth=function(){return this.screenWidth=0},p.isOpen=!1,p.isTopdown=!1,p.autoSelect=!0,p.filterText="",p.isMouseOver=!1,p.data=[],p.setData=function(F,T){p.filterText=T||"",p.setValue(u.stringRepeat(`
`,F.length),-1),p.data=F||[],p.setRow(0)},p.getData=function(F){return p.data[F]},p.getRow=function(){return E.start.row},p.setRow=function(F){F=Math.max(this.autoSelect?0:-1,Math.min(this.data.length-1,F)),E.start.row!=F&&(p.selection.clearSelection(),E.start.row=E.end.row=F||0,p.session._emit("changeBackMarker"),p.moveCursorTo(F||0,0),p.isOpen&&p._signal("select"))},p.on("changeSelection",function(){p.isOpen&&p.setRow(p.selection.lead.row),p.renderer.scrollCursorIntoView()}),p.hide=function(){this.container.style.display="none",p.anchorPos=null,p.anchor=null,p.isOpen&&(p.isOpen=!1,this._signal("hide"))},p.tryShow=function(F,T,W,re){if(!re&&p.isOpen&&p.anchorPos&&p.anchor&&p.anchorPos.top===F.top&&p.anchorPos.left===F.left&&p.anchor===W)return!0;var Z=this.container,ce=window.innerHeight,le=window.innerWidth,V=this.renderer,z=V.$maxLines*T*1.4,j={top:0,bottom:0,left:0},K=ce-F.top-3*this.$borderSize-T,Se=F.top-3*this.$borderSize;W||(Se<=K||K>=z?W="bottom":W="top"),W==="top"?(j.bottom=F.top-this.$borderSize,j.top=j.bottom-z):W==="bottom"&&(j.top=F.top+T+this.$borderSize,j.bottom=j.top+z);var ue=j.top>=0&&j.bottom<=ce;if(!re&&!ue)return!1;ue?V.$maxPixelHeight=null:W==="top"?V.$maxPixelHeight=Se:V.$maxPixelHeight=K,W==="top"?(Z.style.top="",Z.style.bottom=ce-j.bottom+"px",p.isTopdown=!1):(Z.style.top=j.top+"px",Z.style.bottom="",p.isTopdown=!0),Z.style.display="";var ke=F.left;return ke+Z.offsetWidth>le&&(ke=le-Z.offsetWidth),Z.style.left=ke+"px",Z.style.right="",p.isOpen||(p.isOpen=!0,this._signal("show"),m=null),p.anchorPos=F,p.anchor=W,!0},p.show=function(F,T,W){this.tryShow(F,T,W?"bottom":void 0,!0)},p.goTo=function(F){var T=this.getRow(),W=this.session.getLength()-1;switch(F){case"up":T=T<=0?W:T-1;break;case"down":T=T>=W?-1:T+1;break;case"start":T=0;break;case"end":T=W}this.setRow(T)},p.getTextLeftOffset=function(){return this.$borderSize+this.renderer.$padding+this.$imageSize},p.$imageSize=0,p.$borderSize=1,p}return N}();c.importCssString(`
.ace_editor.ace_autocomplete .ace_marker-layer .ace_active-line {
    background-color: #CAD6FA;
    z-index: 1;
}
.ace_dark.ace_editor.ace_autocomplete .ace_marker-layer .ace_active-line {
    background-color: #3a674e;
}
.ace_editor.ace_autocomplete .ace_line-hover {
    border: 1px solid #abbffe;
    margin-top: -1px;
    background: rgba(233,233,253,0.4);
    position: absolute;
    z-index: 2;
}
.ace_dark.ace_editor.ace_autocomplete .ace_line-hover {
    border: 1px solid rgba(109, 150, 13, 0.8);
    background: rgba(58, 103, 78, 0.62);
}
.ace_completion-meta {
    opacity: 0.5;
    margin-left: 0.9em;
}
.ace_completion-message {
    margin-left: 0.9em;
    color: blue;
}
.ace_editor.ace_autocomplete .ace_completion-highlight{
    color: #2d69c7;
}
.ace_dark.ace_editor.ace_autocomplete .ace_completion-highlight{
    color: #93ca12;
}
.ace_editor.ace_autocomplete {
    width: 300px;
    z-index: 200000;
    border: 1px lightgray solid;
    position: fixed;
    box-shadow: 2px 3px 5px rgba(0,0,0,.2);
    line-height: 1.4;
    background: #fefefe;
    color: #111;
}
.ace_dark.ace_editor.ace_autocomplete {
    border: 1px #484747 solid;
    box-shadow: 2px 3px 5px rgba(0, 0, 0, 0.51);
    line-height: 1.4;
    background: #25282c;
    color: #c1c1c1;
}
.ace_autocomplete .ace_text-layer  {
    width: calc(100% - 8px);
}
.ace_autocomplete .ace_line {
    display: flex;
    align-items: center;
}
.ace_autocomplete .ace_line > * {
    min-width: 0;
    flex: 0 0 auto;
}
.ace_autocomplete .ace_line .ace_ {
    flex: 0 1 auto;
    overflow: hidden;
    text-overflow: ellipsis;
}
.ace_autocomplete .ace_completion-spacer {
    flex: 1;
}
.ace_autocomplete.ace_loading:after  {
    content: "";
    position: absolute;
    top: 0px;
    height: 2px;
    width: 8%;
    background: blue;
    z-index: 100;
    animation: ace_progress 3s infinite linear;
    animation-delay: 300ms;
    transform: translateX(-100%) scaleX(1);
}
@keyframes ace_progress {
    0% { transform: translateX(-100%) scaleX(1) }
    50% { transform: translateX(625%) scaleX(2) } 
    100% { transform: translateX(1500%) scaleX(3) } 
}
@media (prefers-reduced-motion) {
    .ace_autocomplete.ace_loading:after {
        transform: translateX(625%) scaleX(2);
        animation: none;
     }
}
`,"autocompletion.css",!1),i.AcePopup=oe,i.$singleLineEditor=te,i.getAriaId=H}),ace.define("ace/autocomplete/inline_screenreader",["require","exports","module"],function(A,i,D){"use strict";var f=function(){function v(C){this.editor=C,this.screenReaderDiv=document.createElement("div"),this.screenReaderDiv.classList.add("ace_screenreader-only"),this.editor.container.appendChild(this.screenReaderDiv)}return v.prototype.setScreenReaderContent=function(C){for(!this.popup&&this.editor.completer&&this.editor.completer.popup&&(this.popup=this.editor.completer.popup,this.popup.renderer.on("afterRender",function(){var u=this.popup.getRow(),c=this.popup.renderer.$textLayer,S=c.element.childNodes[u-c.config.firstRow];if(S){for(var P="doc-tooltip ",H=0;H<this._lines.length;H++)P+="ace-inline-screenreader-line-".concat(H," ");S.setAttribute("aria-describedby",P)}}.bind(this)));this.screenReaderDiv.firstChild;)this.screenReaderDiv.removeChild(this.screenReaderDiv.firstChild);this._lines=C.split(/\r\n|\r|\n/);var l=this.createCodeBlock();this.screenReaderDiv.appendChild(l)},v.prototype.destroy=function(){this.screenReaderDiv.remove()},v.prototype.createCodeBlock=function(){var C=document.createElement("pre");C.setAttribute("id","ace-inline-screenreader");for(var l=0;l<this._lines.length;l++){var u=document.createElement("code");u.setAttribute("id","ace-inline-screenreader-line-".concat(l));var c=document.createTextNode(this._lines[l]);u.appendChild(c),C.appendChild(u)}return C},v}();i.AceInlineScreenReader=f}),ace.define("ace/autocomplete/inline",["require","exports","module","ace/snippets","ace/autocomplete/inline_screenreader"],function(A,i,D){"use strict";var f=A("../snippets").snippetManager,v=A("./inline_screenreader").AceInlineScreenReader,C=function(){function l(){this.editor=null}return l.prototype.show=function(u,c,S){if(S=S||"",u&&this.editor&&this.editor!==u&&(this.hide(),this.editor=null,this.inlineScreenReader=null),!u||!c)return!1;this.inlineScreenReader||(this.inlineScreenReader=new v(u));var P=c.snippet?f.getDisplayTextForSnippet(u,c.snippet):c.value;return c.hideInlinePreview||!P||!P.startsWith(S)?!1:(this.editor=u,this.inlineScreenReader.setScreenReaderContent(P),P=P.slice(S.length),P===""?u.removeGhostText():u.setGhostText(P),!0)},l.prototype.isOpen=function(){return this.editor?!!this.editor.renderer.$ghostText:!1},l.prototype.hide=function(){return this.editor?(this.editor.removeGhostText(),!0):!1},l.prototype.destroy=function(){this.hide(),this.editor=null,this.inlineScreenReader&&(this.inlineScreenReader.destroy(),this.inlineScreenReader=null)},l}();i.AceInline=C}),ace.define("ace/autocomplete/util",["require","exports","module"],function(A,i,D){"use strict";i.parForEach=function(v,C,l){var u=0,c=v.length;c===0&&l();for(var S=0;S<c;S++)C(v[S],function(P,H){u++,u===c&&l(P,H)})};var f=/[a-zA-Z_0-9\$\-\u00A2-\u2000\u2070-\uFFFF]/;i.retrievePrecedingIdentifier=function(v,C,l){l=l||f;for(var u=[],c=C-1;c>=0&&l.test(v[c]);c--)u.push(v[c]);return u.reverse().join("")},i.retrieveFollowingIdentifier=function(v,C,l){l=l||f;for(var u=[],c=C;c<v.length&&l.test(v[c]);c++)u.push(v[c]);return u},i.getCompletionPrefix=function(v){var C=v.getCursorPosition(),l=v.session.getLine(C.row),u;return v.completers.forEach(function(c){c.identifierRegexps&&c.identifierRegexps.forEach(function(S){!u&&S&&(u=this.retrievePrecedingIdentifier(l,C.column,S))}.bind(this))}.bind(this)),u||this.retrievePrecedingIdentifier(l,C.column)},i.triggerAutocomplete=function(v,l){var l=l==null?v.session.getPrecedingCharacter():l;return v.completers.some(function(u){if(u.triggerCharacters&&Array.isArray(u.triggerCharacters))return u.triggerCharacters.includes(l)})}}),ace.define("ace/autocomplete",["require","exports","module","ace/keyboard/hash_handler","ace/autocomplete/popup","ace/autocomplete/inline","ace/autocomplete/popup","ace/autocomplete/util","ace/lib/lang","ace/lib/dom","ace/snippets","ace/config","ace/lib/event","ace/lib/scroll"],function(A,i,D){"use strict";var f=A("./keyboard/hash_handler").HashHandler,v=A("./autocomplete/popup").AcePopup,C=A("./autocomplete/inline").AceInline,l=A("./autocomplete/popup").getAriaId,u=A("./autocomplete/util"),c=A("./lib/lang"),S=A("./lib/dom"),P=A("./snippets").snippetManager,H=A("./config"),Q=A("./lib/event"),R=A("./lib/scroll").preventParentScroll,J=function(d,y){y.completer&&y.completer.destroy()},te=function(){function d(){this.autoInsert=!1,this.autoSelect=!0,this.autoShown=!1,this.exactMatch=!1,this.inlineEnabled=!1,this.keyboardHandler=new f,this.keyboardHandler.bindKeys(this.commands),this.parentNode=null,this.setSelectOnHover=!1,this.hasSeen=new Set,this.showLoadingState=!1,this.stickySelectionDelay=500,this.blurListener=this.blurListener.bind(this),this.changeListener=this.changeListener.bind(this),this.mousedownListener=this.mousedownListener.bind(this),this.mousewheelListener=this.mousewheelListener.bind(this),this.onLayoutChange=this.onLayoutChange.bind(this),this.changeTimer=c.delayedCall(function(){this.updateCompletions(!0)}.bind(this)),this.tooltipTimer=c.delayedCall(this.updateDocTooltip.bind(this),50),this.popupTimer=c.delayedCall(this.$updatePopupPosition.bind(this),50),this.stickySelectionTimer=c.delayedCall(function(){this.stickySelection=!0}.bind(this),this.stickySelectionDelay),this.$firstOpenTimer=c.delayedCall(function(){var y=this.completionProvider&&this.completionProvider.initialPosition;this.autoShown||this.popup&&this.popup.isOpen||!y||this.editor.completers.length===0||(this.completions=new N(d.completionsForLoading),this.openPopup(this.editor,y.prefix,!1),this.popup.renderer.setStyle("ace_loading",!0))}.bind(this),this.stickySelectionDelay)}return Object.defineProperty(d,"completionsForLoading",{get:function(){return[{caption:H.nls("autocomplete.loading","Loading..."),value:""}]},enumerable:!1,configurable:!0}),d.prototype.$init=function(){return this.popup=new v(this.parentNode||document.body||document.documentElement),this.popup.on("click",function(y){this.insertMatch(),y.stop()}.bind(this)),this.popup.focus=this.editor.focus.bind(this.editor),this.popup.on("show",this.$onPopupShow.bind(this)),this.popup.on("hide",this.$onHidePopup.bind(this)),this.popup.on("select",this.$onPopupChange.bind(this)),Q.addListener(this.popup.container,"mouseout",this.mouseOutListener.bind(this)),this.popup.on("changeHoverMarker",this.tooltipTimer.bind(null,null)),this.popup.renderer.on("afterRender",this.$onPopupRender.bind(this)),this.popup},d.prototype.$initInline=function(){if(!(!this.inlineEnabled||this.inlineRenderer))return this.inlineRenderer=new C,this.inlineRenderer},d.prototype.getPopup=function(){return this.popup||this.$init()},d.prototype.$onHidePopup=function(){this.inlineRenderer&&this.inlineRenderer.hide(),this.hideDocTooltip(),this.stickySelectionTimer.cancel(),this.popupTimer.cancel(),this.stickySelection=!1},d.prototype.$seen=function(y){!this.hasSeen.has(y)&&y&&y.completer&&y.completer.onSeen&&typeof y.completer.onSeen=="function"&&(y.completer.onSeen(this.editor,y),this.hasSeen.add(y))},d.prototype.$onPopupChange=function(y){if(this.inlineRenderer&&this.inlineEnabled){var p=y?null:this.popup.getData(this.popup.getRow());if(this.$updateGhostText(p),this.popup.isMouseOver&&this.setSelectOnHover){this.tooltipTimer.call(null,null);return}this.popupTimer.schedule(),this.tooltipTimer.schedule()}else this.popupTimer.call(null,null),this.tooltipTimer.call(null,null)},d.prototype.$updateGhostText=function(y){var p=this.base.row,g=this.base.column,m=this.editor.getCursorPosition().column,b=this.editor.session.getLine(p).slice(g,m);this.inlineRenderer.show(this.editor,y,b)?this.$seen(y):this.inlineRenderer.hide()},d.prototype.$onPopupRender=function(){var y=this.inlineRenderer&&this.inlineEnabled;if(this.completions&&this.completions.filtered&&this.completions.filtered.length>0)for(var p=this.popup.getFirstVisibleRow();p<=this.popup.getLastVisibleRow();p++){var g=this.popup.getData(p);g&&(!y||g.hideInlinePreview)&&this.$seen(g)}},d.prototype.$onPopupShow=function(y){this.$onPopupChange(y),this.stickySelection=!1,this.stickySelectionDelay>=0&&this.stickySelectionTimer.schedule(this.stickySelectionDelay)},d.prototype.observeLayoutChanges=function(){if(!(this.$elements||!this.editor)){window.addEventListener("resize",this.onLayoutChange,{passive:!0}),window.addEventListener("wheel",this.mousewheelListener);for(var y=this.editor.container.parentNode,p=[];y;)p.push(y),y.addEventListener("scroll",this.onLayoutChange,{passive:!0}),y=y.parentNode;this.$elements=p}},d.prototype.unObserveLayoutChanges=function(){var y=this;window.removeEventListener("resize",this.onLayoutChange,{passive:!0}),window.removeEventListener("wheel",this.mousewheelListener),this.$elements&&this.$elements.forEach(function(p){p.removeEventListener("scroll",y.onLayoutChange,{passive:!0})}),this.$elements=null},d.prototype.onLayoutChange=function(){if(!this.popup.isOpen)return this.unObserveLayoutChanges();this.$updatePopupPosition(),this.updateDocTooltip()},d.prototype.$updatePopupPosition=function(){var y=this.editor,p=y.renderer,g=p.layerConfig.lineHeight,m=p.$cursorLayer.getPixelPosition(this.base,!0);m.left-=this.popup.getTextLeftOffset();var b=y.container.getBoundingClientRect();m.top+=b.top-p.layerConfig.offset,m.left+=b.left-y.renderer.scrollLeft,m.left+=p.gutterWidth;var E={top:m.top,left:m.left};p.$ghostText&&p.$ghostTextWidget&&this.base.row===p.$ghostText.position.row&&(E.top+=p.$ghostTextWidget.el.offsetHeight);var k=y.container.getBoundingClientRect().bottom-g,B=k<E.top?{top:k,left:E.left}:E;this.popup.tryShow(B,g,"bottom")||this.popup.tryShow(m,g,"top")||this.popup.show(m,g)},d.prototype.openPopup=function(y,p,g){this.$firstOpenTimer.cancel(),this.popup||this.$init(),this.inlineEnabled&&!this.inlineRenderer&&this.$initInline(),this.popup.autoSelect=this.autoSelect,this.popup.setSelectOnHover(this.setSelectOnHover);var m=this.popup.getRow(),b=this.popup.data[m];this.popup.setData(this.completions.filtered,this.completions.filterText),this.editor.textInput.setAriaOptions&&this.editor.textInput.setAriaOptions({activeDescendant:l(this.popup.getRow()),inline:this.inlineEnabled}),y.keyBinding.addKeyboardHandler(this.keyboardHandler);var E;this.stickySelection&&(E=this.popup.data.indexOf(b)),(!E||E===-1)&&(E=0),this.popup.setRow(this.autoSelect?E:-1),E===m&&b!==this.completions.filtered[E]&&this.$onPopupChange();var k=this.inlineRenderer&&this.inlineEnabled;if(E===m&&k){var B=this.popup.getData(this.popup.getRow());this.$updateGhostText(B)}g||(this.popup.setTheme(y.getTheme()),this.popup.setFontSize(y.getFontSize()),this.$updatePopupPosition(),this.tooltipNode&&this.updateDocTooltip()),this.changeTimer.cancel(),this.observeLayoutChanges()},d.prototype.detach=function(){this.editor&&(this.editor.keyBinding.removeKeyboardHandler(this.keyboardHandler),this.editor.off("changeSelection",this.changeListener),this.editor.off("blur",this.blurListener),this.editor.off("mousedown",this.mousedownListener),this.editor.off("mousewheel",this.mousewheelListener)),this.$firstOpenTimer.cancel(),this.changeTimer.cancel(),this.hideDocTooltip(),this.completionProvider&&this.completionProvider.detach(),this.popup&&this.popup.isOpen&&this.popup.hide(),this.popup&&this.popup.renderer&&this.popup.renderer.off("afterRender",this.$onPopupRender),this.base&&this.base.detach(),this.activated=!1,this.completionProvider=this.completions=this.base=null,this.unObserveLayoutChanges()},d.prototype.changeListener=function(y){var p=this.editor.selection.lead;(p.row!=this.base.row||p.column<this.base.column)&&this.detach(),this.activated?this.changeTimer.schedule():this.detach()},d.prototype.blurListener=function(y){var p=document.activeElement,g=this.editor.textInput.getElement(),m=y.relatedTarget&&this.tooltipNode&&this.tooltipNode.contains(y.relatedTarget),b=this.popup&&this.popup.container;p!=g&&p.parentNode!=b&&!m&&p!=this.tooltipNode&&y.relatedTarget!=g&&this.detach()},d.prototype.mousedownListener=function(y){this.detach()},d.prototype.mousewheelListener=function(y){this.popup&&!this.popup.isMouseOver&&this.detach()},d.prototype.mouseOutListener=function(y){this.popup.isOpen&&this.$updatePopupPosition()},d.prototype.goTo=function(y){this.popup.goTo(y)},d.prototype.insertMatch=function(y,p){if(y||(y=this.popup.getData(this.popup.getRow())),!y)return!1;if(y.value==="")return this.detach();var g=this.completions,m=this.getCompletionProvider().insertMatch(this.editor,y,g.filterText,p);return this.completions==g&&this.detach(),m},d.prototype.showPopup=function(y,p){this.editor&&this.detach(),this.activated=!0,this.editor=y,y.completer!=this&&(y.completer&&y.completer.detach(),y.completer=this),y.on("changeSelection",this.changeListener),y.on("blur",this.blurListener),y.on("mousedown",this.mousedownListener),y.on("mousewheel",this.mousewheelListener),this.updateCompletions(!1,p)},d.prototype.getCompletionProvider=function(y){return this.completionProvider||(this.completionProvider=new oe(y)),this.completionProvider},d.prototype.gatherCompletions=function(y,p){return this.getCompletionProvider().gatherCompletions(y,p)},d.prototype.updateCompletions=function(y,p){if(y&&this.base&&this.completions){var m=this.editor.getCursorPosition(),b=this.editor.session.getTextRange({start:this.base,end:m});if(b==this.completions.filterText)return;if(this.completions.setFilter(b),!this.completions.filtered.length)return this.detach();if(this.completions.filtered.length==1&&this.completions.filtered[0].value==b&&!this.completions.filtered[0].snippet)return this.detach();this.openPopup(this.editor,b,y);return}if(p&&p.matches){var m=this.editor.getSelectionRange().start;return this.base=this.editor.session.doc.createAnchor(m.row,m.column),this.base.$insertRight=!0,this.completions=new N(p.matches),this.getCompletionProvider().completions=this.completions,this.openPopup(this.editor,"",y)}var g=this.editor.getSession(),m=this.editor.getCursorPosition(),b=u.getCompletionPrefix(this.editor);this.base=g.doc.createAnchor(m.row,m.column-b.length),this.base.$insertRight=!0;var E={exactMatch:this.exactMatch,ignoreCaption:this.ignoreCaption};this.getCompletionProvider({prefix:b,pos:m}).provideCompletions(this.editor,E,function(k,B,_){var F=B.filtered,T=u.getCompletionPrefix(this.editor);if(this.$firstOpenTimer.cancel(),_){if(!F.length){var W=!this.autoShown&&this.emptyMessage;if(typeof W=="function"&&(W=this.emptyMessage(T)),W){var re=[{caption:W,value:""}];this.completions=new N(re),this.openPopup(this.editor,T,y),this.popup.renderer.setStyle("ace_loading",!1),this.popup.renderer.setStyle("ace_empty-message",!0);return}return this.detach()}if(F.length==1&&F[0].value==T&&!F[0].snippet)return this.detach();if(this.autoInsert&&!this.autoShown&&F.length==1)return this.insertMatch(F[0])}this.completions=!_&&this.showLoadingState?new N(d.completionsForLoading.concat(F),B.filterText):B,this.openPopup(this.editor,T,y),this.popup.renderer.setStyle("ace_empty-message",!1),this.popup.renderer.setStyle("ace_loading",!_)}.bind(this)),this.showLoadingState&&!this.autoShown&&(!this.popup||!this.popup.isOpen)&&this.$firstOpenTimer.delay(this.stickySelectionDelay/2)},d.prototype.cancelContextMenu=function(){this.editor.$mouseHandler.cancelContextMenu()},d.prototype.updateDocTooltip=function(){var y=this.popup,p=this.completions.filtered,g=p&&(p[y.getHoveredRow()]||p[y.getRow()]),m=null;if(!g||!this.editor||!this.popup.isOpen)return this.hideDocTooltip();for(var b=this.editor.completers.length,E=0;E<b;E++){var k=this.editor.completers[E];if(k.getDocTooltip&&g.completerId===k.id){m=k.getDocTooltip(g);break}}if(!m&&typeof g!="string"&&(m=g),typeof m=="string"&&(m={docText:m}),!m||!m.docHTML&&!m.docText)return this.hideDocTooltip();this.showDocTooltip(m)},d.prototype.showDocTooltip=function(y){this.tooltipNode||(this.tooltipNode=S.createElement("div"),this.tooltipNode.style.margin="0",this.tooltipNode.style.pointerEvents="auto",this.tooltipNode.style.overscrollBehavior="contain",this.tooltipNode.tabIndex=-1,this.tooltipNode.onblur=this.blurListener.bind(this),this.tooltipNode.onclick=this.onTooltipClick.bind(this),this.tooltipNode.id="doc-tooltip",this.tooltipNode.setAttribute("role","tooltip"),this.tooltipNode.addEventListener("wheel",R));var p=this.editor.renderer.theme;this.tooltipNode.className="ace_tooltip ace_doc-tooltip "+(p.isDark?"ace_dark ":"")+(p.cssClass||"");var g=this.tooltipNode;y.docHTML?g.innerHTML=y.docHTML:y.docText&&(g.textContent=y.docText),g.parentNode||this.popup.container.appendChild(this.tooltipNode);var m=this.popup,b=m.container.getBoundingClientRect();g.style.top=m.container.style.top,g.style.bottom=m.container.style.bottom,g.style.display="block",window.innerWidth-b.right<320?b.left<320?m.isTopdown?(g.style.top=b.bottom+"px",g.style.left=b.left+"px",g.style.right="",g.style.bottom=""):(g.style.top=m.container.offsetTop-g.offsetHeight+"px",g.style.left=b.left+"px",g.style.right="",g.style.bottom=""):(g.style.right=window.innerWidth-b.left+"px",g.style.left=""):(g.style.left=b.right+1+"px",g.style.right="")},d.prototype.hideDocTooltip=function(){if(this.tooltipTimer.cancel(),!!this.tooltipNode){var y=this.tooltipNode;!this.editor.isFocused()&&document.activeElement==y&&this.editor.focus(),this.tooltipNode=null,y.parentNode&&y.parentNode.removeChild(y)}},d.prototype.onTooltipClick=function(y){for(var p=y.target;p&&p!=this.tooltipNode;){if(p.nodeName=="A"&&p.href){p.rel="noreferrer",p.target="_blank";break}p=p.parentNode}},d.prototype.destroy=function(){if(this.detach(),this.popup){this.popup.destroy();var y=this.popup.container;y&&y.parentNode&&y.parentNode.removeChild(y)}this.editor&&this.editor.completer==this&&(this.editor.off("destroy",J),this.editor.completer=null),this.inlineRenderer=this.popup=this.editor=null},d}();te.prototype.commands={Up:function(d){d.completer.goTo("up")},Down:function(d){d.completer.goTo("down")},"Ctrl-Up|Ctrl-Home":function(d){d.completer.goTo("start")},"Ctrl-Down|Ctrl-End":function(d){d.completer.goTo("end")},Esc:function(d){d.completer.detach()},Return:function(d){return d.completer.insertMatch()},"Shift-Return":function(d){d.completer.insertMatch(null,{deleteSuffix:!0})},Tab:function(d){var y=d.completer.insertMatch();if(y||d.tabstopManager)return y;d.completer.goTo("down")},Backspace:function(d){d.execCommand("backspace");var y=u.getCompletionPrefix(d);!y&&d.completer&&d.completer.detach()},PageUp:function(d){d.completer.popup.gotoPageUp()},PageDown:function(d){d.completer.popup.gotoPageDown()}},te.for=function(d){return d.completer instanceof te||(d.completer&&(d.completer.destroy(),d.completer=null),H.get("sharedPopups")?(te.$sharedInstance||(te.$sharedInstance=new te),d.completer=te.$sharedInstance):(d.completer=new te,d.once("destroy",J))),d.completer},te.startCommand={name:"startAutocomplete",exec:function(d,y){var p=te.for(d);p.autoInsert=!1,p.autoSelect=!0,p.autoShown=!1,p.showPopup(d,y),p.cancelContextMenu()},bindKey:"Ctrl-Space|Ctrl-Shift-Space|Alt-Space"};var oe=function(){function d(y){this.initialPosition=y,this.active=!0}return d.prototype.insertByIndex=function(y,p,g){return!this.completions||!this.completions.filtered?!1:this.insertMatch(y,this.completions.filtered[p],g)},d.prototype.insertMatch=function(y,p,g){if(!p)return!1;if(y.startOperation({command:{name:"insertMatch"}}),p.completer&&p.completer.insertMatch)p.completer.insertMatch(y,p);else{if(!this.completions)return!1;var m=this.completions.filterText.length,b=0;if(p.range&&p.range.start.row===p.range.end.row&&(m-=this.initialPosition.prefix.length,m+=this.initialPosition.pos.column-p.range.start.column,b+=p.range.end.column-this.initialPosition.pos.column),m||b){var E;y.selection.getAllRanges?E=y.selection.getAllRanges():E=[y.getSelectionRange()];for(var k=0,B;B=E[k];k++)B.start.column-=m,B.end.column+=b,y.session.remove(B)}p.snippet?P.insertSnippet(y,p.snippet):this.$insertString(y,p),p.completer&&p.completer.onInsert&&typeof p.completer.onInsert=="function"&&p.completer.onInsert(y,p),p.command&&p.command==="startAutocomplete"&&y.execCommand(p.command)}return y.endOperation(),!0},d.prototype.$insertString=function(y,p){var g=p.value||p;y.execCommand("insertstring",g)},d.prototype.gatherCompletions=function(y,p){var g=y.getSession(),m=y.getCursorPosition(),b=u.getCompletionPrefix(y),E=[];this.completers=y.completers;var k=y.completers.length;return y.completers.forEach(function(B,_){B.getCompletions(y,g,m,b,function(F,T){B.hideInlinePreview&&(T=T.map(function(W){return Object.assign(W,{hideInlinePreview:B.hideInlinePreview})})),!F&&T&&(E=E.concat(T)),p(null,{prefix:u.getCompletionPrefix(y),matches:E,finished:--k===0})})}),!0},d.prototype.provideCompletions=function(y,p,g){var m=function(B){var _=B.prefix,F=B.matches;this.completions=new N(F),p.exactMatch&&(this.completions.exactMatch=!0),p.ignoreCaption&&(this.completions.ignoreCaption=!0),this.completions.setFilter(_),(B.finished||this.completions.filtered.length)&&g(null,this.completions,B.finished)}.bind(this),b=!0,E=null;if(this.gatherCompletions(y,function(B,_){if(this.active){B&&(g(B,[],!0),this.detach());var F=_.prefix;if(F.indexOf(_.prefix)===0){if(b){E=_;return}m(_)}}}.bind(this)),b=!1,E){var k=E;E=null,m(k)}},d.prototype.detach=function(){this.active=!1,this.completers&&this.completers.forEach(function(y){typeof y.cancel=="function"&&y.cancel()})},d}(),N=function(){function d(y,p){this.all=y,this.filtered=y,this.filterText=p||"",this.exactMatch=!1,this.ignoreCaption=!1}return d.prototype.setFilter=function(y){if(y.length>this.filterText&&y.lastIndexOf(this.filterText,0)===0)var p=this.filtered;else var p=this.all;this.filterText=y,p=this.filterCompletions(p,this.filterText),p=p.sort(function(m,b){return b.exactMatch-m.exactMatch||b.$score-m.$score||(m.caption||m.value).localeCompare(b.caption||b.value)});var g=null;p=p.filter(function(m){var b=m.snippet||m.caption||m.value;return b===g?!1:(g=b,!0)}),this.filtered=p},d.prototype.filterCompletions=function(y,p){var g=[],m=p.toUpperCase(),b=p.toLowerCase();e:for(var E=0,k;k=y[E];E++){var B=!this.ignoreCaption&&k.caption||k.value||k.snippet;if(B){var _=-1,F=0,T=0,W,re;if(this.exactMatch){if(p!==B.substr(0,p.length))continue e}else{var Z=B.toLowerCase().indexOf(b);if(Z>-1)T=Z;else for(var ce=0;ce<p.length;ce++){var le=B.indexOf(b[ce],_+1),V=B.indexOf(m[ce],_+1);if(W=le>=0&&(V<0||le<V)?le:V,W<0)continue e;re=W-_-1,re>0&&(_===-1&&(T+=10),T+=re,F|=1<<ce),_=W}}k.matchMask=F,k.exactMatch=T?0:1,k.$score=(k.score||0)-T,g.push(k)}}return g},d}();i.Autocomplete=te,i.CompletionProvider=oe,i.FilteredList=N}),ace.define("ace/autocomplete/text_completer",["require","exports","module","ace/range"],function(A,i,D){function f(u,c){var S=u.getTextRange(C.fromPoints({row:0,column:0},c));return S.split(l).length-1}function v(u,c){var S=f(u,c),P=u.getValue().split(l),H=Object.create(null),Q=P[S];return P.forEach(function(R,J){if(!(!R||R===Q)){var te=Math.abs(S-J),oe=P.length-te;H[R]?H[R]=Math.max(oe,H[R]):H[R]=oe}}),H}var C=A("../range").Range,l=/[^a-zA-Z_0-9\$\-\u00C0-\u1FFF\u2C00-\uD7FF\w]+/;i.getCompletions=function(u,c,S,P,H){var Q=v(c,S),R=Object.keys(Q);H(null,R.map(function(J){return{caption:J,value:J,score:Q[J],meta:"local"}}))}}),ace.define("ace/ext/language_tools",["require","exports","module","ace/snippets","ace/autocomplete","ace/config","ace/lib/lang","ace/autocomplete/util","ace/autocomplete/text_completer","ace/editor","ace/config"],function(A,i,D){"use strict";var f=A("../snippets").snippetManager,v=A("../autocomplete").Autocomplete,C=A("../config"),l=A("../lib/lang"),u=A("../autocomplete/util"),c=A("../autocomplete/text_completer"),S={getCompletions:function(m,b,E,k,B){if(b.$mode.completer)return b.$mode.completer.getCompletions(m,b,E,k,B);var _=m.session.getState(E.row),F=b.$mode.getCompletions(_,b,E,k);F=F.map(function(T){return T.completerId=S.id,T}),B(null,F)},id:"keywordCompleter"},P=function(m){var b={};return m.replace(/\${(\d+)(:(.*?))?}/g,function(E,k,B,_){return b[k]=_||""}).replace(/\$(\d+?)/g,function(E,k){return b[k]})},H={getCompletions:function(m,b,E,k,B){var _=[],F=b.getTokenAt(E.row,E.column);F&&F.type.match(/(tag-name|tag-open|tag-whitespace|attribute-name|attribute-value)\.xml$/)?_.push("html-tag"):_=f.getActiveScopes(m);var T=f.snippetMap,W=[];_.forEach(function(re){for(var Z=T[re]||[],ce=Z.length;ce--;){var le=Z[ce],V=le.name||le.tabTrigger;V&&W.push({caption:V,snippet:le.content,meta:le.tabTrigger&&!le.name?le.tabTrigger+"\u21E5 ":"snippet",completerId:H.id})}},this),B(null,W)},getDocTooltip:function(m){m.snippet&&!m.docHTML&&(m.docHTML=["<b>",l.escapeHTML(m.caption),"</b>","<hr></hr>",l.escapeHTML(P(m.snippet))].join(""))},id:"snippetCompleter"},Q=[H,c,S];i.setCompleters=function(m){Q.length=0,m&&Q.push.apply(Q,m)},i.addCompleter=function(m){Q.push(m)},i.textCompleter=c,i.keyWordCompleter=S,i.snippetCompleter=H;var R={name:"expandSnippet",exec:function(m){return f.expandWithTab(m)},bindKey:"Tab"},J=function(m,b){te(b.session.$mode)},te=function(m){typeof m=="string"&&(m=C.$modes[m]),m&&(f.files||(f.files={}),oe(m.$id,m.snippetFileId),m.modes&&m.modes.forEach(te))},oe=function(m,b){!b||!m||f.files[m]||(f.files[m]={},C.loadModule(b,function(E){E&&(f.files[m]=E,!E.snippets&&E.snippetText&&(E.snippets=f.parseSnippetFile(E.snippetText)),f.register(E.snippets||[],E.scope),E.includeScopes&&(f.snippetMap[E.scope].includeScopes=E.includeScopes,E.includeScopes.forEach(function(k){te("ace/mode/"+k)})))}))},N=function(m){var b=m.editor,E=b.completer&&b.completer.activated;if(m.command.name==="backspace")E&&!u.getCompletionPrefix(b)&&b.completer.detach();else if(m.command.name==="insertstring"&&!E){d=m;var k=m.editor.$liveAutocompletionDelay;k?y.delay(k):p(m)}},d,y=l.delayedCall(function(){p(d)},0),p=function(m){var b=m.editor,E=u.getCompletionPrefix(b),k=m.args,B=u.triggerAutocomplete(b,k);if(E&&E.length>=b.$liveAutocompletionThreshold||B){var _=v.for(b);_.autoShown=!0,_.showPopup(b)}},g=A("../editor").Editor;A("../config").defineOptions(g.prototype,"editor",{enableBasicAutocompletion:{set:function(m){m?(this.completers||(this.completers=Array.isArray(m)?m:Q),this.commands.addCommand(v.startCommand)):this.commands.removeCommand(v.startCommand)},value:!1},enableLiveAutocompletion:{set:function(m){m?(this.completers||(this.completers=Array.isArray(m)?m:Q),this.commands.on("afterExec",N)):this.commands.off("afterExec",N)},value:!1},liveAutocompletionDelay:{initialValue:0},liveAutocompletionThreshold:{initialValue:0},enableSnippets:{set:function(m){m?(this.commands.addCommand(R),this.on("changeMode",J),J(null,this)):(this.commands.removeCommand(R),this.off("changeMode",J))},value:!1}})}),function(){ace.require(["ace/ext/language_tools"],function(A){M&&(M.exports=A)})}()},7726:(M,ee,G)=>{M=G.nmd(M),ace.define("ace/mode/json_highlight_rules",["require","exports","module","ace/lib/oop","ace/mode/text_highlight_rules"],function(A,i,D){"use strict";var f=A("../lib/oop"),v=A("./text_highlight_rules").TextHighlightRules,C=function(){this.$rules={start:[{token:"variable",regex:'["](?:(?:\\\\.)|(?:[^"\\\\]))*?["]\\s*(?=:)'},{token:"string",regex:'"',next:"string"},{token:"constant.numeric",regex:"0[xX][0-9a-fA-F]+\\b"},{token:"constant.numeric",regex:"[+-]?\\d+(?:(?:\\.\\d*)?(?:[eE][+-]?\\d+)?)?\\b"},{token:"constant.language.boolean",regex:"(?:true|false)\\b"},{token:"text",regex:"['](?:(?:\\\\.)|(?:[^'\\\\]))*?[']"},{token:"comment",regex:"\\/\\/.*$"},{token:"comment.start",regex:"\\/\\*",next:"comment"},{token:"paren.lparen",regex:"[[({]"},{token:"paren.rparen",regex:"[\\])}]"},{token:"punctuation.operator",regex:/[,]/},{token:"text",regex:"\\s+"}],string:[{token:"constant.language.escape",regex:/\\(?:x[0-9a-fA-F]{2}|u[0-9a-fA-F]{4}|["\\\/bfnrt])/},{token:"string",regex:'"|$',next:"start"},{defaultToken:"string"}],comment:[{token:"comment.end",regex:"\\*\\/",next:"start"},{defaultToken:"comment"}]}};f.inherits(C,v),i.JsonHighlightRules=C}),ace.define("ace/mode/matching_brace_outdent",["require","exports","module","ace/range"],function(A,i,D){"use strict";var f=A("../range").Range,v=function(){};(function(){this.checkOutdent=function(C,l){return/^\s+$/.test(C)?/^\s*\}/.test(l):!1},this.autoOutdent=function(C,l){var u=C.getLine(l),c=u.match(/^(\s*\})/);if(!c)return 0;var S=c[1].length,P=C.findMatchingBracket({row:l,column:S});if(!P||P.row==l)return 0;var H=this.$getIndent(C.getLine(P.row));C.replace(new f(l,0,l,S-1),H)},this.$getIndent=function(C){return C.match(/^\s*/)[0]}}).call(v.prototype),i.MatchingBraceOutdent=v}),ace.define("ace/mode/folding/cstyle",["require","exports","module","ace/lib/oop","ace/range","ace/mode/folding/fold_mode"],function(A,i,D){"use strict";var f=A("../../lib/oop"),v=A("../../range").Range,C=A("./fold_mode").FoldMode,l=i.FoldMode=function(u){u&&(this.foldingStartMarker=new RegExp(this.foldingStartMarker.source.replace(/\|[^|]*?$/,"|"+u.start)),this.foldingStopMarker=new RegExp(this.foldingStopMarker.source.replace(/\|[^|]*?$/,"|"+u.end)))};f.inherits(l,C),function(){this.foldingStartMarker=/([\{\[\(])[^\}\]\)]*$|^\s*(\/\*)/,this.foldingStopMarker=/^[^\[\{\(]*([\}\]\)])|^[\s\*]*(\*\/)/,this.singleLineBlockCommentRe=/^\s*(\/\*).*\*\/\s*$/,this.tripleStarBlockCommentRe=/^\s*(\/\*\*\*).*\*\/\s*$/,this.startRegionRe=/^\s*(\/\*|\/\/)#?region\b/,this._getFoldWidgetBase=this.getFoldWidget,this.getFoldWidget=function(u,c,S){var P=u.getLine(S);if(this.singleLineBlockCommentRe.test(P)&&!this.startRegionRe.test(P)&&!this.tripleStarBlockCommentRe.test(P))return"";var H=this._getFoldWidgetBase(u,c,S);return!H&&this.startRegionRe.test(P)?"start":H},this.getFoldWidgetRange=function(u,c,S,P){var H=u.getLine(S);if(this.startRegionRe.test(H))return this.getCommentRegionBlock(u,H,S);var J=H.match(this.foldingStartMarker);if(J){var Q=J.index;if(J[1])return this.openingBracketBlock(u,J[1],S,Q);var R=u.getCommentFoldRange(S,Q+J[0].length,1);return R&&!R.isMultiLine()&&(P?R=this.getSectionRange(u,S):c!="all"&&(R=null)),R}if(c!=="markbegin"){var J=H.match(this.foldingStopMarker);if(J){var Q=J.index+J[0].length;return J[1]?this.closingBracketBlock(u,J[1],S,Q):u.getCommentFoldRange(S,Q,-1)}}},this.getSectionRange=function(u,c){var S=u.getLine(c),P=S.search(/\S/),H=c,Q=S.length;c+=1;for(var R=c,J=u.getLength();++c<J;){S=u.getLine(c);var te=S.search(/\S/);if(te!==-1){if(P>te)break;var oe=this.getFoldWidgetRange(u,"all",c);if(oe){if(oe.start.row<=H)break;if(oe.isMultiLine())c=oe.end.row;else if(P==te)break}R=c}}return new v(H,Q,R,u.getLine(R).length)},this.getCommentRegionBlock=function(u,c,S){for(var P=c.search(/\s*$/),H=u.getLength(),Q=S,R=/^\s*(?:\/\*|\/\/|--)#?(end)?region\b/,J=1;++S<H;){c=u.getLine(S);var te=R.exec(c);if(te&&(te[1]?J--:J++,!J))break}var oe=S;if(oe>Q)return new v(Q,P,oe,c.length)}}.call(l.prototype)}),ace.define("ace/mode/json",["require","exports","module","ace/lib/oop","ace/mode/text","ace/mode/json_highlight_rules","ace/mode/matching_brace_outdent","ace/mode/folding/cstyle","ace/worker/worker_client"],function(A,i,D){"use strict";var f=A("../lib/oop"),v=A("./text").Mode,C=A("./json_highlight_rules").JsonHighlightRules,l=A("./matching_brace_outdent").MatchingBraceOutdent,u=A("./folding/cstyle").FoldMode,c=A("../worker/worker_client").WorkerClient,S=function(){this.HighlightRules=C,this.$outdent=new l,this.$behaviour=this.$defaultBehaviour,this.foldingRules=new u};f.inherits(S,v),function(){this.lineCommentStart="//",this.blockComment={start:"/*",end:"*/"},this.getNextLineIndent=function(P,H,Q){var R=this.$getIndent(H);if(P=="start"){var J=H.match(/^.*[\{\(\[]\s*$/);J&&(R+=Q)}return R},this.checkOutdent=function(P,H,Q){return this.$outdent.checkOutdent(H,Q)},this.autoOutdent=function(P,H,Q){this.$outdent.autoOutdent(H,Q)},this.createWorker=function(P){var H=new c(["ace"],"ace/mode/json_worker","JsonWorker");return H.attachToDocument(P.getDocument()),H.on("annotate",function(Q){P.setAnnotations(Q.data)}),H.on("terminate",function(){P.clearAnnotations()}),H},this.$id="ace/mode/json"}.call(S.prototype),i.Mode=S}),function(){ace.require(["ace/mode/json"],function(A){M&&(M.exports=A)})}()},4210:(M,ee,G)=>{M=G.nmd(M),ace.define("ace/theme/chrome-css",["require","exports","module"],function(A,i,D){D.exports=`.ace-chrome .ace_gutter {
  background: #ebebeb;
  color: #333;
  overflow : hidden;
}

.ace-chrome .ace_print-margin {
  width: 1px;
  background: #e8e8e8;
}

.ace-chrome {
  background-color: #FFFFFF;
  color: black;
}

.ace-chrome .ace_cursor {
  color: black;
}

.ace-chrome .ace_invisible {
  color: rgb(191, 191, 191);
}

.ace-chrome .ace_constant.ace_buildin {
  color: rgb(88, 72, 246);
}

.ace-chrome .ace_constant.ace_language {
  color: rgb(88, 92, 246);
}

.ace-chrome .ace_constant.ace_library {
  color: rgb(6, 150, 14);
}

.ace-chrome .ace_invalid {
  background-color: rgb(153, 0, 0);
  color: white;
}

.ace-chrome .ace_fold {
}

.ace-chrome .ace_support.ace_function {
  color: rgb(60, 76, 114);
}

.ace-chrome .ace_support.ace_constant {
  color: rgb(6, 150, 14);
}

.ace-chrome .ace_support.ace_type,
.ace-chrome .ace_support.ace_class
.ace-chrome .ace_support.ace_other {
  color: rgb(109, 121, 222);
}

.ace-chrome .ace_variable.ace_parameter {
  font-style:italic;
  color:#FD971F;
}
.ace-chrome .ace_keyword.ace_operator {
  color: rgb(104, 118, 135);
}

.ace-chrome .ace_comment {
  color: #236e24;
}

.ace-chrome .ace_comment.ace_doc {
  color: #236e24;
}

.ace-chrome .ace_comment.ace_doc.ace_tag {
  color: #236e24;
}

.ace-chrome .ace_constant.ace_numeric {
  color: rgb(0, 0, 205);
}

.ace-chrome .ace_variable {
  color: rgb(49, 132, 149);
}

.ace-chrome .ace_xml-pe {
  color: rgb(104, 104, 91);
}

.ace-chrome .ace_entity.ace_name.ace_function {
  color: #0000A2;
}


.ace-chrome .ace_heading {
  color: rgb(12, 7, 255);
}

.ace-chrome .ace_list {
  color:rgb(185, 6, 144);
}

.ace-chrome .ace_marker-layer .ace_selection {
  background: rgb(181, 213, 255);
}

.ace-chrome .ace_marker-layer .ace_step {
  background: rgb(252, 255, 0);
}

.ace-chrome .ace_marker-layer .ace_stack {
  background: rgb(164, 229, 101);
}

.ace-chrome .ace_marker-layer .ace_bracket {
  margin: -1px 0 0 -1px;
  border: 1px solid rgb(192, 192, 192);
}

.ace-chrome .ace_marker-layer .ace_active-line {
  background: rgba(0, 0, 0, 0.07);
}

.ace-chrome .ace_gutter-active-line {
    background-color : #dcdcdc;
}

.ace-chrome .ace_marker-layer .ace_selected-word {
  background: rgb(250, 250, 255);
  border: 1px solid rgb(200, 200, 250);
}

.ace-chrome .ace_storage,
.ace-chrome .ace_keyword,
.ace-chrome .ace_meta.ace_tag {
  color: rgb(147, 15, 128);
}

.ace-chrome .ace_string.ace_regex {
  color: rgb(255, 0, 0)
}

.ace-chrome .ace_string {
  color: #1A1AA6;
}

.ace-chrome .ace_entity.ace_other.ace_attribute-name {
  color: #994409;
}

.ace-chrome .ace_indent-guide {
  background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAE0lEQVQImWP4////f4bLly//BwAmVgd1/w11/gAAAABJRU5ErkJggg==") right repeat-y;
}
  
.ace-chrome .ace_indent-guide-active {
  background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAAZSURBVHjaYvj///9/hivKyv8BAAAA//8DACLqBhbvk+/eAAAAAElFTkSuQmCC") right repeat-y;
}
`}),ace.define("ace/theme/chrome",["require","exports","module","ace/theme/chrome-css","ace/lib/dom"],function(A,i,D){i.isDark=!1,i.cssClass="ace-chrome",i.cssText=A("./chrome-css");var f=A("../lib/dom");f.importCssString(i.cssText,i.cssClass,!1)}),function(){ace.require(["ace/theme/chrome"],function(A){M&&(M.exports=A)})}()},9285:(M,ee,G)=>{M=G.nmd(M),ace.define("ace/theme/clouds_midnight-css",["require","exports","module"],function(A,i,D){D.exports=`.ace-clouds-midnight .ace_gutter {
  background: #232323;
  color: #929292
}

.ace-clouds-midnight .ace_print-margin {
  width: 1px;
  background: #232323
}

.ace-clouds-midnight {
  background-color: #191919;
  color: #929292
}

.ace-clouds-midnight .ace_cursor {
  color: #7DA5DC
}

.ace-clouds-midnight .ace_marker-layer .ace_selection {
  background: #000000
}

.ace-clouds-midnight.ace_multiselect .ace_selection.ace_start {
  box-shadow: 0 0 3px 0px #191919;
}

.ace-clouds-midnight .ace_marker-layer .ace_step {
  background: rgb(102, 82, 0)
}

.ace-clouds-midnight .ace_marker-layer .ace_bracket {
  margin: -1px 0 0 -1px;
  border: 1px solid #BFBFBF
}

.ace-clouds-midnight .ace_marker-layer .ace_active-line {
  background: rgba(215, 215, 215, 0.031)
}

.ace-clouds-midnight .ace_gutter-active-line {
  background-color: rgba(215, 215, 215, 0.031)
}

.ace-clouds-midnight .ace_marker-layer .ace_selected-word {
  border: 1px solid #000000
}

.ace-clouds-midnight .ace_invisible {
  color: #666
}

.ace-clouds-midnight .ace_keyword,
.ace-clouds-midnight .ace_meta,
.ace-clouds-midnight .ace_support.ace_constant.ace_property-value {
  color: #927C5D
}

.ace-clouds-midnight .ace_keyword.ace_operator {
  color: #4B4B4B
}

.ace-clouds-midnight .ace_keyword.ace_other.ace_unit {
  color: #366F1A
}

.ace-clouds-midnight .ace_constant.ace_language {
  color: #39946A
}

.ace-clouds-midnight .ace_constant.ace_numeric {
  color: #46A609
}

.ace-clouds-midnight .ace_constant.ace_character.ace_entity {
  color: #A165AC
}

.ace-clouds-midnight .ace_invalid {
  color: #FFFFFF;
  background-color: #E92E2E
}

.ace-clouds-midnight .ace_fold {
  background-color: #927C5D;
  border-color: #929292
}

.ace-clouds-midnight .ace_storage,
.ace-clouds-midnight .ace_support.ace_class,
.ace-clouds-midnight .ace_support.ace_function,
.ace-clouds-midnight .ace_support.ace_other,
.ace-clouds-midnight .ace_support.ace_type {
  color: #E92E2E
}

.ace-clouds-midnight .ace_string {
  color: #5D90CD
}

.ace-clouds-midnight .ace_comment {
  color: #3C403B
}

.ace-clouds-midnight .ace_entity.ace_name.ace_tag,
.ace-clouds-midnight .ace_entity.ace_other.ace_attribute-name {
  color: #606060
}

.ace-clouds-midnight .ace_indent-guide {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAEklEQVQImWNgYGBgYHB3d/8PAAOIAdULw8qMAAAAAElFTkSuQmCC) right repeat-y
}

.ace-clouds-midnight .ace_indent-guide-active {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAACCAYAAACZgbYnAAAAEklEQVQIW2PQ1dX9zzBz5sz/ABCcBFFentLlAAAAAElFTkSuQmCC) right repeat-y;
}
`}),ace.define("ace/theme/clouds_midnight",["require","exports","module","ace/theme/clouds_midnight-css","ace/lib/dom"],function(A,i,D){i.isDark=!0,i.cssClass="ace-clouds-midnight",i.cssText=A("./clouds_midnight-css");var f=A("../lib/dom");f.importCssString(i.cssText,i.cssClass,!1)}),function(){ace.require(["ace/theme/clouds_midnight"],function(A){M&&(M.exports=A)})}()},1197:function(){"no use strict";(function(M){function ee(i,D){for(var f=i,v="";f;){var C=D[f];if(typeof C=="string")return C+v;if(C)return C.location.replace(/\/*$/,"/")+(v||C.main||C.name);if(C===!1)return"";var l=f.lastIndexOf("/");if(l===-1)break;v=f.substr(l)+v,f=f.slice(0,l)}return i}if(!(typeof M.window!="undefined"&&M.document)&&!(M.require&&M.define)){M.console||(M.console=function(){var i=Array.prototype.slice.call(arguments,0);postMessage({type:"log",data:i})},M.console.error=M.console.warn=M.console.log=M.console.trace=M.console),M.window=M,M.ace=M,M.onerror=function(i,D,f,v,C){postMessage({type:"error",data:{message:i,data:C&&C.data,file:D,line:f,col:v,stack:C&&C.stack}})},M.normalizeModule=function(i,D){if(D.indexOf("!")!==-1){var f=D.split("!");return M.normalizeModule(i,f[0])+"!"+M.normalizeModule(i,f[1])}if(D.charAt(0)=="."){var v=i.split("/").slice(0,-1).join("/");for(D=(v?v+"/":"")+D;D.indexOf(".")!==-1&&C!=D;){var C=D;D=D.replace(/^\.\//,"").replace(/\/\.\//,"/").replace(/[^\/]+\/\.\.\//,"")}}return D},M.require=function(i,D){if(D||(D=i,i=null),!D.charAt)throw new Error("worker.js require() accepts only (parentId, id) as arguments");D=M.normalizeModule(i,D);var f=M.require.modules[D];if(f)return f.initialized||(f.initialized=!0,f.exports=f.factory().exports),f.exports;if(!M.require.tlns)return console.log("unable to load "+D);var v=ee(D,M.require.tlns);return v.slice(-3)!=".js"&&(v+=".js"),M.require.id=D,M.require.modules[D]={},importScripts(v),M.require(i,D)},M.require.modules={},M.require.tlns={},M.define=function(i,D,f){if(arguments.length==2?(f=D,typeof i!="string"&&(D=i,i=M.require.id)):arguments.length==1&&(f=i,D=[],i=M.require.id),typeof f!="function"){M.require.modules[i]={exports:f,initialized:!0};return}D.length||(D=["require","exports","module"]);var v=function(C){return M.require(i,C)};M.require.modules[i]={exports:{},factory:function(){var C=this,l=f.apply(this,D.slice(0,f.length).map(function(u){switch(u){case"require":return v;case"exports":return C.exports;case"module":return C;default:return v(u)}}));return l&&(C.exports=l),C}}},M.define.amd={},M.require.tlns={},M.initBaseUrls=function(i){for(var D in i)this.require.tlns[D]=i[D]},M.initSender=function(){var i=M.require("ace/lib/event_emitter").EventEmitter,D=M.require("ace/lib/oop"),f=function(){};return function(){D.implement(this,i),this.callback=function(v,C){postMessage({type:"call",id:C,data:v})},this.emit=function(v,C){postMessage({type:"event",name:v,data:C})}}.call(f.prototype),new f};var G=M.main=null,A=M.sender=null;M.onmessage=function(i){var D=i.data;if(D.event&&A)A._signal(D.event,D.data);else if(D.command)if(G[D.command])G[D.command].apply(G,D.args);else{if(!M[D.command])throw new Error("Unknown command:"+D.command);M[D.command].apply(M,D.args)}else if(D.init){M.initBaseUrls(D.tlns),A=M.sender=M.initSender();var f=this.require(D.module)[D.classname];G=M.main=new f(A)}}}})(this),ace.define("ace/lib/oop",[],function(M,ee,G){"use strict";ee.inherits=function(A,i){A.super_=i,A.prototype=Object.create(i.prototype,{constructor:{value:A,enumerable:!1,writable:!0,configurable:!0}})},ee.mixin=function(A,i){for(var D in i)A[D]=i[D];return A},ee.implement=function(A,i){ee.mixin(A,i)}}),ace.define("ace/apply_delta",[],function(M,ee,G){"use strict";function A(f,v){throw console.log("Invalid Delta:",f),"Invalid Delta: "+v}function i(f,v){return v.row>=0&&v.row<f.length&&v.column>=0&&v.column<=f[v.row].length}function D(f,v){v.action!="insert"&&v.action!="remove"&&A(v,"delta.action must be 'insert' or 'remove'"),v.lines instanceof Array||A(v,"delta.lines must be an Array"),(!v.start||!v.end)&&A(v,"delta.start/end must be an present");var C=v.start;i(f,v.start)||A(v,"delta.start must be contained in document");var l=v.end;v.action=="remove"&&!i(f,l)&&A(v,"delta.end must contained in document for 'remove' actions");var u=l.row-C.row,c=l.column-(u==0?C.column:0);(u!=v.lines.length-1||v.lines[u].length!=c)&&A(v,"delta.range must match delta lines")}ee.applyDelta=function(f,v,C){var l=v.start.row,u=v.start.column,c=f[l]||"";switch(v.action){case"insert":var S=v.lines;if(S.length===1)f[l]=c.substring(0,u)+v.lines[0]+c.substring(u);else{var P=[l,1].concat(v.lines);f.splice.apply(f,P),f[l]=c.substring(0,u)+f[l],f[l+v.lines.length-1]+=c.substring(u)}break;case"remove":var H=v.end.column,Q=v.end.row;l===Q?f[l]=c.substring(0,u)+c.substring(H):f.splice(l,Q-l+1,c.substring(0,u)+f[Q].substring(H))}}}),ace.define("ace/lib/event_emitter",[],function(M,ee,G){"use strict";var A={},i=function(){this.propagationStopped=!0},D=function(){this.defaultPrevented=!0};A._emit=A._dispatchEvent=function(f,v){this._eventRegistry||(this._eventRegistry={}),this._defaultHandlers||(this._defaultHandlers={});var C=this._eventRegistry[f]||[],l=this._defaultHandlers[f];if(!(!C.length&&!l)){(typeof v!="object"||!v)&&(v={}),v.type||(v.type=f),v.stopPropagation||(v.stopPropagation=i),v.preventDefault||(v.preventDefault=D),C=C.slice();for(var u=0;u<C.length&&(C[u](v,this),!v.propagationStopped);u++);if(l&&!v.defaultPrevented)return l(v,this)}},A._signal=function(f,v){var C=(this._eventRegistry||{})[f];if(C){C=C.slice();for(var l=0;l<C.length;l++)C[l](v,this)}},A.once=function(f,v){var C=this;if(this.on(f,function l(){C.off(f,l),v.apply(null,arguments)}),!v)return new Promise(function(l){v=l})},A.setDefaultHandler=function(f,v){var C=this._defaultHandlers;if(C||(C=this._defaultHandlers={_disabled_:{}}),C[f]){var l=C[f],u=C._disabled_[f];u||(C._disabled_[f]=u=[]),u.push(l);var c=u.indexOf(v);c!=-1&&u.splice(c,1)}C[f]=v},A.removeDefaultHandler=function(f,v){var C=this._defaultHandlers;if(C){var l=C._disabled_[f];if(C[f]==v)l&&this.setDefaultHandler(f,l.pop());else if(l){var u=l.indexOf(v);u!=-1&&l.splice(u,1)}}},A.on=A.addEventListener=function(f,v,C){this._eventRegistry=this._eventRegistry||{};var l=this._eventRegistry[f];return l||(l=this._eventRegistry[f]=[]),l.indexOf(v)==-1&&l[C?"unshift":"push"](v),v},A.off=A.removeListener=A.removeEventListener=function(f,v){this._eventRegistry=this._eventRegistry||{};var C=this._eventRegistry[f];if(C){var l=C.indexOf(v);l!==-1&&C.splice(l,1)}},A.removeAllListeners=function(f){f||(this._eventRegistry=this._defaultHandlers=void 0),this._eventRegistry&&(this._eventRegistry[f]=void 0),this._defaultHandlers&&(this._defaultHandlers[f]=void 0)},ee.EventEmitter=A}),ace.define("ace/range",[],function(M,ee,G){"use strict";var A=function(){function i(D,f,v,C){this.start={row:D,column:f},this.end={row:v,column:C}}return i.prototype.isEqual=function(D){return this.start.row===D.start.row&&this.end.row===D.end.row&&this.start.column===D.start.column&&this.end.column===D.end.column},i.prototype.toString=function(){return"Range: ["+this.start.row+"/"+this.start.column+"] -> ["+this.end.row+"/"+this.end.column+"]"},i.prototype.contains=function(D,f){return this.compare(D,f)==0},i.prototype.compareRange=function(D){var f,v=D.end,C=D.start;return f=this.compare(v.row,v.column),f==1?(f=this.compare(C.row,C.column),f==1?2:f==0?1:0):f==-1?-2:(f=this.compare(C.row,C.column),f==-1?-1:f==1?42:0)},i.prototype.comparePoint=function(D){return this.compare(D.row,D.column)},i.prototype.containsRange=function(D){return this.comparePoint(D.start)==0&&this.comparePoint(D.end)==0},i.prototype.intersects=function(D){var f=this.compareRange(D);return f==-1||f==0||f==1},i.prototype.isEnd=function(D,f){return this.end.row==D&&this.end.column==f},i.prototype.isStart=function(D,f){return this.start.row==D&&this.start.column==f},i.prototype.setStart=function(D,f){typeof D=="object"?(this.start.column=D.column,this.start.row=D.row):(this.start.row=D,this.start.column=f)},i.prototype.setEnd=function(D,f){typeof D=="object"?(this.end.column=D.column,this.end.row=D.row):(this.end.row=D,this.end.column=f)},i.prototype.inside=function(D,f){return this.compare(D,f)==0?!(this.isEnd(D,f)||this.isStart(D,f)):!1},i.prototype.insideStart=function(D,f){return this.compare(D,f)==0?!this.isEnd(D,f):!1},i.prototype.insideEnd=function(D,f){return this.compare(D,f)==0?!this.isStart(D,f):!1},i.prototype.compare=function(D,f){return!this.isMultiLine()&&D===this.start.row?f<this.start.column?-1:f>this.end.column?1:0:D<this.start.row?-1:D>this.end.row?1:this.start.row===D?f>=this.start.column?0:-1:this.end.row===D?f<=this.end.column?0:1:0},i.prototype.compareStart=function(D,f){return this.start.row==D&&this.start.column==f?-1:this.compare(D,f)},i.prototype.compareEnd=function(D,f){return this.end.row==D&&this.end.column==f?1:this.compare(D,f)},i.prototype.compareInside=function(D,f){return this.end.row==D&&this.end.column==f?1:this.start.row==D&&this.start.column==f?-1:this.compare(D,f)},i.prototype.clipRows=function(D,f){if(this.end.row>f)var v={row:f+1,column:0};else if(this.end.row<D)var v={row:D,column:0};if(this.start.row>f)var C={row:f+1,column:0};else if(this.start.row<D)var C={row:D,column:0};return i.fromPoints(C||this.start,v||this.end)},i.prototype.extend=function(D,f){var v=this.compare(D,f);if(v==0)return this;if(v==-1)var C={row:D,column:f};else var l={row:D,column:f};return i.fromPoints(C||this.start,l||this.end)},i.prototype.isEmpty=function(){return this.start.row===this.end.row&&this.start.column===this.end.column},i.prototype.isMultiLine=function(){return this.start.row!==this.end.row},i.prototype.clone=function(){return i.fromPoints(this.start,this.end)},i.prototype.collapseRows=function(){return this.end.column==0?new i(this.start.row,0,Math.max(this.start.row,this.end.row-1),0):new i(this.start.row,0,this.end.row,0)},i.prototype.toScreenRange=function(D){var f=D.documentToScreenPosition(this.start),v=D.documentToScreenPosition(this.end);return new i(f.row,f.column,v.row,v.column)},i.prototype.moveBy=function(D,f){this.start.row+=D,this.start.column+=f,this.end.row+=D,this.end.column+=f},i}();A.fromPoints=function(i,D){return new A(i.row,i.column,D.row,D.column)},A.comparePoints=function(i,D){return i.row-D.row||i.column-D.column},ee.Range=A}),ace.define("ace/anchor",[],function(M,ee,G){"use strict";function A(C,l,u){var c=u?C.column<=l.column:C.column<l.column;return C.row<l.row||C.row==l.row&&c}function i(C,l,u){var c=C.action=="insert",S=(c?1:-1)*(C.end.row-C.start.row),P=(c?1:-1)*(C.end.column-C.start.column),H=C.start,Q=c?H:C.end;return A(l,H,u)?{row:l.row,column:l.column}:A(Q,l,!u)?{row:l.row+S,column:l.column+(l.row==Q.row?P:0)}:{row:H.row,column:H.column}}var D=M("./lib/oop"),f=M("./lib/event_emitter").EventEmitter,v=function(){function C(l,u,c){this.$onChange=this.onChange.bind(this),this.attach(l),typeof u!="number"?this.setPosition(u.row,u.column):this.setPosition(u,c)}return C.prototype.getPosition=function(){return this.$clipPositionToDocument(this.row,this.column)},C.prototype.getDocument=function(){return this.document},C.prototype.onChange=function(l){if(!(l.start.row==l.end.row&&l.start.row!=this.row)&&!(l.start.row>this.row)){var u=i(l,{row:this.row,column:this.column},this.$insertRight);this.setPosition(u.row,u.column,!0)}},C.prototype.setPosition=function(l,u,c){var S;if(c?S={row:l,column:u}:S=this.$clipPositionToDocument(l,u),!(this.row==S.row&&this.column==S.column)){var P={row:this.row,column:this.column};this.row=S.row,this.column=S.column,this._signal("change",{old:P,value:S})}},C.prototype.detach=function(){this.document.off("change",this.$onChange)},C.prototype.attach=function(l){this.document=l||this.document,this.document.on("change",this.$onChange)},C.prototype.$clipPositionToDocument=function(l,u){var c={};return l>=this.document.getLength()?(c.row=Math.max(0,this.document.getLength()-1),c.column=this.document.getLine(c.row).length):l<0?(c.row=0,c.column=0):(c.row=l,c.column=Math.min(this.document.getLine(c.row).length,Math.max(0,u))),u<0&&(c.column=0),c},C}();v.prototype.$insertRight=!1,D.implement(v.prototype,f),ee.Anchor=v}),ace.define("ace/document",[],function(M,ee,G){"use strict";var A=M("./lib/oop"),i=M("./apply_delta").applyDelta,D=M("./lib/event_emitter").EventEmitter,f=M("./range").Range,v=M("./anchor").Anchor,C=function(){function l(u){this.$lines=[""],u.length===0?this.$lines=[""]:Array.isArray(u)?this.insertMergedLines({row:0,column:0},u):this.insert({row:0,column:0},u)}return l.prototype.setValue=function(u){var c=this.getLength()-1;this.remove(new f(0,0,c,this.getLine(c).length)),this.insert({row:0,column:0},u||"")},l.prototype.getValue=function(){return this.getAllLines().join(this.getNewLineCharacter())},l.prototype.createAnchor=function(u,c){return new v(this,u,c)},l.prototype.$detectNewLine=function(u){var c=u.match(/^.*?(\r\n|\r|\n)/m);this.$autoNewLine=c?c[1]:`
`,this._signal("changeNewLineMode")},l.prototype.getNewLineCharacter=function(){switch(this.$newLineMode){case"windows":return`\r
`;case"unix":return`
`;default:return this.$autoNewLine||`
`}},l.prototype.setNewLineMode=function(u){this.$newLineMode!==u&&(this.$newLineMode=u,this._signal("changeNewLineMode"))},l.prototype.getNewLineMode=function(){return this.$newLineMode},l.prototype.isNewLine=function(u){return u==`\r
`||u=="\r"||u==`
`},l.prototype.getLine=function(u){return this.$lines[u]||""},l.prototype.getLines=function(u,c){return this.$lines.slice(u,c+1)},l.prototype.getAllLines=function(){return this.getLines(0,this.getLength())},l.prototype.getLength=function(){return this.$lines.length},l.prototype.getTextRange=function(u){return this.getLinesForRange(u).join(this.getNewLineCharacter())},l.prototype.getLinesForRange=function(u){var c;if(u.start.row===u.end.row)c=[this.getLine(u.start.row).substring(u.start.column,u.end.column)];else{c=this.getLines(u.start.row,u.end.row),c[0]=(c[0]||"").substring(u.start.column);var S=c.length-1;u.end.row-u.start.row==S&&(c[S]=c[S].substring(0,u.end.column))}return c},l.prototype.insertLines=function(u,c){return console.warn("Use of document.insertLines is deprecated. Use the insertFullLines method instead."),this.insertFullLines(u,c)},l.prototype.removeLines=function(u,c){return console.warn("Use of document.removeLines is deprecated. Use the removeFullLines method instead."),this.removeFullLines(u,c)},l.prototype.insertNewLine=function(u){return console.warn("Use of document.insertNewLine is deprecated. Use insertMergedLines(position, ['', '']) instead."),this.insertMergedLines(u,["",""])},l.prototype.insert=function(u,c){return this.getLength()<=1&&this.$detectNewLine(c),this.insertMergedLines(u,this.$split(c))},l.prototype.insertInLine=function(u,c){var S=this.clippedPos(u.row,u.column),P=this.pos(u.row,u.column+c.length);return this.applyDelta({start:S,end:P,action:"insert",lines:[c]},!0),this.clonePos(P)},l.prototype.clippedPos=function(u,c){var S=this.getLength();u===void 0?u=S:u<0?u=0:u>=S&&(u=S-1,c=void 0);var P=this.getLine(u);return c==null&&(c=P.length),c=Math.min(Math.max(c,0),P.length),{row:u,column:c}},l.prototype.clonePos=function(u){return{row:u.row,column:u.column}},l.prototype.pos=function(u,c){return{row:u,column:c}},l.prototype.$clipPosition=function(u){var c=this.getLength();return u.row>=c?(u.row=Math.max(0,c-1),u.column=this.getLine(c-1).length):(u.row=Math.max(0,u.row),u.column=Math.min(Math.max(u.column,0),this.getLine(u.row).length)),u},l.prototype.insertFullLines=function(u,c){u=Math.min(Math.max(u,0),this.getLength());var S=0;u<this.getLength()?(c=c.concat([""]),S=0):(c=[""].concat(c),u--,S=this.$lines[u].length),this.insertMergedLines({row:u,column:S},c)},l.prototype.insertMergedLines=function(u,c){var S=this.clippedPos(u.row,u.column),P={row:S.row+c.length-1,column:(c.length==1?S.column:0)+c[c.length-1].length};return this.applyDelta({start:S,end:P,action:"insert",lines:c}),this.clonePos(P)},l.prototype.remove=function(u){var c=this.clippedPos(u.start.row,u.start.column),S=this.clippedPos(u.end.row,u.end.column);return this.applyDelta({start:c,end:S,action:"remove",lines:this.getLinesForRange({start:c,end:S})}),this.clonePos(c)},l.prototype.removeInLine=function(u,c,S){var P=this.clippedPos(u,c),H=this.clippedPos(u,S);return this.applyDelta({start:P,end:H,action:"remove",lines:this.getLinesForRange({start:P,end:H})},!0),this.clonePos(P)},l.prototype.removeFullLines=function(u,c){u=Math.min(Math.max(0,u),this.getLength()-1),c=Math.min(Math.max(0,c),this.getLength()-1);var S=c==this.getLength()-1&&u>0,P=c<this.getLength()-1,H=S?u-1:u,Q=S?this.getLine(H).length:0,R=P?c+1:c,J=P?0:this.getLine(R).length,te=new f(H,Q,R,J),oe=this.$lines.slice(u,c+1);return this.applyDelta({start:te.start,end:te.end,action:"remove",lines:this.getLinesForRange(te)}),oe},l.prototype.removeNewLine=function(u){u<this.getLength()-1&&u>=0&&this.applyDelta({start:this.pos(u,this.getLine(u).length),end:this.pos(u+1,0),action:"remove",lines:["",""]})},l.prototype.replace=function(u,c){if(u instanceof f||(u=f.fromPoints(u.start,u.end)),c.length===0&&u.isEmpty())return u.start;if(c==this.getTextRange(u))return u.end;this.remove(u);var S;return c?S=this.insert(u.start,c):S=u.start,S},l.prototype.applyDeltas=function(u){for(var c=0;c<u.length;c++)this.applyDelta(u[c])},l.prototype.revertDeltas=function(u){for(var c=u.length-1;c>=0;c--)this.revertDelta(u[c])},l.prototype.applyDelta=function(u,c){var S=u.action=="insert";(S?u.lines.length<=1&&!u.lines[0]:!f.comparePoints(u.start,u.end))||(S&&u.lines.length>2e4?this.$splitAndapplyLargeDelta(u,2e4):(i(this.$lines,u,c),this._signal("change",u)))},l.prototype.$safeApplyDelta=function(u){var c=this.$lines.length;(u.action=="remove"&&u.start.row<c&&u.end.row<c||u.action=="insert"&&u.start.row<=c)&&this.applyDelta(u)},l.prototype.$splitAndapplyLargeDelta=function(u,c){for(var S=u.lines,P=S.length-c+1,H=u.start.row,Q=u.start.column,R=0,J=0;R<P;R=J){J+=c-1;var te=S.slice(R,J);te.push(""),this.applyDelta({start:this.pos(H+R,Q),end:this.pos(H+J,Q=0),action:u.action,lines:te},!0)}u.lines=S.slice(R),u.start.row=H+R,u.start.column=Q,this.applyDelta(u,!0)},l.prototype.revertDelta=function(u){this.$safeApplyDelta({start:this.clonePos(u.start),end:this.clonePos(u.end),action:u.action=="insert"?"remove":"insert",lines:u.lines.slice()})},l.prototype.indexToPosition=function(u,c){for(var S=this.$lines||this.getAllLines(),P=this.getNewLineCharacter().length,H=c||0,Q=S.length;H<Q;H++)if(u-=S[H].length+P,u<0)return{row:H,column:u+S[H].length+P};return{row:Q-1,column:u+S[Q-1].length+P}},l.prototype.positionToIndex=function(u,c){for(var S=this.$lines||this.getAllLines(),P=this.getNewLineCharacter().length,H=0,Q=Math.min(u.row,S.length),R=c||0;R<Q;++R)H+=S[R].length+P;return H+u.column},l.prototype.$split=function(u){return u.split(/\r\n|\r|\n/)},l}();C.prototype.$autoNewLine="",C.prototype.$newLineMode="auto",A.implement(C.prototype,D),ee.Document=C}),ace.define("ace/lib/deep_copy",[],function(M,ee,G){ee.deepCopy=function A(i){if(typeof i!="object"||!i)return i;var D;if(Array.isArray(i)){D=[];for(var f=0;f<i.length;f++)D[f]=A(i[f]);return D}if(Object.prototype.toString.call(i)!=="[object Object]")return i;D={};for(var f in i)D[f]=A(i[f]);return D}}),ace.define("ace/lib/lang",[],function(M,ee,G){"use strict";ee.last=function(D){return D[D.length-1]},ee.stringReverse=function(D){return D.split("").reverse().join("")},ee.stringRepeat=function(D,f){for(var v="";f>0;)f&1&&(v+=D),(f>>=1)&&(D+=D);return v};var A=/^\s\s*/,i=/\s\s*$/;ee.stringTrimLeft=function(D){return D.replace(A,"")},ee.stringTrimRight=function(D){return D.replace(i,"")},ee.copyObject=function(D){var f={};for(var v in D)f[v]=D[v];return f},ee.copyArray=function(D){for(var f=[],v=0,C=D.length;v<C;v++)D[v]&&typeof D[v]=="object"?f[v]=this.copyObject(D[v]):f[v]=D[v];return f},ee.deepCopy=M("./deep_copy").deepCopy,ee.arrayToMap=function(D){for(var f={},v=0;v<D.length;v++)f[D[v]]=1;return f},ee.createMap=function(D){var f=Object.create(null);for(var v in D)f[v]=D[v];return f},ee.arrayRemove=function(D,f){for(var v=0;v<=D.length;v++)f===D[v]&&D.splice(v,1)},ee.escapeRegExp=function(D){return D.replace(/([.*+?^${}()|[\]\/\\])/g,"\\$1")},ee.escapeHTML=function(D){return(""+D).replace(/&/g,"&#38;").replace(/"/g,"&#34;").replace(/'/g,"&#39;").replace(/</g,"&#60;")},ee.getMatchOffsets=function(D,f){var v=[];return D.replace(f,function(C){v.push({offset:arguments[arguments.length-2],length:C.length})}),v},ee.deferredCall=function(D){var f=null,v=function(){f=null,D()},C=function(l){return C.cancel(),f=setTimeout(v,l||0),C};return C.schedule=C,C.call=function(){return this.cancel(),D(),C},C.cancel=function(){return clearTimeout(f),f=null,C},C.isPending=function(){return f},C},ee.delayedCall=function(D,f){var v=null,C=function(){v=null,D()},l=function(u){v==null&&(v=setTimeout(C,u||f))};return l.delay=function(u){v&&clearTimeout(v),v=setTimeout(C,u||f)},l.schedule=l,l.call=function(){this.cancel(),D()},l.cancel=function(){v&&clearTimeout(v),v=null},l.isPending=function(){return v},l},ee.supportsLookbehind=function(){try{new RegExp("(?<=.)")}catch(D){return!1}return!0},ee.skipEmptyMatch=function(D,f,v){return v&&D.codePointAt(f)>65535?2:1}}),ace.define("ace/worker/mirror",[],function(M,ee,G){"use strict";var A=M("../document").Document,i=M("../lib/lang"),D=ee.Mirror=function(f){this.sender=f;var v=this.doc=new A(""),C=this.deferredUpdate=i.delayedCall(this.onUpdate.bind(this)),l=this;f.on("change",function(u){var c=u.data;if(c[0].start)v.applyDeltas(c);else for(var S=0;S<c.length;S+=2){var P,H;if(Array.isArray(c[S+1])?P={action:"insert",start:c[S],lines:c[S+1]}:P={action:"remove",start:c[S],end:c[S+1]},(P.action=="insert"?P.start:P.end).row>=v.$lines.length)throw H=new Error("Invalid delta"),H.data={path:l.$path,linesLength:v.$lines.length,start:P.start,end:P.end},H;v.applyDelta(P,!0)}if(l.$timeout)return C.schedule(l.$timeout);l.onUpdate()})};(function(){this.$timeout=500,this.setTimeout=function(f){this.$timeout=f},this.setValue=function(f){this.doc.setValue(f),this.deferredUpdate.schedule(this.$timeout)},this.getValue=function(f){this.sender.callback(this.doc.getValue(),f)},this.onUpdate=function(){},this.isPending=function(){return this.deferredUpdate.isPending()}}).call(D.prototype)}),ace.define("ace/mode/json/json_parse",[],function(M,ee,G){"use strict";var A,i,D={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:`
`,r:"\r",t:"	"},f,v=function(R){throw{name:"SyntaxError",message:R,at:A,text:f}},C=function(R){return R&&R!==i&&v("Expected '"+R+"' instead of '"+i+"'"),i=f.charAt(A),A+=1,i},l=function(){var R,J="";for(i==="-"&&(J="-",C("-"));i>="0"&&i<="9";)J+=i,C();if(i===".")for(J+=".";C()&&i>="0"&&i<="9";)J+=i;if(i==="e"||i==="E")for(J+=i,C(),(i==="-"||i==="+")&&(J+=i,C());i>="0"&&i<="9";)J+=i,C();if(R=+J,!isNaN(R))return R;v("Bad number")},u=function(){var R,J,te="",oe;if(i==='"')for(;C();){if(i==='"')return C(),te;if(i==="\\")if(C(),i==="u"){for(oe=0,J=0;J<4&&(R=parseInt(C(),16),!!isFinite(R));J+=1)oe=oe*16+R;te+=String.fromCharCode(oe)}else{if(typeof D[i]!="string")break;te+=D[i]}else{if(i==`
`||i=="\r")break;te+=i}}v("Bad string")},c=function(){for(;i&&i<=" ";)C()},S=function(){switch(i){case"t":return C("t"),C("r"),C("u"),C("e"),!0;case"f":return C("f"),C("a"),C("l"),C("s"),C("e"),!1;case"n":return C("n"),C("u"),C("l"),C("l"),null}v("Unexpected '"+i+"'")},P,H=function(){var R=[];if(i==="["){if(C("["),c(),i==="]")return C("]"),R;for(;i;){if(R.push(P()),c(),i==="]")return C("]"),R;C(","),c()}}v("Bad array")},Q=function(){var R,J={};if(i==="{"){if(C("{"),c(),i==="}")return C("}"),J;for(;i;){if(R=u(),c(),C(":"),Object.hasOwnProperty.call(J,R)&&v('Duplicate key "'+R+'"'),J[R]=P(),c(),i==="}")return C("}"),J;C(","),c()}}v("Bad object")};return P=function(){switch(c(),i){case"{":return Q();case"[":return H();case'"':return u();case"-":return l();default:return i>="0"&&i<="9"?l():S()}},function(R,J){var te;return f=R,A=0,i=" ",te=P(),c(),i&&v("Syntax error"),typeof J=="function"?function oe(N,d){var y,p,g=N[d];if(g&&typeof g=="object")for(y in g)Object.hasOwnProperty.call(g,y)&&(p=oe(g,y),p!==void 0?g[y]=p:delete g[y]);return J.call(N,d,g)}({"":te},""):te}}),ace.define("ace/mode/json_worker",[],function(M,ee,G){"use strict";var A=M("../lib/oop"),i=M("../worker/mirror").Mirror,D=M("./json/json_parse"),f=ee.JsonWorker=function(v){i.call(this,v),this.setTimeout(200)};A.inherits(f,i),function(){this.onUpdate=function(){var v=this.doc.getValue(),C=[];try{v&&D(v)}catch(u){var l=this.doc.indexToPosition(u.at-1);C.push({row:l.row,column:l.column,text:u.message,type:"error"})}this.sender.emit("annotate",C)}}.call(f.prototype)})},7051:function(M,ee,G){(function(A,i){M.exports=ee=i()})(this,function(){var A=A||function(i,D){var f;if(typeof window!="undefined"&&window.crypto&&(f=window.crypto),typeof self!="undefined"&&self.crypto&&(f=self.crypto),typeof globalThis!="undefined"&&globalThis.crypto&&(f=globalThis.crypto),!f&&typeof window!="undefined"&&window.msCrypto&&(f=window.msCrypto),!f&&typeof G.g!="undefined"&&G.g.crypto&&(f=G.g.crypto),!f)try{f=G(477)}catch(N){}var v=function(){if(f){if(typeof f.getRandomValues=="function")try{return f.getRandomValues(new Uint32Array(1))[0]}catch(N){}if(typeof f.randomBytes=="function")try{return f.randomBytes(4).readInt32LE()}catch(N){}}throw new Error("Native crypto module could not be used to get secure random number.")},C=Object.create||function(){function N(){}return function(d){var y;return N.prototype=d,y=new N,N.prototype=null,y}}(),l={},u=l.lib={},c=u.Base=function(){return{extend:function(N){var d=C(this);return N&&d.mixIn(N),(!d.hasOwnProperty("init")||this.init===d.init)&&(d.init=function(){d.$super.init.apply(this,arguments)}),d.init.prototype=d,d.$super=this,d},create:function(){var N=this.extend();return N.init.apply(N,arguments),N},init:function(){},mixIn:function(N){for(var d in N)N.hasOwnProperty(d)&&(this[d]=N[d]);N.hasOwnProperty("toString")&&(this.toString=N.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),S=u.WordArray=c.extend({init:function(N,d){N=this.words=N||[],d!=D?this.sigBytes=d:this.sigBytes=N.length*4},toString:function(N){return(N||H).stringify(this)},concat:function(N){var d=this.words,y=N.words,p=this.sigBytes,g=N.sigBytes;if(this.clamp(),p%4)for(var m=0;m<g;m++){var b=y[m>>>2]>>>24-m%4*8&255;d[p+m>>>2]|=b<<24-(p+m)%4*8}else for(var E=0;E<g;E+=4)d[p+E>>>2]=y[E>>>2];return this.sigBytes+=g,this},clamp:function(){var N=this.words,d=this.sigBytes;N[d>>>2]&=4294967295<<32-d%4*8,N.length=i.ceil(d/4)},clone:function(){var N=c.clone.call(this);return N.words=this.words.slice(0),N},random:function(N){for(var d=[],y=0;y<N;y+=4)d.push(v());return new S.init(d,N)}}),P=l.enc={},H=P.Hex={stringify:function(N){for(var d=N.words,y=N.sigBytes,p=[],g=0;g<y;g++){var m=d[g>>>2]>>>24-g%4*8&255;p.push((m>>>4).toString(16)),p.push((m&15).toString(16))}return p.join("")},parse:function(N){for(var d=N.length,y=[],p=0;p<d;p+=2)y[p>>>3]|=parseInt(N.substr(p,2),16)<<24-p%8*4;return new S.init(y,d/2)}},Q=P.Latin1={stringify:function(N){for(var d=N.words,y=N.sigBytes,p=[],g=0;g<y;g++){var m=d[g>>>2]>>>24-g%4*8&255;p.push(String.fromCharCode(m))}return p.join("")},parse:function(N){for(var d=N.length,y=[],p=0;p<d;p++)y[p>>>2]|=(N.charCodeAt(p)&255)<<24-p%4*8;return new S.init(y,d)}},R=P.Utf8={stringify:function(N){try{return decodeURIComponent(escape(Q.stringify(N)))}catch(d){throw new Error("Malformed UTF-8 data")}},parse:function(N){return Q.parse(unescape(encodeURIComponent(N)))}},J=u.BufferedBlockAlgorithm=c.extend({reset:function(){this._data=new S.init,this._nDataBytes=0},_append:function(N){typeof N=="string"&&(N=R.parse(N)),this._data.concat(N),this._nDataBytes+=N.sigBytes},_process:function(N){var d,y=this._data,p=y.words,g=y.sigBytes,m=this.blockSize,b=m*4,E=g/b;N?E=i.ceil(E):E=i.max((E|0)-this._minBufferSize,0);var k=E*m,B=i.min(k*4,g);if(k){for(var _=0;_<k;_+=m)this._doProcessBlock(p,_);d=p.splice(0,k),y.sigBytes-=B}return new S.init(d,B)},clone:function(){var N=c.clone.call(this);return N._data=this._data.clone(),N},_minBufferSize:0}),te=u.Hasher=J.extend({cfg:c.extend(),init:function(N){this.cfg=this.cfg.extend(N),this.reset()},reset:function(){J.reset.call(this),this._doReset()},update:function(N){return this._append(N),this._process(),this},finalize:function(N){N&&this._append(N);var d=this._doFinalize();return d},blockSize:512/32,_createHelper:function(N){return function(d,y){return new N.init(y).finalize(d)}},_createHmacHelper:function(N){return function(d,y){return new oe.HMAC.init(N,y).finalize(d)}}}),oe=l.algo={};return l}(Math);return A})},1778:function(M,ee,G){(function(A,i){M.exports=ee=i(G(7051))})(this,function(A){return function(i){var D=A,f=D.lib,v=f.WordArray,C=f.Hasher,l=D.algo,u=[];(function(){for(var R=0;R<64;R++)u[R]=i.abs(i.sin(R+1))*4294967296|0})();var c=l.MD5=C.extend({_doReset:function(){this._hash=new v.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(R,J){for(var te=0;te<16;te++){var oe=J+te,N=R[oe];R[oe]=(N<<8|N>>>24)&16711935|(N<<24|N>>>8)&4278255360}var d=this._hash.words,y=R[J+0],p=R[J+1],g=R[J+2],m=R[J+3],b=R[J+4],E=R[J+5],k=R[J+6],B=R[J+7],_=R[J+8],F=R[J+9],T=R[J+10],W=R[J+11],re=R[J+12],Z=R[J+13],ce=R[J+14],le=R[J+15],V=d[0],z=d[1],j=d[2],K=d[3];V=S(V,z,j,K,y,7,u[0]),K=S(K,V,z,j,p,12,u[1]),j=S(j,K,V,z,g,17,u[2]),z=S(z,j,K,V,m,22,u[3]),V=S(V,z,j,K,b,7,u[4]),K=S(K,V,z,j,E,12,u[5]),j=S(j,K,V,z,k,17,u[6]),z=S(z,j,K,V,B,22,u[7]),V=S(V,z,j,K,_,7,u[8]),K=S(K,V,z,j,F,12,u[9]),j=S(j,K,V,z,T,17,u[10]),z=S(z,j,K,V,W,22,u[11]),V=S(V,z,j,K,re,7,u[12]),K=S(K,V,z,j,Z,12,u[13]),j=S(j,K,V,z,ce,17,u[14]),z=S(z,j,K,V,le,22,u[15]),V=P(V,z,j,K,p,5,u[16]),K=P(K,V,z,j,k,9,u[17]),j=P(j,K,V,z,W,14,u[18]),z=P(z,j,K,V,y,20,u[19]),V=P(V,z,j,K,E,5,u[20]),K=P(K,V,z,j,T,9,u[21]),j=P(j,K,V,z,le,14,u[22]),z=P(z,j,K,V,b,20,u[23]),V=P(V,z,j,K,F,5,u[24]),K=P(K,V,z,j,ce,9,u[25]),j=P(j,K,V,z,m,14,u[26]),z=P(z,j,K,V,_,20,u[27]),V=P(V,z,j,K,Z,5,u[28]),K=P(K,V,z,j,g,9,u[29]),j=P(j,K,V,z,B,14,u[30]),z=P(z,j,K,V,re,20,u[31]),V=H(V,z,j,K,E,4,u[32]),K=H(K,V,z,j,_,11,u[33]),j=H(j,K,V,z,W,16,u[34]),z=H(z,j,K,V,ce,23,u[35]),V=H(V,z,j,K,p,4,u[36]),K=H(K,V,z,j,b,11,u[37]),j=H(j,K,V,z,B,16,u[38]),z=H(z,j,K,V,T,23,u[39]),V=H(V,z,j,K,Z,4,u[40]),K=H(K,V,z,j,y,11,u[41]),j=H(j,K,V,z,m,16,u[42]),z=H(z,j,K,V,k,23,u[43]),V=H(V,z,j,K,F,4,u[44]),K=H(K,V,z,j,re,11,u[45]),j=H(j,K,V,z,le,16,u[46]),z=H(z,j,K,V,g,23,u[47]),V=Q(V,z,j,K,y,6,u[48]),K=Q(K,V,z,j,B,10,u[49]),j=Q(j,K,V,z,ce,15,u[50]),z=Q(z,j,K,V,E,21,u[51]),V=Q(V,z,j,K,re,6,u[52]),K=Q(K,V,z,j,m,10,u[53]),j=Q(j,K,V,z,T,15,u[54]),z=Q(z,j,K,V,p,21,u[55]),V=Q(V,z,j,K,_,6,u[56]),K=Q(K,V,z,j,le,10,u[57]),j=Q(j,K,V,z,k,15,u[58]),z=Q(z,j,K,V,Z,21,u[59]),V=Q(V,z,j,K,b,6,u[60]),K=Q(K,V,z,j,W,10,u[61]),j=Q(j,K,V,z,g,15,u[62]),z=Q(z,j,K,V,F,21,u[63]),d[0]=d[0]+V|0,d[1]=d[1]+z|0,d[2]=d[2]+j|0,d[3]=d[3]+K|0},_doFinalize:function(){var R=this._data,J=R.words,te=this._nDataBytes*8,oe=R.sigBytes*8;J[oe>>>5]|=128<<24-oe%32;var N=i.floor(te/4294967296),d=te;J[(oe+64>>>9<<4)+15]=(N<<8|N>>>24)&16711935|(N<<24|N>>>8)&4278255360,J[(oe+64>>>9<<4)+14]=(d<<8|d>>>24)&16711935|(d<<24|d>>>8)&4278255360,R.sigBytes=(J.length+1)*4,this._process();for(var y=this._hash,p=y.words,g=0;g<4;g++){var m=p[g];p[g]=(m<<8|m>>>24)&16711935|(m<<24|m>>>8)&4278255360}return y},clone:function(){var R=C.clone.call(this);return R._hash=this._hash.clone(),R}});function S(R,J,te,oe,N,d,y){var p=R+(J&te|~J&oe)+N+y;return(p<<d|p>>>32-d)+J}function P(R,J,te,oe,N,d,y){var p=R+(J&oe|te&~oe)+N+y;return(p<<d|p>>>32-d)+J}function H(R,J,te,oe,N,d,y){var p=R+(J^te^oe)+N+y;return(p<<d|p>>>32-d)+J}function Q(R,J,te,oe,N,d,y){var p=R+(te^(J|~oe))+N+y;return(p<<d|p>>>32-d)+J}D.MD5=C._createHelper(c),D.HmacMD5=C._createHmacHelper(c)}(Math),A.MD5})},5589:function(M){(function(ee,G){M.exports=G()})(this,function(){"use strict";function ee(w,$){return $={exports:{}},w($,$.exports),$.exports}var G=ee(function(w){var $=w.exports=typeof window!="undefined"&&window.Math==Math?window:typeof self!="undefined"&&self.Math==Math?self:Function("return this")();typeof __g=="number"&&(__g=$)}),A=ee(function(w){var $=w.exports={version:"2.6.5"};typeof __e=="number"&&(__e=$)}),i=A.version,D=function(w){return typeof w=="object"?w!==null:typeof w=="function"},f=function(w){if(!D(w))throw TypeError(w+" is not an object!");return w},v=function(w){try{return!!w()}catch($){return!0}},C=!v(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7}),l=G.document,u=D(l)&&D(l.createElement),c=function(w){return u?l.createElement(w):{}},S=!C&&!v(function(){return Object.defineProperty(c("div"),"a",{get:function(){return 7}}).a!=7}),P=function(w,$){if(!D(w))return w;var ie,ne;if($&&typeof(ie=w.toString)=="function"&&!D(ne=ie.call(w))||typeof(ie=w.valueOf)=="function"&&!D(ne=ie.call(w))||!$&&typeof(ie=w.toString)=="function"&&!D(ne=ie.call(w)))return ne;throw TypeError("Can't convert object to primitive value")},H=Object.defineProperty,Q=C?Object.defineProperty:function($,ie,ne){if(f($),ie=P(ie,!0),f(ne),S)try{return H($,ie,ne)}catch(ae){}if("get"in ne||"set"in ne)throw TypeError("Accessors not supported!");return"value"in ne&&($[ie]=ne.value),$},R={f:Q},J=function(w,$){return{enumerable:!(w&1),configurable:!(w&2),writable:!(w&4),value:$}},te=C?function(w,$,ie){return R.f(w,$,J(1,ie))}:function(w,$,ie){return w[$]=ie,w},oe={}.hasOwnProperty,N=function(w,$){return oe.call(w,$)},d=0,y=Math.random(),p=function(w){return"Symbol(".concat(w===void 0?"":w,")_",(++d+y).toString(36))},g=!1,m=ee(function(w){var $="__core-js_shared__",ie=G[$]||(G[$]={});(w.exports=function(ne,ae){return ie[ne]||(ie[ne]=ae!==void 0?ae:{})})("versions",[]).push({version:A.version,mode:g?"pure":"global",copyright:"\xA9 2019 Denis Pushkarev (zloirock.ru)"})}),b=m("native-function-to-string",Function.toString),E=ee(function(w){var $=p("src"),ie="toString",ne=(""+b).split(ie);A.inspectSource=function(ae){return b.call(ae)},(w.exports=function(ae,De,Ce,Me){var Be=typeof Ce=="function";Be&&(N(Ce,"name")||te(Ce,"name",De)),ae[De]!==Ce&&(Be&&(N(Ce,$)||te(Ce,$,ae[De]?""+ae[De]:ne.join(String(De)))),ae===G?ae[De]=Ce:Me?ae[De]?ae[De]=Ce:te(ae,De,Ce):(delete ae[De],te(ae,De,Ce)))})(Function.prototype,ie,function(){return typeof this=="function"&&this[$]||b.call(this)})}),k=function(w){if(typeof w!="function")throw TypeError(w+" is not a function!");return w},B=function(w,$,ie){if(k(w),$===void 0)return w;switch(ie){case 1:return function(ne){return w.call($,ne)};case 2:return function(ne,ae){return w.call($,ne,ae)};case 3:return function(ne,ae,De){return w.call($,ne,ae,De)}}return function(){return w.apply($,arguments)}},_="prototype",F=function(w,$,ie){var ne=w&F.F,ae=w&F.G,De=w&F.S,Ce=w&F.P,Me=w&F.B,Be=ae?G:De?G[$]||(G[$]={}):(G[$]||{})[_],ot=ae?A:A[$]||(A[$]={}),at=ot[_]||(ot[_]={}),je,Ge,Ne,ht;ae&&(ie=$);for(je in ie)Ge=!ne&&Be&&Be[je]!==void 0,Ne=(Ge?Be:ie)[je],ht=Me&&Ge?B(Ne,G):Ce&&typeof Ne=="function"?B(Function.call,Ne):Ne,Be&&E(Be,je,Ne,w&F.U),ot[je]!=Ne&&te(ot,je,ht),Ce&&at[je]!=Ne&&(at[je]=Ne)};G.core=A,F.F=1,F.G=2,F.S=4,F.P=8,F.B=16,F.W=32,F.U=64,F.R=128;var T=F,W=Math.ceil,re=Math.floor,Z=function(w){return isNaN(w=+w)?0:(w>0?re:W)(w)},ce=function(w){if(w==null)throw TypeError("Can't call method on  "+w);return w},le=function(w){return function($,ie){var ne=String(ce($)),ae=Z(ie),De=ne.length,Ce,Me;return ae<0||ae>=De?w?"":void 0:(Ce=ne.charCodeAt(ae),Ce<55296||Ce>56319||ae+1===De||(Me=ne.charCodeAt(ae+1))<56320||Me>57343?w?ne.charAt(ae):Ce:w?ne.slice(ae,ae+2):(Ce-55296<<10)+(Me-56320)+65536)}},V=le(!1);T(T.P,"String",{codePointAt:function($){return V(this,$)}});var z=A.String.codePointAt,j=Math.max,K=Math.min,Se=function(w,$){return w=Z(w),w<0?j(w+$,0):K(w,$)},ue=String.fromCharCode,ke=String.fromCodePoint;T(T.S+T.F*(!!ke&&ke.length!=1),"String",{fromCodePoint:function($){for(var ie=arguments,ne=[],ae=arguments.length,De=0,Ce;ae>De;){if(Ce=+ie[De++],Se(Ce,1114111)!==Ce)throw RangeError(Ce+" is not a valid code point");ne.push(Ce<65536?ue(Ce):ue(((Ce-=65536)>>10)+55296,Ce%1024+56320))}return ne.join("")}});var ze=A.String.fromCodePoint,Ie=/[\u1680\u2000-\u200A\u202F\u205F\u3000]/,ut=/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312E\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEA\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDE80-\uDE9C\uDEA0-\uDED0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE4\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC03-\uDC37\uDC83-\uDCAF\uDCD0-\uDCE8\uDD03-\uDD26\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE80-\uDEAA\uDF00-\uDF19]|\uD806[\uDCA0-\uDCDF\uDCFF\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE83\uDE86-\uDE89\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50\uDF93-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB]|\uD83A[\uDC00-\uDCC4\uDD00-\uDD43]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]/,ct=/[\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0300-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u0483-\u0487\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F2\u0610-\u061A\u0620-\u0669\u066E-\u06D3\u06D5-\u06DC\u06DF-\u06E8\u06EA-\u06FC\u06FF\u0710-\u074A\u074D-\u07B1\u07C0-\u07F5\u07FA\u0800-\u082D\u0840-\u085B\u0860-\u086A\u08A0-\u08B4\u08B6-\u08BD\u08D4-\u08E1\u08E3-\u0963\u0966-\u096F\u0971-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09F1\u09FC\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AEF\u0AF9-\u0AFF\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B6F\u0B71\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58-\u0C5A\u0C60-\u0C63\u0C66-\u0C6F\u0C80-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2\u0D00-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D54-\u0D57\u0D5F-\u0D63\u0D66-\u0D6F\u0D7A-\u0D7F\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E01-\u0E3A\u0E40-\u0E4E\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F47\u0F49-\u0F6C\u0F71-\u0F84\u0F86-\u0F97\u0F99-\u0FBC\u0FC6\u1000-\u1049\u1050-\u109D\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u135F\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1714\u1720-\u1734\u1740-\u1753\u1760-\u176C\u176E-\u1770\u1772\u1773\u1780-\u17D3\u17D7\u17DC\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u1820-\u1877\u1880-\u18AA\u18B0-\u18F5\u1900-\u191E\u1920-\u192B\u1930-\u193B\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19D9\u1A00-\u1A1B\u1A20-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AA7\u1AB0-\u1ABD\u1B00-\u1B4B\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1BF3\u1C00-\u1C37\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1CD0-\u1CD2\u1CD4-\u1CF9\u1D00-\u1DF9\u1DFB-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u203F\u2040\u2054\u2071\u207F\u2090-\u209C\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D7F-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2DE0-\u2DFF\u2E2F\u3005-\u3007\u3021-\u302F\u3031-\u3035\u3038-\u303C\u3041-\u3096\u3099\u309A\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312E\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FEA\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66F\uA674-\uA67D\uA67F-\uA6F1\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA827\uA840-\uA873\uA880-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F7\uA8FB\uA8FD\uA900-\uA92D\uA930-\uA953\uA960-\uA97C\uA980-\uA9C0\uA9CF-\uA9D9\uA9E0-\uA9FE\uAA00-\uAA36\uAA40-\uAA4D\uAA50-\uAA59\uAA60-\uAA76\uAA7A-\uAAC2\uAADB-\uAADD\uAAE0-\uAAEF\uAAF2-\uAAF6\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABEA\uABEC\uABED\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF3F\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD40-\uDD74\uDDFD\uDE80-\uDE9C\uDEA0-\uDED0\uDEE0\uDF00-\uDF1F\uDF2D-\uDF4A\uDF50-\uDF7A\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC60-\uDC76\uDC80-\uDC9E\uDCE0-\uDCF2\uDCF4\uDCF5\uDD00-\uDD15\uDD20-\uDD39\uDD80-\uDDB7\uDDBE\uDDBF\uDE00-\uDE03\uDE05\uDE06\uDE0C-\uDE13\uDE15-\uDE17\uDE19-\uDE33\uDE38-\uDE3A\uDE3F\uDE60-\uDE7C\uDE80-\uDE9C\uDEC0-\uDEC7\uDEC9-\uDEE6\uDF00-\uDF35\uDF40-\uDF55\uDF60-\uDF72\uDF80-\uDF91]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2]|\uD804[\uDC00-\uDC46\uDC66-\uDC6F\uDC7F-\uDCBA\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD00-\uDD34\uDD36-\uDD3F\uDD50-\uDD73\uDD76\uDD80-\uDDC4\uDDCA-\uDDCC\uDDD0-\uDDDA\uDDDC\uDE00-\uDE11\uDE13-\uDE37\uDE3E\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEEA\uDEF0-\uDEF9\uDF00-\uDF03\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3C-\uDF44\uDF47\uDF48\uDF4B-\uDF4D\uDF50\uDF57\uDF5D-\uDF63\uDF66-\uDF6C\uDF70-\uDF74]|\uD805[\uDC00-\uDC4A\uDC50-\uDC59\uDC80-\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDB5\uDDB8-\uDDC0\uDDD8-\uDDDD\uDE00-\uDE40\uDE44\uDE50-\uDE59\uDE80-\uDEB7\uDEC0-\uDEC9\uDF00-\uDF19\uDF1D-\uDF2B\uDF30-\uDF39]|\uD806[\uDCA0-\uDCE9\uDCFF\uDE00-\uDE3E\uDE47\uDE50-\uDE83\uDE86-\uDE99\uDEC0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC36\uDC38-\uDC40\uDC50-\uDC59\uDC72-\uDC8F\uDC92-\uDCA7\uDCA9-\uDCB6\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD36\uDD3A\uDD3C\uDD3D\uDD3F-\uDD47\uDD50-\uDD59]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|[\uD80C\uD81C-\uD820\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDED0-\uDEED\uDEF0-\uDEF4\uDF00-\uDF36\uDF40-\uDF43\uDF50-\uDF59\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDF00-\uDF44\uDF50-\uDF7E\uDF8F-\uDF9F\uDFE0\uDFE1]|\uD821[\uDC00-\uDFEC]|\uD822[\uDC00-\uDEF2]|\uD82C[\uDC00-\uDD1E\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99\uDC9D\uDC9E]|\uD834[\uDD65-\uDD69\uDD6D-\uDD72\uDD7B-\uDD82\uDD85-\uDD8B\uDDAA-\uDDAD\uDE42-\uDE44]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD836[\uDE00-\uDE36\uDE3B-\uDE6C\uDE75\uDE84\uDE9B-\uDE9F\uDEA1-\uDEAF]|\uD838[\uDC00-\uDC06\uDC08-\uDC18\uDC1B-\uDC21\uDC23\uDC24\uDC26-\uDC2A]|\uD83A[\uDC00-\uDCC4\uDCD0-\uDCD6\uDD00-\uDD4A\uDD50-\uDD59]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uDB40[\uDD00-\uDDEF]/,Dt={Space_Separator:Ie,ID_Start:ut,ID_Continue:ct},_e={isSpaceSeparator:function($){return typeof $=="string"&&Dt.Space_Separator.test($)},isIdStartChar:function($){return typeof $=="string"&&($>="a"&&$<="z"||$>="A"&&$<="Z"||$==="$"||$==="_"||Dt.ID_Start.test($))},isIdContinueChar:function($){return typeof $=="string"&&($>="a"&&$<="z"||$>="A"&&$<="Z"||$>="0"&&$<="9"||$==="$"||$==="_"||$==="\u200C"||$==="\u200D"||Dt.ID_Continue.test($))},isDigit:function($){return typeof $=="string"&&/[0-9]/.test($)},isHexDigit:function($){return typeof $=="string"&&/[0-9A-Fa-f]/.test($)}},Bt,Re,Ue,xt,Qe,Je,Oe,wt,vt,Yt=function($,ie){Bt=String($),Re="start",Ue=[],xt=0,Qe=1,Je=0,Oe=void 0,wt=void 0,vt=void 0;do Oe=Ft(),Zt[Re]();while(Oe.type!=="eof");return typeof ie=="function"?Ot({"":vt},"",ie):vt};function Ot(w,$,ie){var ne=w[$];if(ne!=null&&typeof ne=="object")if(Array.isArray(ne))for(var ae=0;ae<ne.length;ae++){var De=String(ae),Ce=Ot(ne,De,ie);Ce===void 0?delete ne[De]:Object.defineProperty(ne,De,{value:Ce,writable:!0,enumerable:!0,configurable:!0})}else for(var Me in ne){var Be=Ot(ne,Me,ie);Be===void 0?delete ne[Me]:Object.defineProperty(ne,Me,{value:Be,writable:!0,enumerable:!0,configurable:!0})}return ie.call(w,$,ne)}var me,de,Ct,Ze,ve;function Ft(){for(me="default",de="",Ct=!1,Ze=1;;){ve=Ke();var w=Mt[me]();if(w)return w}}function Ke(){if(Bt[xt])return String.fromCodePoint(Bt.codePointAt(xt))}function U(){var w=Ke();return w===`
`?(Qe++,Je=0):w?Je+=w.length:Je++,w&&(xt+=w.length),w}var Mt={default:function(){switch(ve){case"	":case"\v":case"\f":case" ":case"\xA0":case"\uFEFF":case`
`:case"\r":case"\u2028":case"\u2029":U();return;case"/":U(),me="comment";return;case void 0:return U(),xe("eof")}if(_e.isSpaceSeparator(ve)){U();return}return Mt[Re]()},comment:function(){switch(ve){case"*":U(),me="multiLineComment";return;case"/":U(),me="singleLineComment";return}throw we(U())},multiLineComment:function(){switch(ve){case"*":U(),me="multiLineCommentAsterisk";return;case void 0:throw we(U())}U()},multiLineCommentAsterisk:function(){switch(ve){case"*":U();return;case"/":U(),me="default";return;case void 0:throw we(U())}U(),me="multiLineComment"},singleLineComment:function(){switch(ve){case`
`:case"\r":case"\u2028":case"\u2029":U(),me="default";return;case void 0:return U(),xe("eof")}U()},value:function(){switch(ve){case"{":case"[":return xe("punctuator",U());case"n":return U(),it("ull"),xe("null",null);case"t":return U(),it("rue"),xe("boolean",!0);case"f":return U(),it("alse"),xe("boolean",!1);case"-":case"+":U()==="-"&&(Ze=-1),me="sign";return;case".":de=U(),me="decimalPointLeading";return;case"0":de=U(),me="zero";return;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":de=U(),me="decimalInteger";return;case"I":return U(),it("nfinity"),xe("numeric",1/0);case"N":return U(),it("aN"),xe("numeric",NaN);case'"':case"'":Ct=U()==='"',de="",me="string";return}throw we(U())},identifierNameStartEscape:function(){if(ve!=="u")throw we(U());U();var $=We();switch($){case"$":case"_":break;default:if(!_e.isIdStartChar($))throw St();break}de+=$,me="identifierName"},identifierName:function(){switch(ve){case"$":case"_":case"\u200C":case"\u200D":de+=U();return;case"\\":U(),me="identifierNameEscape";return}if(_e.isIdContinueChar(ve)){de+=U();return}return xe("identifier",de)},identifierNameEscape:function(){if(ve!=="u")throw we(U());U();var $=We();switch($){case"$":case"_":case"\u200C":case"\u200D":break;default:if(!_e.isIdContinueChar($))throw St();break}de+=$,me="identifierName"},sign:function(){switch(ve){case".":de=U(),me="decimalPointLeading";return;case"0":de=U(),me="zero";return;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":de=U(),me="decimalInteger";return;case"I":return U(),it("nfinity"),xe("numeric",Ze*(1/0));case"N":return U(),it("aN"),xe("numeric",NaN)}throw we(U())},zero:function(){switch(ve){case".":de+=U(),me="decimalPoint";return;case"e":case"E":de+=U(),me="decimalExponent";return;case"x":case"X":de+=U(),me="hexadecimal";return}return xe("numeric",Ze*0)},decimalInteger:function(){switch(ve){case".":de+=U(),me="decimalPoint";return;case"e":case"E":de+=U(),me="decimalExponent";return}if(_e.isDigit(ve)){de+=U();return}return xe("numeric",Ze*Number(de))},decimalPointLeading:function(){if(_e.isDigit(ve)){de+=U(),me="decimalFraction";return}throw we(U())},decimalPoint:function(){switch(ve){case"e":case"E":de+=U(),me="decimalExponent";return}if(_e.isDigit(ve)){de+=U(),me="decimalFraction";return}return xe("numeric",Ze*Number(de))},decimalFraction:function(){switch(ve){case"e":case"E":de+=U(),me="decimalExponent";return}if(_e.isDigit(ve)){de+=U();return}return xe("numeric",Ze*Number(de))},decimalExponent:function(){switch(ve){case"+":case"-":de+=U(),me="decimalExponentSign";return}if(_e.isDigit(ve)){de+=U(),me="decimalExponentInteger";return}throw we(U())},decimalExponentSign:function(){if(_e.isDigit(ve)){de+=U(),me="decimalExponentInteger";return}throw we(U())},decimalExponentInteger:function(){if(_e.isDigit(ve)){de+=U();return}return xe("numeric",Ze*Number(de))},hexadecimal:function(){if(_e.isHexDigit(ve)){de+=U(),me="hexadecimalInteger";return}throw we(U())},hexadecimalInteger:function(){if(_e.isHexDigit(ve)){de+=U();return}return xe("numeric",Ze*Number(de))},string:function(){switch(ve){case"\\":U(),de+=Vt();return;case'"':if(Ct)return U(),xe("string",de);de+=U();return;case"'":if(!Ct)return U(),xe("string",de);de+=U();return;case`
`:case"\r":throw we(U());case"\u2028":case"\u2029":Wt(ve);break;case void 0:throw we(U())}de+=U()},start:function(){switch(ve){case"{":case"[":return xe("punctuator",U())}me="value"},beforePropertyName:function(){switch(ve){case"$":case"_":de=U(),me="identifierName";return;case"\\":U(),me="identifierNameStartEscape";return;case"}":return xe("punctuator",U());case'"':case"'":Ct=U()==='"',me="string";return}if(_e.isIdStartChar(ve)){de+=U(),me="identifierName";return}throw we(U())},afterPropertyName:function(){if(ve===":")return xe("punctuator",U());throw we(U())},beforePropertyValue:function(){me="value"},afterPropertyValue:function(){switch(ve){case",":case"}":return xe("punctuator",U())}throw we(U())},beforeArrayValue:function(){if(ve==="]")return xe("punctuator",U());me="value"},afterArrayValue:function(){switch(ve){case",":case"]":return xe("punctuator",U())}throw we(U())},end:function(){throw we(U())}};function xe(w,$){return{type:w,value:$,line:Qe,column:Je}}function it(w){for(var $=0,ie=w;$<ie.length;$+=1){var ne=ie[$],ae=Ke();if(ae!==ne)throw we(U());U()}}function Vt(){var w=Ke();switch(w){case"b":return U(),"\b";case"f":return U(),"\f";case"n":return U(),`
`;case"r":return U(),"\r";case"t":return U(),"	";case"v":return U(),"\v";case"0":if(U(),_e.isDigit(Ke()))throw we(U());return"\0";case"x":return U(),Xt();case"u":return U(),We();case`
`:case"\u2028":case"\u2029":return U(),"";case"\r":return U(),Ke()===`
`&&U(),"";case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":throw we(U());case void 0:throw we(U())}return U()}function Xt(){var w="",$=Ke();if(!_e.isHexDigit($)||(w+=U(),$=Ke(),!_e.isHexDigit($)))throw we(U());return w+=U(),String.fromCodePoint(parseInt(w,16))}function We(){for(var w="",$=4;$-- >0;){var ie=Ke();if(!_e.isHexDigit(ie))throw we(U());w+=U()}return String.fromCodePoint(parseInt(w,16))}var Zt={start:function(){if(Oe.type==="eof")throw rt();$t()},beforePropertyName:function(){switch(Oe.type){case"identifier":case"string":wt=Oe.value,Re="afterPropertyName";return;case"punctuator":At();return;case"eof":throw rt()}},afterPropertyName:function(){if(Oe.type==="eof")throw rt();Re="beforePropertyValue"},beforePropertyValue:function(){if(Oe.type==="eof")throw rt();$t()},beforeArrayValue:function(){if(Oe.type==="eof")throw rt();if(Oe.type==="punctuator"&&Oe.value==="]"){At();return}$t()},afterPropertyValue:function(){if(Oe.type==="eof")throw rt();switch(Oe.value){case",":Re="beforePropertyName";return;case"}":At()}},afterArrayValue:function(){if(Oe.type==="eof")throw rt();switch(Oe.value){case",":Re="beforeArrayValue";return;case"]":At()}},end:function(){}};function $t(){var w;switch(Oe.type){case"punctuator":switch(Oe.value){case"{":w={};break;case"[":w=[];break}break;case"null":case"boolean":case"numeric":case"string":w=Oe.value;break}if(vt===void 0)vt=w;else{var $=Ue[Ue.length-1];Array.isArray($)?$.push(w):Object.defineProperty($,wt,{value:w,writable:!0,enumerable:!0,configurable:!0})}if(w!==null&&typeof w=="object")Ue.push(w),Array.isArray(w)?Re="beforeArrayValue":Re="beforePropertyName";else{var ie=Ue[Ue.length-1];ie==null?Re="end":Array.isArray(ie)?Re="afterArrayValue":Re="afterPropertyValue"}}function At(){Ue.pop();var w=Ue[Ue.length-1];w==null?Re="end":Array.isArray(w)?Re="afterArrayValue":Re="afterPropertyValue"}function we(w){return Tt(w===void 0?"JSON5: invalid end of input at "+Qe+":"+Je:"JSON5: invalid character '"+yt(w)+"' at "+Qe+":"+Je)}function rt(){return Tt("JSON5: invalid end of input at "+Qe+":"+Je)}function St(){return Je-=5,Tt("JSON5: invalid identifier character at "+Qe+":"+Je)}function Wt(w){console.warn("JSON5: '"+yt(w)+"' in strings is not valid ECMAScript; consider escaping")}function yt(w){var $={"'":"\\'",'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","\v":"\\v","\0":"\\0","\u2028":"\\u2028","\u2029":"\\u2029"};if($[w])return $[w];if(w<" "){var ie=w.charCodeAt(0).toString(16);return"\\x"+("00"+ie).substring(ie.length)}return w}function Tt(w){var $=new SyntaxError(w);return $.lineNumber=Qe,$.columnNumber=Je,$}var Qt=function($,ie,ne){var ae=[],De="",Ce,Me,Be="",ot;if(ie!=null&&typeof ie=="object"&&!Array.isArray(ie)&&(ne=ie.space,ot=ie.quote,ie=ie.replacer),typeof ie=="function")Me=ie;else if(Array.isArray(ie)){Ce=[];for(var at=0,je=ie;at<je.length;at+=1){var Ge=je[at],Ne=void 0;typeof Ge=="string"?Ne=Ge:(typeof Ge=="number"||Ge instanceof String||Ge instanceof Number)&&(Ne=String(Ge)),Ne!==void 0&&Ce.indexOf(Ne)<0&&Ce.push(Ne)}}return ne instanceof Number?ne=Number(ne):ne instanceof String&&(ne=String(ne)),typeof ne=="number"?ne>0&&(ne=Math.min(10,Math.floor(ne)),Be="          ".substr(0,ne)):typeof ne=="string"&&(Be=ne.substr(0,10)),ht("",{"":$});function ht(be,Le){var ge=Le[be];switch(ge!=null&&(typeof ge.toJSON5=="function"?ge=ge.toJSON5(be):typeof ge.toJSON=="function"&&(ge=ge.toJSON(be))),Me&&(ge=Me.call(Le,be,ge)),ge instanceof Number?ge=Number(ge):ge instanceof String?ge=String(ge):ge instanceof Boolean&&(ge=ge.valueOf()),ge){case null:return"null";case!0:return"true";case!1:return"false"}if(typeof ge=="string")return It(ge,!1);if(typeof ge=="number")return String(ge);if(typeof ge=="object")return Array.isArray(ge)?sn(ge):pt(ge)}function It(be){for(var Le={"'":.1,'"':.2},ge={"'":"\\'",'"':'\\"',"\\":"\\\\","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","\v":"\\v","\0":"\\0","\u2028":"\\u2028","\u2029":"\\u2029"},Pe="",qe=0;qe<be.length;qe++){var Ve=be[qe];switch(Ve){case"'":case'"':Le[Ve]++,Pe+=Ve;continue;case"\0":if(_e.isDigit(be[qe+1])){Pe+="\\x00";continue}}if(ge[Ve]){Pe+=ge[Ve];continue}if(Ve<" "){var dt=Ve.charCodeAt(0).toString(16);Pe+="\\x"+("00"+dt).substring(dt.length);continue}Pe+=Ve}var Ye=ot||Object.keys(Le).reduce(function(et,lt){return Le[et]<Le[lt]?et:lt});return Pe=Pe.replace(new RegExp(Ye,"g"),ge[Ye]),Ye+Pe+Ye}function pt(be){if(ae.indexOf(be)>=0)throw TypeError("Converting circular structure to JSON5");ae.push(be);var Le=De;De=De+Be;for(var ge=Ce||Object.keys(be),Pe=[],qe=0,Ve=ge;qe<Ve.length;qe+=1){var dt=Ve[qe],Ye=ht(dt,be);if(Ye!==void 0){var et=vn(dt)+":";Be!==""&&(et+=" "),et+=Ye,Pe.push(et)}}var lt;if(Pe.length===0)lt="{}";else{var mt;if(Be==="")mt=Pe.join(","),lt="{"+mt+"}";else{var rn=`,
`+De;mt=Pe.join(rn),lt=`{
`+De+mt+`,
`+Le+"}"}}return ae.pop(),De=Le,lt}function vn(be){if(be.length===0)return It(be,!0);var Le=String.fromCodePoint(be.codePointAt(0));if(!_e.isIdStartChar(Le))return It(be,!0);for(var ge=Le.length;ge<be.length;ge++)if(!_e.isIdContinueChar(String.fromCodePoint(be.codePointAt(ge))))return It(be,!0);return be}function sn(be){if(ae.indexOf(be)>=0)throw TypeError("Converting circular structure to JSON5");ae.push(be);var Le=De;De=De+Be;for(var ge=[],Pe=0;Pe<be.length;Pe++){var qe=ht(String(Pe),be);ge.push(qe!==void 0?qe:"null")}var Ve;if(ge.length===0)Ve="[]";else if(Be===""){var dt=ge.join(",");Ve="["+dt+"]"}else{var Ye=`,
`+De,et=ge.join(Ye);Ve=`[
`+De+et+`,
`+Le+"]"}return ae.pop(),De=Le,Ve}},en={parse:Yt,stringify:Qt},tn=en,nn=tn;return nn})}}]);

//# sourceMappingURL=vendors-node_modules_iobroker_json-config_build_index_js.4ecfa692.chunk.js.map